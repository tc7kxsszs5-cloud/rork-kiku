# üìä –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ –≤ app/_layout.tsx

**–î–∞—Ç–∞:** 2026-01-27  
**–ê–≥–µ–Ω—Ç:** Agent-2  
**–°—Ç–∞—Ç—É—Å:** –í —Ä–∞–±–æ—Ç–µ

---

## üìã –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤: 21

### –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (—Ç–µ–∫—É—â–∏–π):

1. `QueryClientProvider` - React Query
2. `trpc.Provider` - tRPC –∫–ª–∏–µ–Ω—Ç
3. `AppErrorBoundary` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
4. `ThemeProvider` - –¢–µ–º–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
5. `AgeComplianceProvider` - –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ
6. `UserProvider` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
7. `AuthProvider` - –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
8. `AnalyticsProvider` - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
9. `PremiumProvider` - Premium —Å—Ç–∞—Ç—É—Å
10. `ABTestingProvider` - A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
11. `PersonalizedAIProvider` - –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π AI
12. `MonitoringProvider` - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
13. `ChatBackgroundsProvider` - –§–æ–Ω—ã —á–∞—Ç–æ–≤
14. `ParentalControlsProvider` - –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å
15. `GamificationProvider` - –ì–µ–π–º–∏—Ñ–∏–∫–∞—Ü–∏—è
16. `PredictiveAnalyticsProvider` - –ü—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
17. `AIParentingAssistantProvider` - AI –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π
18. `ReferralProgramProvider` - –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞
19. `SyncSettingsProvider` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
20. `SecuritySettingsProvider` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
21. `NotificationsProvider` - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## üîç –ê–ù–ê–õ–ò–ó –ó–ê–í–ò–°–ò–ú–û–°–¢–ï–ô

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```
QueryClientProvider (–±–∞–∑–æ–≤—ã–π)
  ‚îî‚îÄ> trpc.Provider (—Ç—Ä–µ–±—É–µ—Ç QueryClient)
      ‚îî‚îÄ> AppErrorBoundary (—Ç—Ä–µ–±—É–µ—Ç –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω–æ–µ)
          ‚îî‚îÄ> ThemeProvider (–±–∞–∑–æ–≤—ã–π UI)
              ‚îî‚îÄ> AgeComplianceProvider (–±–∞–∑–æ–≤—ã–π)
                  ‚îî‚îÄ> UserProvider (—Ç—Ä–µ–±—É–µ—Ç Theme)
                      ‚îî‚îÄ> AuthProvider (—Ç—Ä–µ–±—É–µ—Ç User)
                          ‚îî‚îÄ> AnalyticsProvider (—Ç—Ä–µ–±—É–µ—Ç Auth, User)
                              ‚îî‚îÄ> PremiumProvider (—Ç—Ä–µ–±—É–µ—Ç User)
                                  ‚îî‚îÄ> ABTestingProvider (—Ç—Ä–µ–±—É–µ—Ç Analytics)
                                      ‚îî‚îÄ> PersonalizedAIProvider (—Ç—Ä–µ–±—É–µ—Ç User, Analytics)
                                          ‚îî‚îÄ> MonitoringProvider (—Ç—Ä–µ–±—É–µ—Ç User, Auth)
                                              ‚îî‚îÄ> ChatBackgroundsProvider (—Ç—Ä–µ–±—É–µ—Ç User)
                                                  ‚îî‚îÄ> ParentalControlsProvider (—Ç—Ä–µ–±—É–µ—Ç User, Auth)
                                                      ‚îî‚îÄ> GamificationProvider (—Ç—Ä–µ–±—É–µ—Ç User)
                                                          ‚îî‚îÄ> PredictiveAnalyticsProvider (—Ç—Ä–µ–±—É–µ—Ç Analytics, User)
                                                              ‚îî‚îÄ> AIParentingAssistantProvider (—Ç—Ä–µ–±—É–µ—Ç User, Analytics)
                                                                  ‚îî‚îÄ> ReferralProgramProvider (—Ç—Ä–µ–±—É–µ—Ç User)
                                                                      ‚îî‚îÄ> SyncSettingsProvider (—Ç—Ä–µ–±—É–µ—Ç User)
                                                                          ‚îî‚îÄ> SecuritySettingsProvider (—Ç—Ä–µ–±—É–µ—Ç User)
                                                                              ‚îî‚îÄ> NotificationsProvider (—Ç—Ä–µ–±—É–µ—Ç User, Auth)
```

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–´

### 1. –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤ (21)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥—ã–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –¥–æ–±–∞–≤–ª—è–µ—Ç overhead –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- **–í–ª–∏—è–Ω–∏–µ:** –ú–µ–¥–ª–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (3-5 —Å–µ–∫—É–Ω–¥)
- **–†–µ—à–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

### 2. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- **–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- **–í–ª–∏—è–Ω–∏–µ:** –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- **–†–µ—à–µ–Ω–∏–µ:** Lazy loading –¥–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤

### 3. –ù–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
- **–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã –Ω–∞ –æ–¥–Ω–æ–º —É—Ä–æ–≤–Ω–µ
- **–í–ª–∏—è–Ω–∏–µ:** –°–ª–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã

---

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### –ì—Ä—É–ø–ø–∞ 1: –ë–∞–∑–æ–≤—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ, –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—Ä–∞–∑—É)

```typescript
// CoreProviders.tsx
export function CoreProviders({ children }: { children: React.ReactNode }) {
  return (
    <QueryClientProvider client={queryClient}>
      <trpc.Provider client={trpcClient} queryClient={queryClient}>
        <AppErrorBoundary>
          <ThemeProvider>
            {children}
          </ThemeProvider>
        </AppErrorBoundary>
      </trpc.Provider>
    </QueryClientProvider>
  );
}
```

### –ì—Ä—É–ø–ø–∞ 2: User & Auth (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ, –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å—Ä–∞–∑—É)

```typescript
// UserAuthProviders.tsx
export function UserAuthProviders({ children }: { children: React.ReactNode }) {
  return (
    <AgeComplianceProvider>
      <UserProvider>
        <AuthProvider>
          {children}
        </AuthProvider>
      </UserProvider>
    </AgeComplianceProvider>
  );
}
```

### –ì—Ä—É–ø–ø–∞ 3: Analytics (–≤–∞–∂–Ω—ã–µ, –º–æ–∂–Ω–æ lazy load)

```typescript
// AnalyticsProviders.tsx
export function AnalyticsProviders({ children }: { children: React.ReactNode }) {
  return (
    <AnalyticsProvider>
      <PremiumProvider>
        <ABTestingProvider>
          <PredictiveAnalyticsProvider>
            {children}
          </PredictiveAnalyticsProvider>
        </ABTestingProvider>
      </PremiumProvider>
    </AnalyticsProvider>
  );
}
```

### –ì—Ä—É–ø–ø–∞ 4: Features (–º–æ–∂–Ω–æ lazy load)

```typescript
// FeaturesProviders.tsx
export function FeaturesProviders({ children }: { children: React.ReactNode }) {
  return (
    <MonitoringProvider>
      <ChatBackgroundsProvider>
        <ParentalControlsProvider>
          <GamificationProvider>
            <AIParentingAssistantProvider>
              <PersonalizedAIProvider>
                {children}
              </PersonalizedAIProvider>
            </AIParentingAssistantProvider>
          </GamificationProvider>
        </ParentalControlsProvider>
      </ChatBackgroundsProvider>
    </MonitoringProvider>
  );
}
```

### –ì—Ä—É–ø–ø–∞ 5: Settings (–º–æ–∂–Ω–æ lazy load)

```typescript
// SettingsProviders.tsx
export function SettingsProviders({ children }: { children: React.ReactNode }) {
  return (
    <ReferralProgramProvider>
      <SyncSettingsProvider>
        <SecuritySettingsProvider>
          <NotificationsProvider>
            {children}
          </NotificationsProvider>
        </SecuritySettingsProvider>
      </SyncSettingsProvider>
    </ReferralProgramProvider>
  );
}
```

---

## üöÄ –ü–õ–ê–ù –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### –§–∞–∑–∞ 1: –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ (2 —á–∞—Å–∞)
1. –°–æ–∑–¥–∞—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
2. –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
3. –û–±–Ω–æ–≤–∏—Ç—å `app/_layout.tsx`

### –§–∞–∑–∞ 2: Lazy Loading (2 —á–∞—Å–∞)
1. Lazy load –¥–ª—è AnalyticsProviders
2. Lazy load –¥–ª—è FeaturesProviders
3. Lazy load –¥–ª—è SettingsProviders

### –§–∞–∑–∞ 3: –ò–∑–º–µ—Ä–µ–Ω–∏–µ (1 —á–∞—Å)
1. –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –¥–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
2. –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
3. –°—Ä–∞–≤–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞: **3-5 —Å–µ–∫—É–Ω–¥**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤: **21**
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: **–î–∞**

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –í—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞: **< 2 —Å–µ–∫—É–Ω–¥—ã** (—Ü–µ–ª—å)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤: **5 –≥—Ä—É–ø–ø** (–≤–º–µ—Å—Ç–æ 21)
- Lazy loading: **–î–∞** (–¥–ª—è –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö)

---

## ‚ö†Ô∏è –†–ò–°–ö–ò

1. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤** –º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. **Lazy loading** –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é —Ö—É–∫–æ–≤
3. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞** —Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

---

## ‚úÖ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. –°–æ–∑–¥–∞—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ dev –æ–∫—Ä—É–∂–µ–Ω–∏–∏
3. –ò–∑–º–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é

---

**–°—Ç–∞—Ç—É—Å:** –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω, –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
