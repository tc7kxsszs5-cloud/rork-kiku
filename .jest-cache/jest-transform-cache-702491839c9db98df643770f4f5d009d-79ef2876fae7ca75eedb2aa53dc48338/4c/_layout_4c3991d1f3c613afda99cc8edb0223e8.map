{"version":3,"names":["_reactQuery","require","_expoRouter","SplashScreen","_interopRequireWildcard","_react","_reactNative","_lucideReactNative","_reactNativeGestureHandler","_MonitoringContext","_UserContext","_ParentalControlsContext","_ThemeContext","_NotificationsContext","_AgeComplianceContext","_ABTestingContext","AnalyticsContext","_PersonalizedAIContext","_GamificationContext","_PredictiveAnalyticsContext","_AIParentingAssistantContext","_ReferralProgramContext","_SyncSettingsContext","_SecuritySettingsContext","_PremiumContext","_ChatBackgroundsContext","_AuthContext","_ActivationTracker","_trpc","_cursorStyles","_initCustomEmojis","_jsxRuntime","Platform","OS","document","applyGlobalCursorStyles","error","console","warn","preventAutoHideAsync","queryClient","QueryClient","defaultOptions","queries","Object","assign","retry","staleTime","refetchOnWindowFocus","refetchOnMount","gcTime","refetchOnReconnect","mutations","HeaderBackButton","_ref","fallbackHref","forceFallback","router","useRouter","handlePress","__DEV__","then","_ref2","logger","debug","component","canGoBack","back","replace","jsxs","TouchableOpacity","onPress","style","styles","headerBackButton","testID","accessibilityRole","accessibilityLabel","children","jsx","ChevronLeft","size","color","headerBackIcon","Text","headerBackText","AppErrorBoundary","_React$Component","_this","_classCallCheck2","default","_len","arguments","length","args","Array","_key","_callSuper2","concat","state","hasError","handleReset","setState","message","undefined","_inherits2","_createClass2","key","value","componentDidCatch","info","_ref3","critical","componentStack","render","_this$state$message","View","errorContainer","errorTitle","errorMessage","errorButton","errorButtonText","props","getDerivedStateFromError","React","Component","RootLayoutNav","_useState","useState","_useState2","_slicedToArray2","isReady","setIsReady","authData","useAuth","isAuthenticated","segments","useSegments","useEffect","timer","setTimeout","clearTimeout","currentRoute","String","authRoutes","inAuthGroup","includes","securityHeaderLeft","useMemo","HeaderLeftComponent","displayName","Stack","screenOptions","headerBackTitle","Screen","name","options","headerShown","presentation","title","headerLeft","AppProviders","_ref4","QueryClientProvider","client","trpc","Provider","trpcClient","ThemeProvider","AgeComplianceProvider","UserProvider","AuthProvider","AnalyticsProvider","PremiumProvider","ABTestingProvider","PersonalizedAIProvider","MonitoringProvider","ChatBackgroundsProvider","ParentalControlsProvider","GamificationProvider","PredictiveAnalyticsProvider","AIParentingAssistantProvider","ReferralProgramProvider","SyncSettingsProvider","SecuritySettingsProvider","NotificationsProvider","ActivationTracker","RootLayout","_useState3","_useState4","isMounted","initializeApp","_ref5","_asyncToGenerator2","initializeTestCustomEmojis","catch","err","apply","hideAsync","_ref6","Error","action","finally","GestureHandlerRootView","container","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent","padding","fontSize","fontWeight","marginBottom","textAlign","paddingHorizontal","paddingVertical","borderRadius","textTransform","flexDirection","marginLeft","gap"],"sources":["_layout.tsx"],"sourcesContent":["import { QueryClient, QueryClientProvider } from \"@tanstack/react-query\";\nimport { Stack, useRouter, useSegments } from \"expo-router\";\nimport * as SplashScreen from \"expo-splash-screen\";\nimport React, { ReactNode, useEffect, useMemo, useState } from \"react\";\nimport { StyleSheet, Platform, View, Text, TouchableOpacity } from \"react-native\";\nimport { ChevronLeft } from \"lucide-react-native\";\nimport { GestureHandlerRootView } from \"react-native-gesture-handler\";\nimport { MonitoringProvider } from \"@/constants/MonitoringContext\";\nimport { UserProvider } from \"@/constants/UserContext\";\nimport { ParentalControlsProvider } from \"@/constants/ParentalControlsContext\";\nimport { ThemeProvider } from \"@/constants/ThemeContext\";\nimport { NotificationsProvider } from \"@/constants/NotificationsContext\";\nimport { AgeComplianceProvider } from \"@/constants/AgeComplianceContext\";\nimport { ABTestingProvider } from \"@/constants/ABTestingContext\";\nimport * as AnalyticsContext from \"@/constants/AnalyticsContext\";\nimport { PersonalizedAIProvider } from \"@/constants/PersonalizedAIContext\";\nimport { GamificationProvider } from \"@/constants/GamificationContext\";\nimport { PredictiveAnalyticsProvider } from \"@/constants/PredictiveAnalyticsContext\";\nimport { AIParentingAssistantProvider } from \"@/constants/AIParentingAssistantContext\";\nimport { ReferralProgramProvider } from \"@/constants/ReferralProgramContext\";\nimport { SyncSettingsProvider } from \"@/constants/SyncSettingsContext\";\nimport { SecuritySettingsProvider } from \"@/constants/SecuritySettingsContext\";\nimport { PremiumProvider } from \"@/constants/PremiumContext\";\nimport { ChatBackgroundsProvider } from \"@/constants/ChatBackgroundsContext\";\nimport { AuthProvider, useAuth } from \"@/constants/AuthContext\";\nimport { ActivationTracker } from \"@/components/ActivationTracker\";\nimport { trpc, trpcClient } from \"@/lib/trpc\";\nimport \"@/constants/i18n\";\nimport { applyGlobalCursorStyles } from \"@/utils/cursorStyles\";\nimport { initializeTestCustomEmojis } from \"@/utils/initCustomEmojis\";\n\n// Применяем пользовательские курсоры для web\ntry {\n  if (Platform.OS === 'web' && typeof document !== 'undefined') {\n    applyGlobalCursorStyles();\n  }\n} catch (error) {\n  console.warn('[RootLayout] Failed to apply cursor styles:', error);\n}\n\nif (Platform.OS !== 'web') {\n  SplashScreen.preventAutoHideAsync();\n}\n\nconst queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      retry: false,\n      staleTime: 5 * 60 * 1000,\n      refetchOnWindowFocus: false,\n      refetchOnMount: false,\n      // Оптимизация для веб: кэширование и ленивая загрузка\n      ...(Platform.OS === 'web' && {\n        gcTime: 10 * 60 * 1000, // 10 минут кэш\n        refetchOnReconnect: false,\n      }),\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n\ninterface ErrorBoundaryProps {\n  children: ReactNode;\n}\n\ninterface ErrorBoundaryState {\n  hasError: boolean;\n  message?: string;\n}\n\nfunction HeaderBackButton({ fallbackHref, forceFallback }: { fallbackHref: string; forceFallback?: boolean }) {\n  const router = useRouter();\n\n  const handlePress = () => {\n    if (__DEV__) {\n      // Only log in development\n      import('@/utils/logger').then(({ logger }) => {\n        logger.debug('Back button pressed', { component: 'HeaderBackButton', canGoBack: router.canGoBack(), forceFallback });\n      });\n    }\n    if (!forceFallback && router.canGoBack()) {\n      router.back();\n      return;\n    }\n    router.replace(fallbackHref as never);\n  };\n\n  return (\n    <TouchableOpacity\n      onPress={handlePress}\n      style={styles.headerBackButton}\n      testID=\"header-back-button\"\n      accessibilityRole=\"button\"\n      accessibilityLabel=\"Назад\"\n    >\n      <ChevronLeft size={22} color={styles.headerBackIcon.color} />\n      <Text style={styles.headerBackText}>Назад</Text>\n    </TouchableOpacity>\n  );\n}\n\nclass AppErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  public state: ErrorBoundaryState = {\n    hasError: false,\n  };\n\n  static getDerivedStateFromError(error: Error): ErrorBoundaryState {\n    return { hasError: true, message: error?.message };\n  }\n\n  componentDidCatch(error: Error, info: React.ErrorInfo) {\n    // Import logger dynamically to avoid circular dependencies\n    import('@/utils/logger').then(({ logger }) => {\n      logger.critical('App error boundary caught error', error, { component: 'AppErrorBoundary', componentStack: info.componentStack });\n    });\n  }\n\n  private handleReset = () => {\n    this.setState({ hasError: false, message: undefined });\n  };\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <View style={styles.errorContainer} testID=\"app-error-boundary\">\n          <Text style={styles.errorTitle}>Что-то пошло не так</Text>\n          <Text style={styles.errorMessage}>{this.state.message ?? 'Попробуйте обновить приложение.'}</Text>\n          <TouchableOpacity style={styles.errorButton} onPress={this.handleReset} testID=\"app-error-boundary-reset\">\n            <Text style={styles.errorButtonText}>Попробовать снова</Text>\n          </TouchableOpacity>\n        </View>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nfunction RootLayoutNav() {\n  const [isReady, setIsReady] = useState(false);\n  \n  // Хуки должны вызываться на верхнем уровне компонента\n  const authData = useAuth();\n  const isAuthenticated = authData?.isAuthenticated || false;\n  const router = useRouter();\n  const segments = useSegments();\n\n  useEffect(() => {\n    // Ждем, пока роутер будет готов\n    const timer = setTimeout(() => {\n      setIsReady(true);\n    }, 100);\n\n    return () => clearTimeout(timer);\n  }, []);\n\n  useEffect(() => {\n    if (!isReady) return;\n    \n    // Проверяем, зарегистрирован ли пользователь\n    if (!isAuthenticated) {\n      // Если не зарегистрирован и не на экране регистрации - показываем выбор роли\n      const currentRoute = String(segments?.[0] || '');\n      const authRoutes = ['role-selection', 'register-parent', 'register-child'];\n      const inAuthGroup = authRoutes.includes(currentRoute);\n      \n      // Не редиректим, если уже на нужном экране или на главном экране\n      if (!inAuthGroup && currentRoute !== '(tabs)' && router) {\n        // Небольшая задержка для предотвращения конфликтов\n        const timer = setTimeout(() => {\n          try {\n            router.replace('/role-selection' as any);\n          } catch (error) {\n            console.error('[RootLayoutNav] Navigation error:', error);\n          }\n        }, 300);\n        return () => clearTimeout(timer);\n      }\n    }\n  }, [isAuthenticated, segments, router, isReady]);\n\n  const securityHeaderLeft = useMemo(() => {\n    const HeaderLeftComponent = () => <HeaderBackButton fallbackHref=\"/(tabs)\" forceFallback />;\n    HeaderLeftComponent.displayName = 'SecuritySettingsHeaderLeft';\n    return HeaderLeftComponent;\n  }, []);\n\n  return (\n    <Stack screenOptions={{ headerBackTitle: \"Назад\" }}>\n      <Stack.Screen name=\"(tabs)\" options={{ headerShown: false }} />\n      <Stack.Screen \n        name=\"chat/[chatId]\" \n        options={{ \n          headerShown: true,\n          presentation: 'card',\n        }} \n      />\n      <Stack.Screen\n        name=\"security-settings\"\n        options={{\n          title: \"Центр безопасности\",\n          presentation: 'card',\n          headerLeft: securityHeaderLeft,\n        }}\n      />\n      <Stack.Screen\n        name=\"ai-recommendations\"\n        options={{\n          headerShown: false,\n          presentation: 'card',\n        }}\n      />\n      <Stack.Screen\n        name=\"role-selection\"\n        options={{\n          headerShown: false,\n          presentation: 'fullScreenModal',\n        }}\n      />\n      <Stack.Screen\n        name=\"register-parent\"\n        options={{\n          title: \"Регистрация родителя\",\n          presentation: 'card',\n        }}\n      />\n      <Stack.Screen\n        name=\"register-child\"\n        options={{\n          title: \"Регистрация ребенка\",\n          presentation: 'card',\n        }}\n      />\n      <Stack.Screen\n        name=\"status\"\n        options={{\n          title: \"Статусы\",\n          presentation: 'card',\n        }}\n      />\n      <Stack.Screen\n        name=\"call\"\n        options={{\n          headerShown: false,\n          presentation: 'fullScreenModal',\n        }}\n      />\n    </Stack>\n  );\n}\n\nfunction AppProviders({ children }: { children: ReactNode }) {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <trpc.Provider client={trpcClient} queryClient={queryClient}>\n        <AppErrorBoundary>\n          <ThemeProvider>\n            <AgeComplianceProvider>\n              <UserProvider>\n                <AuthProvider>\n                  <AnalyticsContext.AnalyticsProvider>\n                    <PremiumProvider>\n                      <ABTestingProvider>\n                        <PersonalizedAIProvider>\n                          <MonitoringProvider>\n                            <ChatBackgroundsProvider>\n                              <ParentalControlsProvider>\n                              <GamificationProvider>\n                              <PredictiveAnalyticsProvider>\n                                <AIParentingAssistantProvider>\n                                  <ReferralProgramProvider>\n                                    <SyncSettingsProvider>\n                                    <SecuritySettingsProvider>\n                                      <NotificationsProvider>\n                                        <ActivationTracker />\n                                        {children}\n                                      </NotificationsProvider>\n                                    </SecuritySettingsProvider>\n                                    </SyncSettingsProvider>\n                                  </ReferralProgramProvider>\n                                </AIParentingAssistantProvider>\n                              </PredictiveAnalyticsProvider>\n                              </GamificationProvider>\n                              </ParentalControlsProvider>\n                            </ChatBackgroundsProvider>\n                          </MonitoringProvider>\n                        </PersonalizedAIProvider>\n                      </ABTestingProvider>\n                    </PremiumProvider>\n                  </AnalyticsContext.AnalyticsProvider>\n                </AuthProvider>\n              </UserProvider>\n            </AgeComplianceProvider>\n          </ThemeProvider>\n        </AppErrorBoundary>\n      </trpc.Provider>\n    </QueryClientProvider>\n  );\n}\n\nexport default function RootLayout() {\n  const [isReady, setIsReady] = useState(Platform.OS === 'web');\n\n  useEffect(() => {\n    let isMounted = true;\n\n    const initializeApp = async () => {\n      try {\n        // Инициализация тестовых кастомных эмодзи\n        // Не блокируем запуск, если инициализация не удалась\n        await initializeTestCustomEmojis().catch((err) => {\n          console.warn('[RootLayout] Custom emojis init failed (non-critical):', err);\n        });\n      } catch (error) {\n        console.error('[RootLayout] Failed to initialize app:', error);\n        // Не блокируем запуск приложения из-за ошибок инициализации\n      }\n    };\n\n    // Для веб сразу помечаем как готово, инициализация идет в фоне\n    if (Platform.OS === 'web') {\n      setIsReady(true);\n      // Запускаем инициализацию асинхронно, не блокируя запуск\n      initializeApp();\n      return;\n    }\n    \n    // Для нативных платформ запускаем инициализацию\n    initializeApp();\n\n    SplashScreen.hideAsync()\n      .catch((error) => {\n        import('@/utils/logger').then(({ logger }) => {\n          logger.error('Failed to hide splash screen', error instanceof Error ? error : new Error(String(error)), { component: 'RootLayout', action: 'hideSplashScreen' });\n        });\n      })\n      .finally(() => {\n        if (isMounted) {\n          setIsReady(true);\n        }\n      });\n\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  if (!isReady) {\n    return null;\n  }\n\n  return (\n    <AppProviders>\n      <GestureHandlerRootView style={styles.container}>\n        <RootLayoutNav />\n      </GestureHandlerRootView>\n    </AppProviders>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n  },\n  errorContainer: {\n    flex: 1,\n    backgroundColor: '#0f172a',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 24,\n  },\n  errorTitle: {\n    fontSize: 24,\n    fontWeight: '700' as const,\n    color: '#f8fafc',\n    marginBottom: 12,\n    textAlign: 'center' as const,\n  },\n  errorMessage: {\n    fontSize: 16,\n    color: '#cbd5f5',\n    textAlign: 'center' as const,\n    marginBottom: 24,\n  },\n  errorButton: {\n    backgroundColor: '#facc15',\n    paddingHorizontal: 24,\n    paddingVertical: 12,\n    borderRadius: 999,\n  },\n  errorButtonText: {\n    fontSize: 16,\n    fontWeight: '700' as const,\n    color: '#0f172a',\n    textTransform: 'uppercase' as const,\n  },\n  headerBackButton: {\n    flexDirection: 'row',\n    alignItems: 'center',\n    paddingHorizontal: 8,\n    paddingVertical: 6,\n    borderRadius: 999,\n    marginLeft: 8,\n    gap: 4,\n    backgroundColor: 'rgba(148,163,184,0.16)',\n  },\n  headerBackIcon: {\n    color: '#0f172a',\n  },\n  headerBackText: {\n    fontSize: 14,\n    fontWeight: '700' as const,\n    color: '#0f172a',\n  },\n});\n"],"mappings":";;;;;;;;;;;;AAAA,IAAAA,WAAA,GAAAC,OAAA;AACA,IAAAC,WAAA,GAAAD,OAAA;AACA,IAAAE,YAAA,GAAAC,uBAAA,CAAAH,OAAA;AACA,IAAAI,MAAA,GAAAD,uBAAA,CAAAH,OAAA;AACA,IAAAK,YAAA,GAAAL,OAAA;AACA,IAAAM,kBAAA,GAAAN,OAAA;AACA,IAAAO,0BAAA,GAAAP,OAAA;AACA,IAAAQ,kBAAA,GAAAR,OAAA;AACA,IAAAS,YAAA,GAAAT,OAAA;AACA,IAAAU,wBAAA,GAAAV,OAAA;AACA,IAAAW,aAAA,GAAAX,OAAA;AACA,IAAAY,qBAAA,GAAAZ,OAAA;AACA,IAAAa,qBAAA,GAAAb,OAAA;AACA,IAAAc,iBAAA,GAAAd,OAAA;AACA,IAAAe,gBAAA,GAAAZ,uBAAA,CAAAH,OAAA;AACA,IAAAgB,sBAAA,GAAAhB,OAAA;AACA,IAAAiB,oBAAA,GAAAjB,OAAA;AACA,IAAAkB,2BAAA,GAAAlB,OAAA;AACA,IAAAmB,4BAAA,GAAAnB,OAAA;AACA,IAAAoB,uBAAA,GAAApB,OAAA;AACA,IAAAqB,oBAAA,GAAArB,OAAA;AACA,IAAAsB,wBAAA,GAAAtB,OAAA;AACA,IAAAuB,eAAA,GAAAvB,OAAA;AACA,IAAAwB,uBAAA,GAAAxB,OAAA;AACA,IAAAyB,YAAA,GAAAzB,OAAA;AACA,IAAA0B,kBAAA,GAAA1B,OAAA;AACA,IAAA2B,KAAA,GAAA3B,OAAA;AACAA,OAAA;AACA,IAAA4B,aAAA,GAAA5B,OAAA;AACA,IAAA6B,iBAAA,GAAA7B,OAAA;AAAsE,IAAA8B,WAAA,GAAA9B,OAAA;AAGtE,IAAI;EACF,IAAI+B,qBAAQ,CAACC,EAAE,KAAK,KAAK,IAAI,OAAOC,QAAQ,KAAK,WAAW,EAAE;IAC5D,IAAAC,qCAAuB,EAAC,CAAC;EAC3B;AACF,CAAC,CAAC,OAAOC,KAAK,EAAE;EACdC,OAAO,CAACC,IAAI,CAAC,6CAA6C,EAAEF,KAAK,CAAC;AACpE;AAEA,IAAIJ,qBAAQ,CAACC,EAAE,KAAK,KAAK,EAAE;EACzB9B,YAAY,CAACoC,oBAAoB,CAAC,CAAC;AACrC;AAEA,IAAMC,WAAW,GAAG,IAAIC,uBAAW,CAAC;EAClCC,cAAc,EAAE;IACdC,OAAO,EAAAC,MAAA,CAAAC,MAAA;MACLC,KAAK,EAAE,KAAK;MACZC,SAAS,EAAE,CAAC,GAAG,EAAE,GAAG,IAAI;MACxBC,oBAAoB,EAAE,KAAK;MAC3BC,cAAc,EAAE;IAAK,GAEjBjB,qBAAQ,CAACC,EAAE,KAAK,KAAK,IAAI;MAC3BiB,MAAM,EAAE,EAAE,GAAG,EAAE,GAAG,IAAI;MACtBC,kBAAkB,EAAE;IACtB,CAAC,CACF;IACDC,SAAS,EAAE;MACTN,KAAK,EAAE;IACT;EACF;AACF,CAAC,CAAC;AAWF,SAASO,gBAAgBA,CAAAC,IAAA,EAAqF;EAAA,IAAlFC,YAAY,GAAAD,IAAA,CAAZC,YAAY;IAAEC,aAAa,GAAAF,IAAA,CAAbE,aAAa;EACrD,IAAMC,MAAM,GAAG,IAAAC,qBAAS,EAAC,CAAC;EAE1B,IAAMC,WAAW,GAAG,SAAdA,WAAWA,CAAA,EAAS;IACxB,IAAIC,OAAO,EAAE;MAEX,MAAM,CAAC,gBAAgB,CAAC,CAACC,IAAI,CAAC,UAAAC,KAAA,EAAgB;QAAA,IAAbC,MAAM,GAAAD,KAAA,CAANC,MAAM;QACrCA,MAAM,CAACC,KAAK,CAAC,qBAAqB,EAAE;UAAEC,SAAS,EAAE,kBAAkB;UAAEC,SAAS,EAAET,MAAM,CAACS,SAAS,CAAC,CAAC;UAAEV,aAAa,EAAbA;QAAc,CAAC,CAAC;MACtH,CAAC,CAAC;IACJ;IACA,IAAI,CAACA,aAAa,IAAIC,MAAM,CAACS,SAAS,CAAC,CAAC,EAAE;MACxCT,MAAM,CAACU,IAAI,CAAC,CAAC;MACb;IACF;IACAV,MAAM,CAACW,OAAO,CAACb,YAAqB,CAAC;EACvC,CAAC;EAED,OACE,IAAAxB,WAAA,CAAAsC,IAAA,EAAC/D,YAAA,CAAAgE,gBAAgB;IACfC,OAAO,EAAEZ,WAAY;IACrBa,KAAK,EAAEC,MAAM,CAACC,gBAAiB;IAC/BC,MAAM,EAAC,oBAAoB;IAC3BC,iBAAiB,EAAC,QAAQ;IAC1BC,kBAAkB,EAAC,gCAAO;IAAAC,QAAA,GAE1B,IAAA/C,WAAA,CAAAgD,GAAA,EAACxE,kBAAA,CAAAyE,WAAW;MAACC,IAAI,EAAE,EAAG;MAACC,KAAK,EAAET,MAAM,CAACU,cAAc,CAACD;IAAM,CAAE,CAAC,EAC7D,IAAAnD,WAAA,CAAAgD,GAAA,EAACzE,YAAA,CAAA8E,IAAI;MAACZ,KAAK,EAAEC,MAAM,CAACY,cAAe;MAAAP,QAAA,EAAC;IAAK,CAAM,CAAC;EAAA,CAChC,CAAC;AAEvB;AAAC,IAEKQ,gBAAgB,aAAAC,gBAAA;EAAA,SAAAD,iBAAA;IAAA,IAAAE,KAAA;IAAA,IAAAC,gBAAA,CAAAC,OAAA,QAAAJ,gBAAA;IAAA,SAAAK,IAAA,GAAAC,SAAA,CAAAC,MAAA,EAAAC,IAAA,OAAAC,KAAA,CAAAJ,IAAA,GAAAK,IAAA,MAAAA,IAAA,GAAAL,IAAA,EAAAK,IAAA;MAAAF,IAAA,CAAAE,IAAA,IAAAJ,SAAA,CAAAI,IAAA;IAAA;IAAAR,KAAA,OAAAS,WAAA,CAAAP,OAAA,QAAAJ,gBAAA,KAAAY,MAAA,CAAAJ,IAAA;IAAAN,KAAA,CACbW,KAAK,GAAuB;MACjCC,QAAQ,EAAE;IACZ,CAAC;IAAAZ,KAAA,CAaOa,WAAW,GAAG,YAAM;MAC1Bb,KAAA,CAAKc,QAAQ,CAAC;QAAEF,QAAQ,EAAE,KAAK;QAAEG,OAAO,EAAEC;MAAU,CAAC,CAAC;IACxD,CAAC;IAAA,OAAAhB,KAAA;EAAA;EAAA,IAAAiB,UAAA,CAAAf,OAAA,EAAAJ,gBAAA,EAAAC,gBAAA;EAAA,WAAAmB,aAAA,CAAAhB,OAAA,EAAAJ,gBAAA;IAAAqB,GAAA;IAAAC,KAAA,EATD,SAAAC,iBAAiBA,CAACzE,KAAY,EAAE0E,IAAqB,EAAE;MAErD,MAAM,CAAC,gBAAgB,CAAC,CAACjD,IAAI,CAAC,UAAAkD,KAAA,EAAgB;QAAA,IAAbhD,MAAM,GAAAgD,KAAA,CAANhD,MAAM;QACrCA,MAAM,CAACiD,QAAQ,CAAC,iCAAiC,EAAE5E,KAAK,EAAE;UAAE6B,SAAS,EAAE,kBAAkB;UAAEgD,cAAc,EAAEH,IAAI,CAACG;QAAe,CAAC,CAAC;MACnI,CAAC,CAAC;IACJ;EAAC;IAAAN,GAAA;IAAAC,KAAA,EAMD,SAAAM,MAAMA,CAAA,EAAG;MACP,IAAI,IAAI,CAACf,KAAK,CAACC,QAAQ,EAAE;QAAA,IAAAe,mBAAA;QACvB,OACE,IAAApF,WAAA,CAAAsC,IAAA,EAAC/D,YAAA,CAAA8G,IAAI;UAAC5C,KAAK,EAAEC,MAAM,CAAC4C,cAAe;UAAC1C,MAAM,EAAC,oBAAoB;UAAAG,QAAA,GAC7D,IAAA/C,WAAA,CAAAgD,GAAA,EAACzE,YAAA,CAAA8E,IAAI;YAACZ,KAAK,EAAEC,MAAM,CAAC6C,UAAW;YAAAxC,QAAA,EAAC;UAAmB,CAAM,CAAC,EAC1D,IAAA/C,WAAA,CAAAgD,GAAA,EAACzE,YAAA,CAAA8E,IAAI;YAACZ,KAAK,EAAEC,MAAM,CAAC8C,YAAa;YAAAzC,QAAA,GAAAqC,mBAAA,GAAE,IAAI,CAAChB,KAAK,CAACI,OAAO,YAAAY,mBAAA,GAAI;UAAiC,CAAO,CAAC,EAClG,IAAApF,WAAA,CAAAgD,GAAA,EAACzE,YAAA,CAAAgE,gBAAgB;YAACE,KAAK,EAAEC,MAAM,CAAC+C,WAAY;YAACjD,OAAO,EAAE,IAAI,CAAC8B,WAAY;YAAC1B,MAAM,EAAC,0BAA0B;YAAAG,QAAA,EACvG,IAAA/C,WAAA,CAAAgD,GAAA,EAACzE,YAAA,CAAA8E,IAAI;cAACZ,KAAK,EAAEC,MAAM,CAACgD,eAAgB;cAAA3C,QAAA,EAAC;YAAiB,CAAM;UAAC,CAC7C,CAAC;QAAA,CACf,CAAC;MAEX;MAEA,OAAO,IAAI,CAAC4C,KAAK,CAAC5C,QAAQ;IAC5B;EAAC;IAAA6B,GAAA;IAAAC,KAAA,EA7BD,SAAOe,wBAAwBA,CAACvF,KAAY,EAAsB;MAChE,OAAO;QAAEgE,QAAQ,EAAE,IAAI;QAAEG,OAAO,EAAEnE,KAAK,oBAALA,KAAK,CAAEmE;MAAQ,CAAC;IACpD;EAAC;AAAA,EAP4BqB,cAAK,CAACC,SAAS;AAqC9C,SAASC,aAAaA,CAAA,EAAG;EACvB,IAAAC,SAAA,GAA8B,IAAAC,eAAQ,EAAC,KAAK,CAAC;IAAAC,UAAA,OAAAC,eAAA,CAAAxC,OAAA,EAAAqC,SAAA;IAAtCI,OAAO,GAAAF,UAAA;IAAEG,UAAU,GAAAH,UAAA;EAG1B,IAAMI,QAAQ,GAAG,IAAAC,oBAAO,EAAC,CAAC;EAC1B,IAAMC,eAAe,GAAG,CAAAF,QAAQ,oBAARA,QAAQ,CAAEE,eAAe,KAAI,KAAK;EAC1D,IAAM9E,MAAM,GAAG,IAAAC,qBAAS,EAAC,CAAC;EAC1B,IAAM8E,QAAQ,GAAG,IAAAC,uBAAW,EAAC,CAAC;EAE9B,IAAAC,gBAAS,EAAC,YAAM;IAEd,IAAMC,KAAK,GAAGC,UAAU,CAAC,YAAM;MAC7BR,UAAU,CAAC,IAAI,CAAC;IAClB,CAAC,EAAE,GAAG,CAAC;IAEP,OAAO;MAAA,OAAMS,YAAY,CAACF,KAAK,CAAC;IAAA;EAClC,CAAC,EAAE,EAAE,CAAC;EAEN,IAAAD,gBAAS,EAAC,YAAM;IACd,IAAI,CAACP,OAAO,EAAE;IAGd,IAAI,CAACI,eAAe,EAAE;MAEpB,IAAMO,YAAY,GAAGC,MAAM,CAAC,CAAAP,QAAQ,oBAARA,QAAQ,CAAG,CAAC,CAAC,KAAI,EAAE,CAAC;MAChD,IAAMQ,UAAU,GAAG,CAAC,gBAAgB,EAAE,iBAAiB,EAAE,gBAAgB,CAAC;MAC1E,IAAMC,WAAW,GAAGD,UAAU,CAACE,QAAQ,CAACJ,YAAY,CAAC;MAGrD,IAAI,CAACG,WAAW,IAAIH,YAAY,KAAK,QAAQ,IAAIrF,MAAM,EAAE;QAEvD,IAAMkF,KAAK,GAAGC,UAAU,CAAC,YAAM;UAC7B,IAAI;YACFnF,MAAM,CAACW,OAAO,CAAC,iBAAwB,CAAC;UAC1C,CAAC,CAAC,OAAOhC,KAAK,EAAE;YACdC,OAAO,CAACD,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;UAC3D;QACF,CAAC,EAAE,GAAG,CAAC;QACP,OAAO;UAAA,OAAMyG,YAAY,CAACF,KAAK,CAAC;QAAA;MAClC;IACF;EACF,CAAC,EAAE,CAACJ,eAAe,EAAEC,QAAQ,EAAE/E,MAAM,EAAE0E,OAAO,CAAC,CAAC;EAEhD,IAAMgB,kBAAkB,GAAG,IAAAC,cAAO,EAAC,YAAM;IACvC,IAAMC,mBAAmB,GAAG,SAAtBA,mBAAmBA,CAAA;MAAA,OAAS,IAAAtH,WAAA,CAAAgD,GAAA,EAAC1B,gBAAgB;QAACE,YAAY,EAAC,SAAS;QAACC,aAAa;MAAA,CAAE,CAAC;IAAA;IAC3F6F,mBAAmB,CAACC,WAAW,GAAG,4BAA4B;IAC9D,OAAOD,mBAAmB;EAC5B,CAAC,EAAE,EAAE,CAAC;EAEN,OACE,IAAAtH,WAAA,CAAAsC,IAAA,EAACnE,WAAA,CAAAqJ,KAAK;IAACC,aAAa,EAAE;MAAEC,eAAe,EAAE;IAAQ,CAAE;IAAA3E,QAAA,GACjD,IAAA/C,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MAACC,IAAI,EAAC,QAAQ;MAACC,OAAO,EAAE;QAAEC,WAAW,EAAE;MAAM;IAAE,CAAE,CAAC,EAC/D,IAAA9H,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MACXC,IAAI,EAAC,eAAe;MACpBC,OAAO,EAAE;QACPC,WAAW,EAAE,IAAI;QACjBC,YAAY,EAAE;MAChB;IAAE,CACH,CAAC,EACF,IAAA/H,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MACXC,IAAI,EAAC,mBAAmB;MACxBC,OAAO,EAAE;QACPG,KAAK,EAAE,oBAAoB;QAC3BD,YAAY,EAAE,MAAM;QACpBE,UAAU,EAAEb;MACd;IAAE,CACH,CAAC,EACF,IAAApH,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MACXC,IAAI,EAAC,oBAAoB;MACzBC,OAAO,EAAE;QACPC,WAAW,EAAE,KAAK;QAClBC,YAAY,EAAE;MAChB;IAAE,CACH,CAAC,EACF,IAAA/H,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MACXC,IAAI,EAAC,gBAAgB;MACrBC,OAAO,EAAE;QACPC,WAAW,EAAE,KAAK;QAClBC,YAAY,EAAE;MAChB;IAAE,CACH,CAAC,EACF,IAAA/H,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MACXC,IAAI,EAAC,iBAAiB;MACtBC,OAAO,EAAE;QACPG,KAAK,EAAE,sBAAsB;QAC7BD,YAAY,EAAE;MAChB;IAAE,CACH,CAAC,EACF,IAAA/H,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MACXC,IAAI,EAAC,gBAAgB;MACrBC,OAAO,EAAE;QACPG,KAAK,EAAE,qBAAqB;QAC5BD,YAAY,EAAE;MAChB;IAAE,CACH,CAAC,EACF,IAAA/H,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MACXC,IAAI,EAAC,QAAQ;MACbC,OAAO,EAAE;QACPG,KAAK,EAAE,SAAS;QAChBD,YAAY,EAAE;MAChB;IAAE,CACH,CAAC,EACF,IAAA/H,WAAA,CAAAgD,GAAA,EAAC7E,WAAA,CAAAqJ,KAAK,CAACG,MAAM;MACXC,IAAI,EAAC,MAAM;MACXC,OAAO,EAAE;QACPC,WAAW,EAAE,KAAK;QAClBC,YAAY,EAAE;MAChB;IAAE,CACH,CAAC;EAAA,CACG,CAAC;AAEZ;AAEA,SAASG,YAAYA,CAAAC,KAAA,EAAwC;EAAA,IAArCpF,QAAQ,GAAAoF,KAAA,CAARpF,QAAQ;EAC9B,OACE,IAAA/C,WAAA,CAAAgD,GAAA,EAAC/E,WAAA,CAAAmK,mBAAmB;IAACC,MAAM,EAAE5H,WAAY;IAAAsC,QAAA,EACvC,IAAA/C,WAAA,CAAAgD,GAAA,EAACnD,KAAA,CAAAyI,IAAI,CAACC,QAAQ;MAACF,MAAM,EAAEG,gBAAW;MAAC/H,WAAW,EAAEA,WAAY;MAAAsC,QAAA,EAC1D,IAAA/C,WAAA,CAAAgD,GAAA,EAACO,gBAAgB;QAAAR,QAAA,EACf,IAAA/C,WAAA,CAAAgD,GAAA,EAACnE,aAAA,CAAA4J,aAAa;UAAA1F,QAAA,EACZ,IAAA/C,WAAA,CAAAgD,GAAA,EAACjE,qBAAA,CAAA2J,qBAAqB;YAAA3F,QAAA,EACpB,IAAA/C,WAAA,CAAAgD,GAAA,EAACrE,YAAA,CAAAgK,YAAY;cAAA5F,QAAA,EACX,IAAA/C,WAAA,CAAAgD,GAAA,EAACrD,YAAA,CAAAiJ,YAAY;gBAAA7F,QAAA,EACX,IAAA/C,WAAA,CAAAgD,GAAA,EAAC/D,gBAAgB,CAAC4J,iBAAiB;kBAAA9F,QAAA,EACjC,IAAA/C,WAAA,CAAAgD,GAAA,EAACvD,eAAA,CAAAqJ,eAAe;oBAAA/F,QAAA,EACd,IAAA/C,WAAA,CAAAgD,GAAA,EAAChE,iBAAA,CAAA+J,iBAAiB;sBAAAhG,QAAA,EAChB,IAAA/C,WAAA,CAAAgD,GAAA,EAAC9D,sBAAA,CAAA8J,sBAAsB;wBAAAjG,QAAA,EACrB,IAAA/C,WAAA,CAAAgD,GAAA,EAACtE,kBAAA,CAAAuK,kBAAkB;0BAAAlG,QAAA,EACjB,IAAA/C,WAAA,CAAAgD,GAAA,EAACtD,uBAAA,CAAAwJ,uBAAuB;4BAAAnG,QAAA,EACtB,IAAA/C,WAAA,CAAAgD,GAAA,EAACpE,wBAAA,CAAAuK,wBAAwB;8BAAApG,QAAA,EACzB,IAAA/C,WAAA,CAAAgD,GAAA,EAAC7D,oBAAA,CAAAiK,oBAAoB;gCAAArG,QAAA,EACrB,IAAA/C,WAAA,CAAAgD,GAAA,EAAC5D,2BAAA,CAAAiK,2BAA2B;kCAAAtG,QAAA,EAC1B,IAAA/C,WAAA,CAAAgD,GAAA,EAAC3D,4BAAA,CAAAiK,4BAA4B;oCAAAvG,QAAA,EAC3B,IAAA/C,WAAA,CAAAgD,GAAA,EAAC1D,uBAAA,CAAAiK,uBAAuB;sCAAAxG,QAAA,EACtB,IAAA/C,WAAA,CAAAgD,GAAA,EAACzD,oBAAA,CAAAiK,oBAAoB;wCAAAzG,QAAA,EACrB,IAAA/C,WAAA,CAAAgD,GAAA,EAACxD,wBAAA,CAAAiK,wBAAwB;0CAAA1G,QAAA,EACvB,IAAA/C,WAAA,CAAAsC,IAAA,EAACxD,qBAAA,CAAA4K,qBAAqB;4CAAA3G,QAAA,GACpB,IAAA/C,WAAA,CAAAgD,GAAA,EAACpD,kBAAA,CAAA+J,iBAAiB,IAAE,CAAC,EACpB5G,QAAQ;0CAAA,CACY;wCAAC,CACA;sCAAC,CACL;oCAAC,CACA;kCAAC,CACE;gCAAC,CACJ;8BAAC,CACR;4BAAC,CACG;0BAAC,CACJ;wBAAC,CACR;sBAAC,CACC;oBAAC,CACR;kBAAC,CACL;gBAAC,CACgB;cAAC,CACzB;YAAC,CACH;UAAC,CACM;QAAC,CACX;MAAC,CACA;IAAC,CACN;EAAC,CACG,CAAC;AAE1B;AAEe,SAAS6G,UAAUA,CAAA,EAAG;EACnC,IAAAC,UAAA,GAA8B,IAAA5D,eAAQ,EAAChG,qBAAQ,CAACC,EAAE,KAAK,KAAK,CAAC;IAAA4J,UAAA,OAAA3D,eAAA,CAAAxC,OAAA,EAAAkG,UAAA;IAAtDzD,OAAO,GAAA0D,UAAA;IAAEzD,UAAU,GAAAyD,UAAA;EAE1B,IAAAnD,gBAAS,EAAC,YAAM;IACd,IAAIoD,SAAS,GAAG,IAAI;IAEpB,IAAMC,aAAa;MAAA,IAAAC,KAAA,OAAAC,kBAAA,CAAAvG,OAAA,EAAG,aAAY;QAChC,IAAI;UAGF,MAAM,IAAAwG,4CAA0B,EAAC,CAAC,CAACC,KAAK,CAAC,UAACC,GAAG,EAAK;YAChD/J,OAAO,CAACC,IAAI,CAAC,wDAAwD,EAAE8J,GAAG,CAAC;UAC7E,CAAC,CAAC;QACJ,CAAC,CAAC,OAAOhK,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,wCAAwC,EAAEA,KAAK,CAAC;QAEhE;MACF,CAAC;MAAA,gBAXK2J,aAAaA,CAAA;QAAA,OAAAC,KAAA,CAAAK,KAAA,OAAAzG,SAAA;MAAA;IAAA,GAWlB;IAGD,IAAI5D,qBAAQ,CAACC,EAAE,KAAK,KAAK,EAAE;MACzBmG,UAAU,CAAC,IAAI,CAAC;MAEhB2D,aAAa,CAAC,CAAC;MACf;IACF;IAGAA,aAAa,CAAC,CAAC;IAEf5L,YAAY,CAACmM,SAAS,CAAC,CAAC,CACrBH,KAAK,CAAC,UAAC/J,KAAK,EAAK;MAChB,MAAM,CAAC,gBAAgB,CAAC,CAACyB,IAAI,CAAC,UAAA0I,KAAA,EAAgB;QAAA,IAAbxI,MAAM,GAAAwI,KAAA,CAANxI,MAAM;QACrCA,MAAM,CAAC3B,KAAK,CAAC,8BAA8B,EAAEA,KAAK,YAAYoK,KAAK,GAAGpK,KAAK,GAAG,IAAIoK,KAAK,CAACzD,MAAM,CAAC3G,KAAK,CAAC,CAAC,EAAE;UAAE6B,SAAS,EAAE,YAAY;UAAEwI,MAAM,EAAE;QAAmB,CAAC,CAAC;MAClK,CAAC,CAAC;IACJ,CAAC,CAAC,CACDC,OAAO,CAAC,YAAM;MACb,IAAIZ,SAAS,EAAE;QACb1D,UAAU,CAAC,IAAI,CAAC;MAClB;IACF,CAAC,CAAC;IAEJ,OAAO,YAAM;MACX0D,SAAS,GAAG,KAAK;IACnB,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,IAAI,CAAC3D,OAAO,EAAE;IACZ,OAAO,IAAI;EACb;EAEA,OACE,IAAApG,WAAA,CAAAgD,GAAA,EAACkF,YAAY;IAAAnF,QAAA,EACX,IAAA/C,WAAA,CAAAgD,GAAA,EAACvE,0BAAA,CAAAmM,sBAAsB;MAACnI,KAAK,EAAEC,MAAM,CAACmI,SAAU;MAAA9H,QAAA,EAC9C,IAAA/C,WAAA,CAAAgD,GAAA,EAAC+C,aAAa,IAAE;IAAC,CACK;EAAC,CACb,CAAC;AAEnB;AAEA,IAAMrD,MAAM,GAAGoI,uBAAU,CAACC,MAAM,CAAC;EAC/BF,SAAS,EAAE;IACTG,IAAI,EAAE;EACR,CAAC;EACD1F,cAAc,EAAE;IACd0F,IAAI,EAAE,CAAC;IACPC,eAAe,EAAE,SAAS;IAC1BC,UAAU,EAAE,QAAQ;IACpBC,cAAc,EAAE,QAAQ;IACxBC,OAAO,EAAE;EACX,CAAC;EACD7F,UAAU,EAAE;IACV8F,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,KAAc;IAC1BnI,KAAK,EAAE,SAAS;IAChBoI,YAAY,EAAE,EAAE;IAChBC,SAAS,EAAE;EACb,CAAC;EACDhG,YAAY,EAAE;IACZ6F,QAAQ,EAAE,EAAE;IACZlI,KAAK,EAAE,SAAS;IAChBqI,SAAS,EAAE,QAAiB;IAC5BD,YAAY,EAAE;EAChB,CAAC;EACD9F,WAAW,EAAE;IACXwF,eAAe,EAAE,SAAS;IAC1BQ,iBAAiB,EAAE,EAAE;IACrBC,eAAe,EAAE,EAAE;IACnBC,YAAY,EAAE;EAChB,CAAC;EACDjG,eAAe,EAAE;IACf2F,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,KAAc;IAC1BnI,KAAK,EAAE,SAAS;IAChByI,aAAa,EAAE;EACjB,CAAC;EACDjJ,gBAAgB,EAAE;IAChBkJ,aAAa,EAAE,KAAK;IACpBX,UAAU,EAAE,QAAQ;IACpBO,iBAAiB,EAAE,CAAC;IACpBC,eAAe,EAAE,CAAC;IAClBC,YAAY,EAAE,GAAG;IACjBG,UAAU,EAAE,CAAC;IACbC,GAAG,EAAE,CAAC;IACNd,eAAe,EAAE;EACnB,CAAC;EACD7H,cAAc,EAAE;IACdD,KAAK,EAAE;EACT,CAAC;EACDG,cAAc,EAAE;IACd+H,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,KAAc;IAC1BnI,KAAK,EAAE;EACT;AACF,CAAC,CAAC","ignoreList":[]}