b291bf0e58db3d827d3ec3ef65c9c2b7
function cov_52536hyrr() {
  var path = "/Users/mac/Desktop/rork-kiku/backend/trpc/routes/notifications/log-device-test.ts";
  var hash = "15e829dc53262cc010c94c32154526feed8057c3";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/Users/mac/Desktop/rork-kiku/backend/trpc/routes/notifications/log-device-test.ts",
    statementMap: {
      "0": {
        start: {
          line: 6,
          column: 25
        },
        end: {
          line: 13,
          column: 2
        }
      },
      "1": {
        start: {
          line: 15,
          column: 38
        },
        end: {
          line: 32,
          column: 4
        }
      },
      "2": {
        start: {
          line: 23,
          column: 19
        },
        end: {
          line: 23,
          column: 67
        }
      },
      "3": {
        start: {
          line: 24,
          column: 4
        },
        end: {
          line: 26,
          column: 5
        }
      },
      "4": {
        start: {
          line: 25,
          column: 6
        },
        end: {
          line: 25,
          column: 83
        }
      },
      "5": {
        start: {
          line: 28,
          column: 4
        },
        end: {
          line: 31,
          column: 6
        }
      }
    },
    fnMap: {
      "0": {
        name: "(anonymous_0)",
        decl: {
          start: {
            line: 22,
            column: 12
          },
          end: {
            line: 22,
            column: 13
          }
        },
        loc: {
          start: {
            line: 22,
            column: 27
          },
          end: {
            line: 32,
            column: 3
          }
        },
        line: 22
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 24,
            column: 4
          },
          end: {
            line: 26,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 24,
            column: 4
          },
          end: {
            line: 26,
            column: 5
          }
        }, {
          start: {
            line: undefined,
            column: undefined
          },
          end: {
            line: undefined,
            column: undefined
          }
        }],
        line: 24
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0
    },
    f: {
      "0": 0
    },
    b: {
      "0": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "15e829dc53262cc010c94c32154526feed8057c3"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    cov_52536hyrr = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_52536hyrr();
import { TRPCError } from '@trpc/server';
import { z } from 'zod';
import { publicProcedure } from '../../create-context.js';
import { appendTestResults } from './store.js';
var testResultSchema = (cov_52536hyrr().s[0]++, z.object({
  id: z.string().min(3),
  type: z.enum(['permissions', 'token', 'delivery', 'sync']),
  status: z.enum(['passed', 'failed']),
  message: z.string().min(1),
  timestamp: z.number().int(),
  deviceLabel: z.string().optional()
}));
export var logDeviceTestProcedure = (cov_52536hyrr().s[1]++, publicProcedure.input(z.object({
  deviceId: z.string().min(3),
  results: z.array(testResultSchema).min(1)
})).mutation(function (_ref) {
  var input = _ref.input;
  cov_52536hyrr().f[0]++;
  var device = (cov_52536hyrr().s[2]++, appendTestResults(input.deviceId, input.results));
  cov_52536hyrr().s[3]++;
  if (!device) {
    cov_52536hyrr().b[0][0]++;
    cov_52536hyrr().s[4]++;
    throw new TRPCError({
      code: 'NOT_FOUND',
      message: 'Device not registered'
    });
  } else {
    cov_52536hyrr().b[0][1]++;
  }
  cov_52536hyrr().s[5]++;
  return {
    device: device,
    lastTestedAt: device.lastTestedAt
  };
}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUUlBDRXJyb3IiLCJ6IiwicHVibGljUHJvY2VkdXJlIiwiYXBwZW5kVGVzdFJlc3VsdHMiLCJ0ZXN0UmVzdWx0U2NoZW1hIiwiY292XzUyNTM2aHlyciIsInMiLCJvYmplY3QiLCJpZCIsInN0cmluZyIsIm1pbiIsInR5cGUiLCJlbnVtIiwic3RhdHVzIiwibWVzc2FnZSIsInRpbWVzdGFtcCIsIm51bWJlciIsImludCIsImRldmljZUxhYmVsIiwib3B0aW9uYWwiLCJsb2dEZXZpY2VUZXN0UHJvY2VkdXJlIiwiaW5wdXQiLCJkZXZpY2VJZCIsInJlc3VsdHMiLCJhcnJheSIsIm11dGF0aW9uIiwiX3JlZiIsImYiLCJkZXZpY2UiLCJiIiwiY29kZSIsImxhc3RUZXN0ZWRBdCJdLCJzb3VyY2VzIjpbImxvZy1kZXZpY2UtdGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBUUlBDRXJyb3IgfSBmcm9tICdAdHJwYy9zZXJ2ZXInO1xuaW1wb3J0IHsgeiB9IGZyb20gJ3pvZCc7XG5pbXBvcnQgeyBwdWJsaWNQcm9jZWR1cmUgfSBmcm9tICcuLi8uLi9jcmVhdGUtY29udGV4dC5qcyc7XG5pbXBvcnQgeyBhcHBlbmRUZXN0UmVzdWx0cyB9IGZyb20gJy4vc3RvcmUuanMnO1xuXG5jb25zdCB0ZXN0UmVzdWx0U2NoZW1hID0gei5vYmplY3Qoe1xuICBpZDogei5zdHJpbmcoKS5taW4oMyksXG4gIHR5cGU6IHouZW51bShbJ3Blcm1pc3Npb25zJywgJ3Rva2VuJywgJ2RlbGl2ZXJ5JywgJ3N5bmMnXSksXG4gIHN0YXR1czogei5lbnVtKFsncGFzc2VkJywgJ2ZhaWxlZCddKSxcbiAgbWVzc2FnZTogei5zdHJpbmcoKS5taW4oMSksXG4gIHRpbWVzdGFtcDogei5udW1iZXIoKS5pbnQoKSxcbiAgZGV2aWNlTGFiZWw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbn0pO1xuXG5leHBvcnQgY29uc3QgbG9nRGV2aWNlVGVzdFByb2NlZHVyZSA9IHB1YmxpY1Byb2NlZHVyZVxuICAuaW5wdXQoXG4gICAgei5vYmplY3Qoe1xuICAgICAgZGV2aWNlSWQ6IHouc3RyaW5nKCkubWluKDMpLFxuICAgICAgcmVzdWx0czogei5hcnJheSh0ZXN0UmVzdWx0U2NoZW1hKS5taW4oMSksXG4gICAgfSksXG4gIClcbiAgLm11dGF0aW9uKCh7IGlucHV0IH0pID0+IHtcbiAgICBjb25zdCBkZXZpY2UgPSBhcHBlbmRUZXN0UmVzdWx0cyhpbnB1dC5kZXZpY2VJZCwgaW5wdXQucmVzdWx0cyk7XG4gICAgaWYgKCFkZXZpY2UpIHtcbiAgICAgIHRocm93IG5ldyBUUlBDRXJyb3IoeyBjb2RlOiAnTk9UX0ZPVU5EJywgbWVzc2FnZTogJ0RldmljZSBub3QgcmVnaXN0ZXJlZCcgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGRldmljZSxcbiAgICAgIGxhc3RUZXN0ZWRBdDogZGV2aWNlLmxhc3RUZXN0ZWRBdCxcbiAgICB9O1xuICB9KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLFNBQVNBLFNBQVMsUUFBUSxjQUFjO0FBQ3hDLFNBQVNDLENBQUMsUUFBUSxLQUFLO0FBQ3ZCLFNBQVNDLGVBQWUsUUFBUSx5QkFBeUI7QUFDekQsU0FBU0MsaUJBQWlCLFFBQVEsWUFBWTtBQUU5QyxJQUFNQyxnQkFBZ0IsSUFBQUMsYUFBQSxHQUFBQyxDQUFBLE9BQUdMLENBQUMsQ0FBQ00sTUFBTSxDQUFDO0VBQ2hDQyxFQUFFLEVBQUVQLENBQUMsQ0FBQ1EsTUFBTSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLENBQUMsQ0FBQztFQUNyQkMsSUFBSSxFQUFFVixDQUFDLENBQUNXLElBQUksQ0FBQyxDQUFDLGFBQWEsRUFBRSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sQ0FBQyxDQUFDO0VBQzFEQyxNQUFNLEVBQUVaLENBQUMsQ0FBQ1csSUFBSSxDQUFDLENBQUMsUUFBUSxFQUFFLFFBQVEsQ0FBQyxDQUFDO0VBQ3BDRSxPQUFPLEVBQUViLENBQUMsQ0FBQ1EsTUFBTSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLENBQUMsQ0FBQztFQUMxQkssU0FBUyxFQUFFZCxDQUFDLENBQUNlLE1BQU0sQ0FBQyxDQUFDLENBQUNDLEdBQUcsQ0FBQyxDQUFDO0VBQzNCQyxXQUFXLEVBQUVqQixDQUFDLENBQUNRLE1BQU0sQ0FBQyxDQUFDLENBQUNVLFFBQVEsQ0FBQztBQUNuQyxDQUFDLENBQUM7QUFFRixPQUFPLElBQU1DLHNCQUFzQixJQUFBZixhQUFBLEdBQUFDLENBQUEsT0FBR0osZUFBZSxDQUNsRG1CLEtBQUssQ0FDSnBCLENBQUMsQ0FBQ00sTUFBTSxDQUFDO0VBQ1BlLFFBQVEsRUFBRXJCLENBQUMsQ0FBQ1EsTUFBTSxDQUFDLENBQUMsQ0FBQ0MsR0FBRyxDQUFDLENBQUMsQ0FBQztFQUMzQmEsT0FBTyxFQUFFdEIsQ0FBQyxDQUFDdUIsS0FBSyxDQUFDcEIsZ0JBQWdCLENBQUMsQ0FBQ00sR0FBRyxDQUFDLENBQUM7QUFDMUMsQ0FBQyxDQUNILENBQUMsQ0FDQWUsUUFBUSxDQUFDLFVBQUFDLElBQUEsRUFBZTtFQUFBLElBQVpMLEtBQUssR0FBQUssSUFBQSxDQUFMTCxLQUFLO0VBQUFoQixhQUFBLEdBQUFzQixDQUFBO0VBQ2hCLElBQU1DLE1BQU0sSUFBQXZCLGFBQUEsR0FBQUMsQ0FBQSxPQUFHSCxpQkFBaUIsQ0FBQ2tCLEtBQUssQ0FBQ0MsUUFBUSxFQUFFRCxLQUFLLENBQUNFLE9BQU8sQ0FBQztFQUFDbEIsYUFBQSxHQUFBQyxDQUFBO0VBQ2hFLElBQUksQ0FBQ3NCLE1BQU0sRUFBRTtJQUFBdkIsYUFBQSxHQUFBd0IsQ0FBQTtJQUFBeEIsYUFBQSxHQUFBQyxDQUFBO0lBQ1gsTUFBTSxJQUFJTixTQUFTLENBQUM7TUFBRThCLElBQUksRUFBRSxXQUFXO01BQUVoQixPQUFPLEVBQUU7SUFBd0IsQ0FBQyxDQUFDO0VBQzlFLENBQUM7SUFBQVQsYUFBQSxHQUFBd0IsQ0FBQTtFQUFBO0VBQUF4QixhQUFBLEdBQUFDLENBQUE7RUFFRCxPQUFPO0lBQ0xzQixNQUFNLEVBQU5BLE1BQU07SUFDTkcsWUFBWSxFQUFFSCxNQUFNLENBQUNHO0VBQ3ZCLENBQUM7QUFDSCxDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=