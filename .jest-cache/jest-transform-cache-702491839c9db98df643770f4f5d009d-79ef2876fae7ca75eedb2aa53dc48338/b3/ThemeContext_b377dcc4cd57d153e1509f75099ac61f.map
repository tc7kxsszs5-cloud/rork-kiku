{"version":3,"names":["createContextHook","AsyncStorage","useCallback","useEffect","useMemo","useState","lightThemeColors","darkThemeColors","logger","THEME_STORAGE_KEY","cov_nn985clxe","s","createThemePalette","semanticColors","isDark","f","Object","assign","backgroundPrimary","background","primary","backgroundSecondary","secondary","card","surface","cardMuted","muted","textPrimary","text","textSecondary","accentPrimary","interactive","accentMuted","borderSoft","border","headerBackground","elevated","headerText","tabBarBackground","tabBarActive","tabBarInactive","tertiary","heroGradient","surfaceGradient","chipBackground","chipText","success","status","safe","warning","danger","THEMES","sunrise","midnight","THEME_OPTIONS","value","label","description","_ref","_ref3","_ref4","_slicedToArray","themeMode","setThemeModeState","_ref5","_ref6","isReady","setIsReady","isMounted","loadTheme","_ref7","_asyncToGenerator","storedMode","getItem","b","info","context","action","mode","error","Error","String","apply","arguments","persistMode","_ref8","setItem","console","log","_x","setThemeMode","current","catch","toggleThemeMode","theme","themeOptions","_ref2","ThemeProvider","useThemeMode"],"sources":["ThemeContext.tsx"],"sourcesContent":["import createContextHook from '@nkzw/create-context-hook';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { lightThemeColors, darkThemeColors, SemanticColors } from './ColorSystem';\nimport { logger } from '@/utils/logger';\n\nexport type ThemeMode = 'sunrise' | 'midnight';\n\n/**\n * Расширенная палитра темы с улучшенной цветовой системой\n */\nexport interface ThemePalette extends SemanticColors {\n  // Legacy поддержка (для обратной совместимости)\n  backgroundPrimary: string;\n  backgroundSecondary: string;\n  card: string;\n  cardMuted: string;\n  textPrimary: string;\n  textSecondary: string;\n  accentPrimary: string;\n  accentMuted: string;\n  borderSoft: string;\n  headerBackground: string;\n  headerText: string;\n  tabBarBackground: string;\n  tabBarActive: string;\n  tabBarInactive: string;\n  heroGradient: [string, string];\n  surfaceGradient: [string, string];\n  chipBackground: string;\n  chipText: string;\n  isDark: boolean;\n  // Удобные алиасы для часто используемых цветов\n  primary: string;\n  success: string;\n  warning: string;\n  danger: string;\n}\n\nconst THEME_STORAGE_KEY = '@theme_mode_preference';\n\n/**\n * Создание полной палитры темы из семантических цветов\n */\nconst createThemePalette = (semanticColors: SemanticColors, isDark: boolean): ThemePalette => {\n  return {\n    ...semanticColors,\n    // Legacy поддержка\n    backgroundPrimary: semanticColors.background.primary,\n    backgroundSecondary: semanticColors.background.secondary,\n    card: semanticColors.surface.primary,\n    cardMuted: semanticColors.surface.muted,\n    textPrimary: semanticColors.text.primary,\n    textSecondary: semanticColors.text.secondary,\n    accentPrimary: semanticColors.interactive.primary,\n    accentMuted: semanticColors.interactive.secondary,\n    borderSoft: semanticColors.border.muted,\n    headerBackground: semanticColors.surface.elevated,\n    headerText: semanticColors.text.primary,\n    tabBarBackground: semanticColors.surface.elevated,\n    tabBarActive: semanticColors.interactive.primary,\n    tabBarInactive: semanticColors.text.tertiary,\n    heroGradient: [semanticColors.background.primary, semanticColors.background.secondary],\n    surfaceGradient: [semanticColors.surface.primary, semanticColors.surface.secondary],\n    chipBackground: semanticColors.surface.secondary,\n    chipText: semanticColors.text.primary,\n    isDark,\n    // Удобные алиасы\n    primary: semanticColors.interactive.primary,\n    success: semanticColors.status.safe,\n    warning: semanticColors.status.warning,\n    danger: semanticColors.status.danger,\n  };\n};\n\nconst THEMES: Record<ThemeMode, ThemePalette> = {\n  sunrise: createThemePalette(lightThemeColors, false),\n  midnight: createThemePalette(darkThemeColors, true),\n};\n\n// Уникальные названия тем с контекстом детской безопасности\nconst THEME_OPTIONS: { value: ThemeMode; label: string; description: string }[] = [\n  {\n    value: 'sunrise',\n    label: 'Теплый день',\n    description: 'Теплый защищающий фон с яркими акцентами безопасности',\n  },\n  {\n    value: 'midnight',\n    label: 'Ночной режим',\n    description: 'Глубокий темный фон с теплыми неоновыми акцентами',\n  },\n];\n\ninterface ThemeContextValue {\n  themeMode: ThemeMode;\n  theme: ThemePalette;\n  setThemeMode: (mode: ThemeMode) => void;\n  toggleThemeMode: () => void;\n  themeOptions: typeof THEME_OPTIONS;\n  isReady: boolean;\n}\n\nexport const [ThemeProvider, useThemeMode] = createContextHook<ThemeContextValue>(() => {\n  const [themeMode, setThemeModeState] = useState<ThemeMode>('sunrise');\n  const [isReady, setIsReady] = useState<boolean>(false);\n\n  useEffect(() => {\n    let isMounted = true;\n\n    const loadTheme = async () => {\n      try {\n        const storedMode = await AsyncStorage.getItem(THEME_STORAGE_KEY);\n        if (storedMode && (storedMode === 'sunrise' || storedMode === 'midnight') && isMounted) {\n          setThemeModeState(storedMode);\n          logger.info('Loaded mode from storage', { context: 'ThemeContext', action: 'loadTheme', mode: storedMode });\n        }\n      } catch (error) {\n        logger.error('Failed to load theme mode', error instanceof Error ? error : new Error(String(error)), { context: 'ThemeContext', action: 'loadTheme' });\n      } finally {\n        if (isMounted) {\n          setIsReady(true);\n        }\n      }\n    };\n\n    loadTheme();\n\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  const persistMode = useCallback(async (mode: ThemeMode) => {\n    try {\n      await AsyncStorage.setItem(THEME_STORAGE_KEY, mode);\n      console.log('[ThemeContext] Persisted theme mode', mode);\n    } catch (error) {\n      console.error('[ThemeContext] Failed to persist theme mode', error);\n    }\n  }, []);\n\n  const setThemeMode = useCallback(\n    (mode: ThemeMode) => {\n      setThemeModeState((current) => (current === mode ? current : mode));\n      persistMode(mode).catch((error) => logger.error('Failed to persist theme mode in setThemeMode', error instanceof Error ? error : new Error(String(error)), { context: 'ThemeContext', action: 'setThemeMode', mode }));\n    },\n    [persistMode],\n  );\n\n  const toggleThemeMode = useCallback(() => {\n    setThemeMode(themeMode === 'sunrise' ? 'midnight' : 'sunrise');\n  }, [setThemeMode, themeMode]);\n\n  const value = useMemo<ThemeContextValue>(() => ({\n    themeMode,\n    theme: THEMES[themeMode],\n    setThemeMode,\n    toggleThemeMode,\n    themeOptions: THEME_OPTIONS,\n    isReady,\n  }), [themeMode, setThemeMode, toggleThemeMode, isReady]);\n\n  return value;\n});\n"],"mappings":"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","ignoreList":[]}