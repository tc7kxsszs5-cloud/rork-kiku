{"version":3,"names":["_getJestObj","mock","useChatBackgrounds","jest","fn","backgrounds","id","name","type","value","setChatBackground","mockResolvedValue","undefined","useThemeMode","theme","text","textSecondary","borderSoft","_asyncToGenerator","_require2","require","React","render","fireEvent","waitFor","ChatBackgroundPicker","jsx","_jsx","describe","beforeEach","clearAllMocks","it","_render","chatId","getByText","expect","toBeTruthy","_render2","_render3","visible","queryByText","toBeNull","_require","mockSetChatBackground","mockReturnValue","_render4","UNSAFE_getAllByType","touchables","backgroundButton","find","btn","props","onPress","press","toHaveBeenCalledWith","mockOnSelect","_render5","onSelect","mockOnClose","_render6","onClose","toHaveBeenCalled","_render7","_render8"],"sources":["ChatBackgroundPicker.test.tsx"],"sourcesContent":["/**\n * Тесты для ChatBackgroundPicker\n * Проверяет выбор фона чата, отображение фонов, взаимодействие с контекстом\n */\n\nimport React from 'react';\nimport { render, fireEvent, waitFor } from '@testing-library/react-native';\nimport { ChatBackgroundPicker } from '@/components/ChatBackgroundPicker';\n\n// Моки\njest.mock('@/constants/ChatBackgroundsContext', () => ({\n  useChatBackgrounds: jest.fn(() => ({\n    backgrounds: [\n      {\n        id: 'bg-1',\n        name: 'Синий',\n        type: 'color',\n        value: '#4A90E2',\n      },\n      {\n        id: 'bg-2',\n        name: 'Градиент',\n        type: 'gradient',\n        value: ['#FF6B9D', '#C44569'],\n      },\n      {\n        id: 'bg-3',\n        name: 'Зеленый',\n        type: 'color',\n        value: '#52C41A',\n      },\n    ],\n    setChatBackground: jest.fn().mockResolvedValue(undefined),\n  })),\n}));\n\njest.mock('@/constants/ThemeContext', () => ({\n  useThemeMode: jest.fn(() => ({\n    theme: {\n      text: '#000000',\n      textSecondary: '#666666',\n      borderSoft: '#cccccc',\n    },\n  })),\n}));\n\ndescribe('ChatBackgroundPicker', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Рендеринг', () => {\n    it('должен отображать пикер фонов', () => {\n      const { getByText } = render(\n        <ChatBackgroundPicker chatId=\"chat-1\" />\n      );\n\n      expect(getByText('Выберите фон чата')).toBeTruthy();\n    });\n\n    it('должен отображать все доступные фоны', () => {\n      const { getByText } = render(\n        <ChatBackgroundPicker chatId=\"chat-1\" />\n      );\n\n      expect(getByText('Синий')).toBeTruthy();\n      expect(getByText('Градиент')).toBeTruthy();\n      expect(getByText('Зеленый')).toBeTruthy();\n    });\n\n    it('не должен отображаться когда visible=false', () => {\n      const { queryByText } = render(\n        <ChatBackgroundPicker chatId=\"chat-1\" visible={false} />\n      );\n\n      expect(queryByText('Выберите фон чата')).toBeNull();\n    });\n  });\n\n  describe('Выбор фона', () => {\n    it('должен вызывать setChatBackground при выборе фона', async () => {\n      const { useChatBackgrounds } = require('@/constants/ChatBackgroundsContext');\n      const mockSetChatBackground = jest.fn().mockResolvedValue(undefined);\n      useChatBackgrounds.mockReturnValue({\n        backgrounds: [\n          {\n            id: 'bg-1',\n            name: 'Синий',\n            type: 'color',\n            value: '#4A90E2',\n          },\n        ],\n        setChatBackground: mockSetChatBackground,\n      });\n\n      const { getByText, UNSAFE_getAllByType } = render(\n        <ChatBackgroundPicker chatId=\"chat-1\" />\n      );\n\n      const touchables = UNSAFE_getAllByType('TouchableOpacity');\n      const backgroundButton = touchables.find((btn: any) =>\n        btn.props.onPress && getByText('Синий')\n      );\n\n      if (backgroundButton) {\n        await fireEvent.press(backgroundButton);\n      }\n\n      await waitFor(() => {\n        expect(mockSetChatBackground).toHaveBeenCalledWith('chat-1', 'bg-1');\n      });\n    });\n\n    it('должен вызывать onSelect при выборе фона', async () => {\n      const mockOnSelect = jest.fn();\n      const { getByText, UNSAFE_getAllByType } = render(\n        <ChatBackgroundPicker chatId=\"chat-1\" onSelect={mockOnSelect} />\n      );\n\n      const touchables = UNSAFE_getAllByType('TouchableOpacity');\n      const backgroundButton = touchables.find((btn: any) =>\n        btn.props.onPress && getByText('Синий')\n      );\n\n      if (backgroundButton) {\n        await fireEvent.press(backgroundButton);\n      }\n\n      await waitFor(() => {\n        expect(mockOnSelect).toHaveBeenCalledWith('bg-1');\n      });\n    });\n\n    it('должен вызывать onClose после выбора фона', async () => {\n      const mockOnClose = jest.fn();\n      const { getByText, UNSAFE_getAllByType } = render(\n        <ChatBackgroundPicker chatId=\"chat-1\" onClose={mockOnClose} />\n      );\n\n      const touchables = UNSAFE_getAllByType('TouchableOpacity');\n      const backgroundButton = touchables.find((btn: any) =>\n        btn.props.onPress && getByText('Синий')\n      );\n\n      if (backgroundButton) {\n        await fireEvent.press(backgroundButton);\n      }\n\n      await waitFor(() => {\n        expect(mockOnClose).toHaveBeenCalled();\n      });\n    });\n  });\n\n  describe('Отображение фонов', () => {\n    it('должен отображать цветные фоны с правильным цветом', () => {\n      const { getByText } = render(\n        <ChatBackgroundPicker chatId=\"chat-1\" />\n      );\n\n      expect(getByText('Синий')).toBeTruthy();\n      expect(getByText('Зеленый')).toBeTruthy();\n    });\n\n    it('должен отображать градиентные фоны', () => {\n      const { getByText } = render(\n        <ChatBackgroundPicker chatId=\"chat-1\" />\n      );\n\n      expect(getByText('Градиент')).toBeTruthy();\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}