{"version":3,"names":["createContextHook","useState","useEffect","useCallback","useMemo","AsyncStorage","Platform","i18n","logger","handleErrorSilently","showUserFriendlyError","USER_STORAGE_KEY","_createContextHook","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","isLoading","setIsLoading","isMounted","timer","loadUser","_ref","_asyncToGenerator","stored","getItem","userData","JSON","parse","migratedUser","Object","assign","role","children","language","changeLanguage","_yield$import","detectDeviceLanguage","detectedLang","info","context","error","action","apply","arguments","OS","setTimeout","clearTimeout","identifyUser","_ref2","newUser","id","Date","now","Math","random","toString","substr","createdAt","setItem","stringify","userId","userName","name","childrenCount","length","Error","String","_x","updateUser","_ref3","updates","updatedUser","_x2","addChild","_ref4","childData","newChild","addedAt","parentId","permissions","canChangeChatBackgrounds","canChangeNotificationSounds","canAddContacts","concat","_toConsumableArray","console","log","_x3","removeChild","_ref5","childId","updatedChildren","filter","child","activeChildId","undefined","_x4","setActiveChild","_ref6","_x5","logoutUser","removeItem","activeChild","find","isAuthenticated","_createContextHook2","UserProvider","useUser"],"sources":["UserContext.tsx"],"sourcesContent":["import createContextHook from '@nkzw/create-context-hook';\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\nimport i18n from './i18n';\nimport { logger } from '@/utils/logger';\n\nimport { UserRole, ParentGender } from './types';\nimport { handleErrorSilently, showUserFriendlyError } from '@/utils/errorHandler';\n\nexport interface ChildProfile {\n  id: string;\n  name: string;\n  age?: number;\n  avatar?: string;\n  deviceId?: string;\n  addedAt: number;\n  parentId?: string; // ID родителя-владельца\n  pin?: string; // PIN для входа ребенка (опционально)\n  permissions?: {\n    canChangeChatBackgrounds?: boolean;\n    canChangeNotificationSounds?: boolean;\n    canAddContacts?: boolean;\n  };\n}\n\nexport interface User {\n  id: string;\n  name: string;\n  email?: string;\n  avatar?: string;\n  createdAt: number;\n  deviceId?: string;\n  language?: string;\n  role?: UserRole; // 'parent' | 'child' (опционально для обратной совместимости)\n  parentId?: string; // Если role='child', указывает на родителя\n  parentPin?: string; // PIN родителя для аутентификации\n  parentGender?: ParentGender; // Пол родителя (для локализации)\n  country?: string; // Страна (для локализации)\n  children: ChildProfile[]; // Массив детей родителя\n  activeChildId?: string; // ID активного (выбранного) ребенка для просмотра\n}\n\nconst USER_STORAGE_KEY = '@user_data';\n\nexport const [UserProvider, useUser] = createContextHook(() => {\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    let isMounted = true;\n    let timer: ReturnType<typeof setTimeout> | undefined;\n\n    const loadUser = async () => {\n      try {\n        const stored = await AsyncStorage.getItem(USER_STORAGE_KEY);\n        if (!isMounted) {\n          return;\n        }\n        if (stored) {\n          const userData = JSON.parse(stored);\n          // Миграция: если нет role, устанавливаем 'parent' по умолчанию\n          const migratedUser: User = {\n            ...userData,\n            role: userData.role || 'parent', // По умолчанию родитель\n            children: userData.children || [], // Обеспечиваем наличие children\n          };\n          setUser(migratedUser);\n          if (migratedUser.language) {\n            i18n.changeLanguage(migratedUser.language);\n          }\n        } else {\n          // Первый запуск - определяем язык устройства автоматически\n          const { detectDeviceLanguage } = await import('@/constants/i18n');\n          const detectedLang = await detectDeviceLanguage();\n          if (detectedLang && detectedLang !== i18n.language) {\n            i18n.changeLanguage(detectedLang);\n            logger.info('Auto-detected language', { context: 'UserContext', language: detectedLang });\n          }\n        }\n      } catch (error) {\n        handleErrorSilently(error, 'UserContext', { action: 'loadUser' });\n      } finally {\n        if (isMounted) {\n          setIsLoading(false);\n        }\n      }\n    };\n\n    if (Platform.OS !== 'web') {\n      loadUser();\n    } else {\n      timer = setTimeout(loadUser, 0);\n    }\n\n    return () => {\n      isMounted = false;\n      if (timer) {\n        clearTimeout(timer);\n      }\n    };\n  }, []);\n\n  const identifyUser = useCallback(async (userData: Omit<User, 'id' | 'createdAt' | 'children'> & { children?: ChildProfile[] }) => {\n    try {\n      const newUser: User = {\n        id: `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        createdAt: Date.now(),\n        children: userData.children || [],\n        ...userData,\n      };\n\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(newUser));\n      setUser(newUser);\n\n      logger.info('User identified', { context: 'UserContext', userId: newUser.id, userName: newUser.name, childrenCount: newUser.children.length });\n\n      return newUser;\n    } catch (error) {\n      logger.error('Error identifying user', error instanceof Error ? error : new Error(String(error)), { context: 'UserContext', action: 'identifyUser' });\n      throw error;\n    }\n  }, []);\n\n  const updateUser = useCallback(async (updates: Partial<Omit<User, 'id' | 'createdAt'>>) => {\n    if (!user) {\n      throw new Error('No user to update');\n    }\n\n    try {\n      const updatedUser = { ...user, ...updates };\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));\n      setUser(updatedUser);\n\n      if (updates.language) {\n        i18n.changeLanguage(updates.language);\n      }\n\n      logger.info('User updated', { context: 'UserContext', userId: updatedUser.id, action: 'updateUser' });\n      return updatedUser;\n    } catch (error) {\n      handleErrorSilently(error, 'UserContext', { action: 'updateUser' });\n      await showUserFriendlyError(error, 'UserContext', { action: 'updateUser' });\n      throw error;\n    }\n  }, [user]);\n\n  const addChild = useCallback(async (childData: Omit<ChildProfile, 'id' | 'addedAt' | 'parentId'>) => {\n    if (!user) {\n      throw new Error('No user to add child to');\n    }\n\n    // Проверка: только родитель может добавлять детей\n    if (user.role === 'child') {\n      throw new Error('Only parent can add children');\n    }\n\n    try {\n      const newChild: ChildProfile = {\n        id: `child_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        addedAt: Date.now(),\n        parentId: user.id,\n        permissions: {\n          canChangeChatBackgrounds: true,\n          canChangeNotificationSounds: true,\n          canAddContacts: false, // По умолчанию только родитель\n          ...childData.permissions,\n        },\n        ...childData,\n      };\n\n      const updatedUser = {\n        ...user,\n        children: [...user.children, newChild],\n      };\n\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));\n      setUser(updatedUser);\n\n      console.log('Child added:', newChild.id);\n      return newChild;\n    } catch (error) {\n      console.error('Error adding child:', error);\n      throw error;\n    }\n  }, [user]);\n\n  const removeChild = useCallback(async (childId: string) => {\n    if (!user) {\n      throw new Error('No user to remove child from');\n    }\n\n    try {\n      const updatedChildren = user.children.filter(child => child.id !== childId);\n      const updatedUser = {\n        ...user,\n        children: updatedChildren,\n        activeChildId: user.activeChildId === childId ? undefined : user.activeChildId,\n      };\n\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));\n      setUser(updatedUser);\n\n      logger.info('Child removed', { context: 'UserContext', childId, action: 'removeChild' });\n    } catch (error) {\n      logger.error('Error removing child', error instanceof Error ? error : new Error(String(error)), { context: 'UserContext', action: 'removeChild' });\n      throw error;\n    }\n  }, [user]);\n\n  const setActiveChild = useCallback(async (childId: string | undefined) => {\n    if (!user) {\n      throw new Error('No user to update');\n    }\n\n    try {\n      const updatedUser = { ...user, activeChildId: childId };\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));\n      setUser(updatedUser);\n\n      logger.info('Active child set', { context: 'UserContext', childId, action: 'setActiveChild' });\n    } catch (error) {\n      handleErrorSilently(error, 'UserContext', { action: 'setActiveChild' });\n      await showUserFriendlyError(error, 'UserContext', { action: 'setActiveChild' });\n      throw error;\n    }\n  }, [user]);\n\n  const logoutUser = useCallback(async () => {\n    try {\n      await AsyncStorage.removeItem(USER_STORAGE_KEY);\n      setUser(null);\n      logger.info('User logged out', { context: 'UserContext', action: 'logoutUser' });\n    } catch (error) {\n      handleErrorSilently(error, 'UserContext', { action: 'logoutUser' });\n      await showUserFriendlyError(error, 'UserContext', { action: 'logoutUser' });\n      throw error;\n    }\n  }, []);\n\n  const activeChild = useMemo(() => {\n    if (!user || !user.activeChildId) return null;\n    return user.children.find(child => child.id === user.activeChildId) || null;\n  }, [user]);\n\n  return useMemo(() => ({\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n    activeChild,\n    children: user?.children || [],\n    identifyUser,\n    updateUser,\n    addChild,\n    removeChild,\n    setActiveChild,\n    logoutUser,\n  }), [user, isLoading, activeChild, identifyUser, updateUser, addChild, removeChild, setActiveChild, logoutUser]);\n});\n"],"mappings":";;;AAAA,OAAOA,iBAAiB,MAAM,2BAA2B;AACzD,SAASC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,EAAEC,OAAO,QAAQ,OAAO;AACjE,OAAOC,YAAY,MAAM,2CAA2C;AACpE,SAASC,QAAQ,QAAQ,cAAc;AACvC,OAAOC,IAAI,MAAM,QAAQ;AACzB,SAASC,MAAM,QAAQ,gBAAgB;AAGvC,SAASC,mBAAmB,EAAEC,qBAAqB,QAAQ,sBAAsB;AAmCjF,IAAMC,gBAAgB,GAAG,YAAY;AAE9B,IAAAC,kBAAA,GAAgCZ,iBAAiB,CAAC,YAAM;IAC7D,IAAAa,SAAA,GAAwBZ,QAAQ,CAAc,IAAI,CAAC;MAAAa,UAAA,GAAAC,cAAA,CAAAF,SAAA;MAA5CG,IAAI,GAAAF,UAAA;MAAEG,OAAO,GAAAH,UAAA;IACpB,IAAAI,UAAA,GAAkCjB,QAAQ,CAAC,IAAI,CAAC;MAAAkB,UAAA,GAAAJ,cAAA,CAAAG,UAAA;MAAzCE,SAAS,GAAAD,UAAA;MAAEE,YAAY,GAAAF,UAAA;IAE9BjB,SAAS,CAAC,YAAM;MACd,IAAIoB,SAAS,GAAG,IAAI;MACpB,IAAIC,KAAgD;MAEpD,IAAMC,QAAQ;QAAA,IAAAC,IAAA,GAAAC,iBAAA,CAAG,aAAY;UAC3B,IAAI;YACF,IAAMC,MAAM,SAAStB,YAAY,CAACuB,OAAO,CAACjB,gBAAgB,CAAC;YAC3D,IAAI,CAACW,SAAS,EAAE;cACd;YACF;YACA,IAAIK,MAAM,EAAE;cACV,IAAME,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACJ,MAAM,CAAC;cAEnC,IAAMK,YAAkB,GAAAC,MAAA,CAAAC,MAAA,KACnBL,QAAQ;gBACXM,IAAI,EAAEN,QAAQ,CAACM,IAAI,IAAI,QAAQ;gBAC/BC,QAAQ,EAAEP,QAAQ,CAACO,QAAQ,IAAI;cAAE,EAClC;cACDnB,OAAO,CAACe,YAAY,CAAC;cACrB,IAAIA,YAAY,CAACK,QAAQ,EAAE;gBACzB9B,IAAI,CAAC+B,cAAc,CAACN,YAAY,CAACK,QAAQ,CAAC;cAC5C;YACF,CAAC,MAAM;cAEL,IAAAE,aAAA,SAAuC,MAAM,CAAC,kBAAkB,CAAC;gBAAzDC,oBAAoB,GAAAD,aAAA,CAApBC,oBAAoB;cAC5B,IAAMC,YAAY,SAASD,oBAAoB,CAAC,CAAC;cACjD,IAAIC,YAAY,IAAIA,YAAY,KAAKlC,IAAI,CAAC8B,QAAQ,EAAE;gBAClD9B,IAAI,CAAC+B,cAAc,CAACG,YAAY,CAAC;gBACjCjC,MAAM,CAACkC,IAAI,CAAC,wBAAwB,EAAE;kBAAEC,OAAO,EAAE,aAAa;kBAAEN,QAAQ,EAAEI;gBAAa,CAAC,CAAC;cAC3F;YACF;UACF,CAAC,CAAC,OAAOG,KAAK,EAAE;YACdnC,mBAAmB,CAACmC,KAAK,EAAE,aAAa,EAAE;cAAEC,MAAM,EAAE;YAAW,CAAC,CAAC;UACnE,CAAC,SAAS;YACR,IAAIvB,SAAS,EAAE;cACbD,YAAY,CAAC,KAAK,CAAC;YACrB;UACF;QACF,CAAC;QAAA,gBAlCKG,QAAQA,CAAA;UAAA,OAAAC,IAAA,CAAAqB,KAAA,OAAAC,SAAA;QAAA;MAAA,GAkCb;MAED,IAAIzC,QAAQ,CAAC0C,EAAE,KAAK,KAAK,EAAE;QACzBxB,QAAQ,CAAC,CAAC;MACZ,CAAC,MAAM;QACLD,KAAK,GAAG0B,UAAU,CAACzB,QAAQ,EAAE,CAAC,CAAC;MACjC;MAEA,OAAO,YAAM;QACXF,SAAS,GAAG,KAAK;QACjB,IAAIC,KAAK,EAAE;UACT2B,YAAY,CAAC3B,KAAK,CAAC;QACrB;MACF,CAAC;IACH,CAAC,EAAE,EAAE,CAAC;IAEN,IAAM4B,YAAY,GAAGhD,WAAW;MAAA,IAAAiD,KAAA,GAAA1B,iBAAA,CAAC,WAAOG,QAAqF,EAAK;QAChI,IAAI;UACF,IAAMwB,OAAa,GAAApB,MAAA,CAAAC,MAAA;YACjBoB,EAAE,EAAE,QAAQC,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;YACnEC,SAAS,EAAEN,IAAI,CAACC,GAAG,CAAC,CAAC;YACrBpB,QAAQ,EAAEP,QAAQ,CAACO,QAAQ,IAAI;UAAE,GAC9BP,QAAQ,CACZ;UAED,MAAMxB,YAAY,CAACyD,OAAO,CAACnD,gBAAgB,EAAEmB,IAAI,CAACiC,SAAS,CAACV,OAAO,CAAC,CAAC;UACrEpC,OAAO,CAACoC,OAAO,CAAC;UAEhB7C,MAAM,CAACkC,IAAI,CAAC,iBAAiB,EAAE;YAAEC,OAAO,EAAE,aAAa;YAAEqB,MAAM,EAAEX,OAAO,CAACC,EAAE;YAAEW,QAAQ,EAAEZ,OAAO,CAACa,IAAI;YAAEC,aAAa,EAAEd,OAAO,CAACjB,QAAQ,CAACgC;UAAO,CAAC,CAAC;UAE9I,OAAOf,OAAO;QAChB,CAAC,CAAC,OAAOT,KAAK,EAAE;UACdpC,MAAM,CAACoC,KAAK,CAAC,wBAAwB,EAAEA,KAAK,YAAYyB,KAAK,GAAGzB,KAAK,GAAG,IAAIyB,KAAK,CAACC,MAAM,CAAC1B,KAAK,CAAC,CAAC,EAAE;YAAED,OAAO,EAAE,aAAa;YAAEE,MAAM,EAAE;UAAe,CAAC,CAAC;UACrJ,MAAMD,KAAK;QACb;MACF,CAAC;MAAA,iBAAA2B,EAAA;QAAA,OAAAnB,KAAA,CAAAN,KAAA,OAAAC,SAAA;MAAA;IAAA,KAAE,EAAE,CAAC;IAEN,IAAMyB,UAAU,GAAGrE,WAAW;MAAA,IAAAsE,KAAA,GAAA/C,iBAAA,CAAC,WAAOgD,OAAgD,EAAK;QACzF,IAAI,CAAC1D,IAAI,EAAE;UACT,MAAM,IAAIqD,KAAK,CAAC,mBAAmB,CAAC;QACtC;QAEA,IAAI;UACF,IAAMM,WAAW,GAAA1C,MAAA,CAAAC,MAAA,KAAQlB,IAAI,EAAK0D,OAAO,CAAE;UAC3C,MAAMrE,YAAY,CAACyD,OAAO,CAACnD,gBAAgB,EAAEmB,IAAI,CAACiC,SAAS,CAACY,WAAW,CAAC,CAAC;UACzE1D,OAAO,CAAC0D,WAAW,CAAC;UAEpB,IAAID,OAAO,CAACrC,QAAQ,EAAE;YACpB9B,IAAI,CAAC+B,cAAc,CAACoC,OAAO,CAACrC,QAAQ,CAAC;UACvC;UAEA7B,MAAM,CAACkC,IAAI,CAAC,cAAc,EAAE;YAAEC,OAAO,EAAE,aAAa;YAAEqB,MAAM,EAAEW,WAAW,CAACrB,EAAE;YAAET,MAAM,EAAE;UAAa,CAAC,CAAC;UACrG,OAAO8B,WAAW;QACpB,CAAC,CAAC,OAAO/B,KAAK,EAAE;UACdnC,mBAAmB,CAACmC,KAAK,EAAE,aAAa,EAAE;YAAEC,MAAM,EAAE;UAAa,CAAC,CAAC;UACnE,MAAMnC,qBAAqB,CAACkC,KAAK,EAAE,aAAa,EAAE;YAAEC,MAAM,EAAE;UAAa,CAAC,CAAC;UAC3E,MAAMD,KAAK;QACb;MACF,CAAC;MAAA,iBAAAgC,GAAA;QAAA,OAAAH,KAAA,CAAA3B,KAAA,OAAAC,SAAA;MAAA;IAAA,KAAE,CAAC/B,IAAI,CAAC,CAAC;IAEV,IAAM6D,QAAQ,GAAG1E,WAAW;MAAA,IAAA2E,KAAA,GAAApD,iBAAA,CAAC,WAAOqD,SAA4D,EAAK;QACnG,IAAI,CAAC/D,IAAI,EAAE;UACT,MAAM,IAAIqD,KAAK,CAAC,yBAAyB,CAAC;QAC5C;QAGA,IAAIrD,IAAI,CAACmB,IAAI,KAAK,OAAO,EAAE;UACzB,MAAM,IAAIkC,KAAK,CAAC,8BAA8B,CAAC;QACjD;QAEA,IAAI;UACF,IAAMW,QAAsB,GAAA/C,MAAA,CAAAC,MAAA;YAC1BoB,EAAE,EAAE,SAASC,IAAI,CAACC,GAAG,CAAC,CAAC,IAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC,CAACC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,EAAE;YACpEqB,OAAO,EAAE1B,IAAI,CAACC,GAAG,CAAC,CAAC;YACnB0B,QAAQ,EAAElE,IAAI,CAACsC,EAAE;YACjB6B,WAAW,EAAAlD,MAAA,CAAAC,MAAA;cACTkD,wBAAwB,EAAE,IAAI;cAC9BC,2BAA2B,EAAE,IAAI;cACjCC,cAAc,EAAE;YAAK,GAClBP,SAAS,CAACI,WAAW;UACzB,GACEJ,SAAS,CACb;UAED,IAAMJ,WAAW,GAAA1C,MAAA,CAAAC,MAAA,KACZlB,IAAI;YACPoB,QAAQ,KAAAmD,MAAA,CAAAC,kBAAA,CAAMxE,IAAI,CAACoB,QAAQ,IAAE4C,QAAQ;UAAC,EACvC;UAED,MAAM3E,YAAY,CAACyD,OAAO,CAACnD,gBAAgB,EAAEmB,IAAI,CAACiC,SAAS,CAACY,WAAW,CAAC,CAAC;UACzE1D,OAAO,CAAC0D,WAAW,CAAC;UAEpBc,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEV,QAAQ,CAAC1B,EAAE,CAAC;UACxC,OAAO0B,QAAQ;QACjB,CAAC,CAAC,OAAOpC,KAAK,EAAE;UACd6C,OAAO,CAAC7C,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;UAC3C,MAAMA,KAAK;QACb;MACF,CAAC;MAAA,iBAAA+C,GAAA;QAAA,OAAAb,KAAA,CAAAhC,KAAA,OAAAC,SAAA;MAAA;IAAA,KAAE,CAAC/B,IAAI,CAAC,CAAC;IAEV,IAAM4E,WAAW,GAAGzF,WAAW;MAAA,IAAA0F,KAAA,GAAAnE,iBAAA,CAAC,WAAOoE,OAAe,EAAK;QACzD,IAAI,CAAC9E,IAAI,EAAE;UACT,MAAM,IAAIqD,KAAK,CAAC,8BAA8B,CAAC;QACjD;QAEA,IAAI;UACF,IAAM0B,eAAe,GAAG/E,IAAI,CAACoB,QAAQ,CAAC4D,MAAM,CAAC,UAAAC,KAAK;YAAA,OAAIA,KAAK,CAAC3C,EAAE,KAAKwC,OAAO;UAAA,EAAC;UAC3E,IAAMnB,WAAW,GAAA1C,MAAA,CAAAC,MAAA,KACZlB,IAAI;YACPoB,QAAQ,EAAE2D,eAAe;YACzBG,aAAa,EAAElF,IAAI,CAACkF,aAAa,KAAKJ,OAAO,GAAGK,SAAS,GAAGnF,IAAI,CAACkF;UAAa,EAC/E;UAED,MAAM7F,YAAY,CAACyD,OAAO,CAACnD,gBAAgB,EAAEmB,IAAI,CAACiC,SAAS,CAACY,WAAW,CAAC,CAAC;UACzE1D,OAAO,CAAC0D,WAAW,CAAC;UAEpBnE,MAAM,CAACkC,IAAI,CAAC,eAAe,EAAE;YAAEC,OAAO,EAAE,aAAa;YAAEmD,OAAO,EAAPA,OAAO;YAAEjD,MAAM,EAAE;UAAc,CAAC,CAAC;QAC1F,CAAC,CAAC,OAAOD,KAAK,EAAE;UACdpC,MAAM,CAACoC,KAAK,CAAC,sBAAsB,EAAEA,KAAK,YAAYyB,KAAK,GAAGzB,KAAK,GAAG,IAAIyB,KAAK,CAACC,MAAM,CAAC1B,KAAK,CAAC,CAAC,EAAE;YAAED,OAAO,EAAE,aAAa;YAAEE,MAAM,EAAE;UAAc,CAAC,CAAC;UAClJ,MAAMD,KAAK;QACb;MACF,CAAC;MAAA,iBAAAwD,GAAA;QAAA,OAAAP,KAAA,CAAA/C,KAAA,OAAAC,SAAA;MAAA;IAAA,KAAE,CAAC/B,IAAI,CAAC,CAAC;IAEV,IAAMqF,cAAc,GAAGlG,WAAW;MAAA,IAAAmG,KAAA,GAAA5E,iBAAA,CAAC,WAAOoE,OAA2B,EAAK;QACxE,IAAI,CAAC9E,IAAI,EAAE;UACT,MAAM,IAAIqD,KAAK,CAAC,mBAAmB,CAAC;QACtC;QAEA,IAAI;UACF,IAAMM,WAAW,GAAA1C,MAAA,CAAAC,MAAA,KAAQlB,IAAI;YAAEkF,aAAa,EAAEJ;UAAO,EAAE;UACvD,MAAMzF,YAAY,CAACyD,OAAO,CAACnD,gBAAgB,EAAEmB,IAAI,CAACiC,SAAS,CAACY,WAAW,CAAC,CAAC;UACzE1D,OAAO,CAAC0D,WAAW,CAAC;UAEpBnE,MAAM,CAACkC,IAAI,CAAC,kBAAkB,EAAE;YAAEC,OAAO,EAAE,aAAa;YAAEmD,OAAO,EAAPA,OAAO;YAAEjD,MAAM,EAAE;UAAiB,CAAC,CAAC;QAChG,CAAC,CAAC,OAAOD,KAAK,EAAE;UACdnC,mBAAmB,CAACmC,KAAK,EAAE,aAAa,EAAE;YAAEC,MAAM,EAAE;UAAiB,CAAC,CAAC;UACvE,MAAMnC,qBAAqB,CAACkC,KAAK,EAAE,aAAa,EAAE;YAAEC,MAAM,EAAE;UAAiB,CAAC,CAAC;UAC/E,MAAMD,KAAK;QACb;MACF,CAAC;MAAA,iBAAA2D,GAAA;QAAA,OAAAD,KAAA,CAAAxD,KAAA,OAAAC,SAAA;MAAA;IAAA,KAAE,CAAC/B,IAAI,CAAC,CAAC;IAEV,IAAMwF,UAAU,GAAGrG,WAAW,CAAAuB,iBAAA,CAAC,aAAY;MACzC,IAAI;QACF,MAAMrB,YAAY,CAACoG,UAAU,CAAC9F,gBAAgB,CAAC;QAC/CM,OAAO,CAAC,IAAI,CAAC;QACbT,MAAM,CAACkC,IAAI,CAAC,iBAAiB,EAAE;UAAEC,OAAO,EAAE,aAAa;UAAEE,MAAM,EAAE;QAAa,CAAC,CAAC;MAClF,CAAC,CAAC,OAAOD,KAAK,EAAE;QACdnC,mBAAmB,CAACmC,KAAK,EAAE,aAAa,EAAE;UAAEC,MAAM,EAAE;QAAa,CAAC,CAAC;QACnE,MAAMnC,qBAAqB,CAACkC,KAAK,EAAE,aAAa,EAAE;UAAEC,MAAM,EAAE;QAAa,CAAC,CAAC;QAC3E,MAAMD,KAAK;MACb;IACF,CAAC,GAAE,EAAE,CAAC;IAEN,IAAM8D,WAAW,GAAGtG,OAAO,CAAC,YAAM;MAChC,IAAI,CAACY,IAAI,IAAI,CAACA,IAAI,CAACkF,aAAa,EAAE,OAAO,IAAI;MAC7C,OAAOlF,IAAI,CAACoB,QAAQ,CAACuE,IAAI,CAAC,UAAAV,KAAK;QAAA,OAAIA,KAAK,CAAC3C,EAAE,KAAKtC,IAAI,CAACkF,aAAa;MAAA,EAAC,IAAI,IAAI;IAC7E,CAAC,EAAE,CAAClF,IAAI,CAAC,CAAC;IAEV,OAAOZ,OAAO,CAAC;MAAA,OAAO;QACpBY,IAAI,EAAJA,IAAI;QACJI,SAAS,EAATA,SAAS;QACTwF,eAAe,EAAE,CAAC,CAAC5F,IAAI;QACvB0F,WAAW,EAAXA,WAAW;QACXtE,QAAQ,EAAE,CAAApB,IAAI,oBAAJA,IAAI,CAAEoB,QAAQ,KAAI,EAAE;QAC9Be,YAAY,EAAZA,YAAY;QACZqB,UAAU,EAAVA,UAAU;QACVK,QAAQ,EAARA,QAAQ;QACRe,WAAW,EAAXA,WAAW;QACXS,cAAc,EAAdA,cAAc;QACdG,UAAU,EAAVA;MACF,CAAC;IAAA,CAAC,EAAE,CAACxF,IAAI,EAAEI,SAAS,EAAEsF,WAAW,EAAEvD,YAAY,EAAEqB,UAAU,EAAEK,QAAQ,EAAEe,WAAW,EAAES,cAAc,EAAEG,UAAU,CAAC,CAAC;EAClH,CAAC,CAAC;EAAAK,mBAAA,GAAA9F,cAAA,CAAAH,kBAAA;EArNYkG,YAAY,GAAAD,mBAAA;EAAEE,OAAO,GAAAF,mBAAA;AAqNhC,SAAAC,YAAA,EAAAC,OAAA","ignoreList":[]}