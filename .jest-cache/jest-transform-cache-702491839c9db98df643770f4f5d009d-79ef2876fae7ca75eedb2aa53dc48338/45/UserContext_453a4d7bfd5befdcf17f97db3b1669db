f5f82a695312211e4336533f8a8d6e3e
import _toConsumableArray from "@babel/runtime/helpers/toConsumableArray";
import _asyncToGenerator from "@babel/runtime/helpers/asyncToGenerator";
import _slicedToArray from "@babel/runtime/helpers/slicedToArray";
import createContextHook from '@nkzw/create-context-hook';
import { useState, useEffect, useCallback, useMemo } from 'react';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { Platform } from 'react-native';
import i18n from './i18n';
import { logger } from '@/utils/logger';
import { handleErrorSilently, showUserFriendlyError } from '@/utils/errorHandler';
var USER_STORAGE_KEY = '@user_data';
var _createContextHook = createContextHook(function () {
    var _useState = useState(null),
      _useState2 = _slicedToArray(_useState, 2),
      user = _useState2[0],
      setUser = _useState2[1];
    var _useState3 = useState(true),
      _useState4 = _slicedToArray(_useState3, 2),
      isLoading = _useState4[0],
      setIsLoading = _useState4[1];
    useEffect(function () {
      var isMounted = true;
      var timer;
      var loadUser = function () {
        var _ref = _asyncToGenerator(function* () {
          try {
            var stored = yield AsyncStorage.getItem(USER_STORAGE_KEY);
            if (!isMounted) {
              return;
            }
            if (stored) {
              var userData = JSON.parse(stored);
              var migratedUser = Object.assign({}, userData, {
                role: userData.role || 'parent',
                children: userData.children || []
              });
              setUser(migratedUser);
              if (migratedUser.language) {
                i18n.changeLanguage(migratedUser.language);
              }
            } else {
              var _yield$import = yield import('@/constants/i18n'),
                detectDeviceLanguage = _yield$import.detectDeviceLanguage;
              var detectedLang = yield detectDeviceLanguage();
              if (detectedLang && detectedLang !== i18n.language) {
                i18n.changeLanguage(detectedLang);
                logger.info('Auto-detected language', {
                  context: 'UserContext',
                  language: detectedLang
                });
              }
            }
          } catch (error) {
            handleErrorSilently(error, 'UserContext', {
              action: 'loadUser'
            });
          } finally {
            if (isMounted) {
              setIsLoading(false);
            }
          }
        });
        return function loadUser() {
          return _ref.apply(this, arguments);
        };
      }();
      if (Platform.OS !== 'web') {
        loadUser();
      } else {
        timer = setTimeout(loadUser, 0);
      }
      return function () {
        isMounted = false;
        if (timer) {
          clearTimeout(timer);
        }
      };
    }, []);
    var identifyUser = useCallback(function () {
      var _ref2 = _asyncToGenerator(function* (userData) {
        try {
          var newUser = Object.assign({
            id: `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
            createdAt: Date.now(),
            children: userData.children || []
          }, userData);
          yield AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(newUser));
          setUser(newUser);
          logger.info('User identified', {
            context: 'UserContext',
            userId: newUser.id,
            userName: newUser.name,
            childrenCount: newUser.children.length
          });
          return newUser;
        } catch (error) {
          logger.error('Error identifying user', error instanceof Error ? error : new Error(String(error)), {
            context: 'UserContext',
            action: 'identifyUser'
          });
          throw error;
        }
      });
      return function (_x) {
        return _ref2.apply(this, arguments);
      };
    }(), []);
    var updateUser = useCallback(function () {
      var _ref3 = _asyncToGenerator(function* (updates) {
        if (!user) {
          throw new Error('No user to update');
        }
        try {
          var updatedUser = Object.assign({}, user, updates);
          yield AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));
          setUser(updatedUser);
          if (updates.language) {
            i18n.changeLanguage(updates.language);
          }
          logger.info('User updated', {
            context: 'UserContext',
            userId: updatedUser.id,
            action: 'updateUser'
          });
          return updatedUser;
        } catch (error) {
          handleErrorSilently(error, 'UserContext', {
            action: 'updateUser'
          });
          yield showUserFriendlyError(error, 'UserContext', {
            action: 'updateUser'
          });
          throw error;
        }
      });
      return function (_x2) {
        return _ref3.apply(this, arguments);
      };
    }(), [user]);
    var addChild = useCallback(function () {
      var _ref4 = _asyncToGenerator(function* (childData) {
        if (!user) {
          throw new Error('No user to add child to');
        }
        if (user.role === 'child') {
          throw new Error('Only parent can add children');
        }
        try {
          var newChild = Object.assign({
            id: `child_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
            addedAt: Date.now(),
            parentId: user.id,
            permissions: Object.assign({
              canChangeChatBackgrounds: true,
              canChangeNotificationSounds: true,
              canAddContacts: false
            }, childData.permissions)
          }, childData);
          var updatedUser = Object.assign({}, user, {
            children: [].concat(_toConsumableArray(user.children), [newChild])
          });
          yield AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));
          setUser(updatedUser);
          console.log('Child added:', newChild.id);
          return newChild;
        } catch (error) {
          console.error('Error adding child:', error);
          throw error;
        }
      });
      return function (_x3) {
        return _ref4.apply(this, arguments);
      };
    }(), [user]);
    var removeChild = useCallback(function () {
      var _ref5 = _asyncToGenerator(function* (childId) {
        if (!user) {
          throw new Error('No user to remove child from');
        }
        try {
          var updatedChildren = user.children.filter(function (child) {
            return child.id !== childId;
          });
          var updatedUser = Object.assign({}, user, {
            children: updatedChildren,
            activeChildId: user.activeChildId === childId ? undefined : user.activeChildId
          });
          yield AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));
          setUser(updatedUser);
          logger.info('Child removed', {
            context: 'UserContext',
            childId: childId,
            action: 'removeChild'
          });
        } catch (error) {
          logger.error('Error removing child', error instanceof Error ? error : new Error(String(error)), {
            context: 'UserContext',
            action: 'removeChild'
          });
          throw error;
        }
      });
      return function (_x4) {
        return _ref5.apply(this, arguments);
      };
    }(), [user]);
    var setActiveChild = useCallback(function () {
      var _ref6 = _asyncToGenerator(function* (childId) {
        if (!user) {
          throw new Error('No user to update');
        }
        try {
          var updatedUser = Object.assign({}, user, {
            activeChildId: childId
          });
          yield AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));
          setUser(updatedUser);
          logger.info('Active child set', {
            context: 'UserContext',
            childId: childId,
            action: 'setActiveChild'
          });
        } catch (error) {
          handleErrorSilently(error, 'UserContext', {
            action: 'setActiveChild'
          });
          yield showUserFriendlyError(error, 'UserContext', {
            action: 'setActiveChild'
          });
          throw error;
        }
      });
      return function (_x5) {
        return _ref6.apply(this, arguments);
      };
    }(), [user]);
    var logoutUser = useCallback(_asyncToGenerator(function* () {
      try {
        yield AsyncStorage.removeItem(USER_STORAGE_KEY);
        setUser(null);
        logger.info('User logged out', {
          context: 'UserContext',
          action: 'logoutUser'
        });
      } catch (error) {
        handleErrorSilently(error, 'UserContext', {
          action: 'logoutUser'
        });
        yield showUserFriendlyError(error, 'UserContext', {
          action: 'logoutUser'
        });
        throw error;
      }
    }), []);
    var activeChild = useMemo(function () {
      if (!user || !user.activeChildId) return null;
      return user.children.find(function (child) {
        return child.id === user.activeChildId;
      }) || null;
    }, [user]);
    return useMemo(function () {
      return {
        user: user,
        isLoading: isLoading,
        isAuthenticated: !!user,
        activeChild: activeChild,
        children: (user == null ? void 0 : user.children) || [],
        identifyUser: identifyUser,
        updateUser: updateUser,
        addChild: addChild,
        removeChild: removeChild,
        setActiveChild: setActiveChild,
        logoutUser: logoutUser
      };
    }, [user, isLoading, activeChild, identifyUser, updateUser, addChild, removeChild, setActiveChild, logoutUser]);
  }),
  _createContextHook2 = _slicedToArray(_createContextHook, 2),
  UserProvider = _createContextHook2[0],
  useUser = _createContextHook2[1];
export { UserProvider, useUser };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjcmVhdGVDb250ZXh0SG9vayIsInVzZVN0YXRlIiwidXNlRWZmZWN0IiwidXNlQ2FsbGJhY2siLCJ1c2VNZW1vIiwiQXN5bmNTdG9yYWdlIiwiUGxhdGZvcm0iLCJpMThuIiwibG9nZ2VyIiwiaGFuZGxlRXJyb3JTaWxlbnRseSIsInNob3dVc2VyRnJpZW5kbHlFcnJvciIsIlVTRVJfU1RPUkFHRV9LRVkiLCJfY3JlYXRlQ29udGV4dEhvb2siLCJfdXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkiLCJ1c2VyIiwic2V0VXNlciIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0IiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwiaXNNb3VudGVkIiwidGltZXIiLCJsb2FkVXNlciIsIl9yZWYiLCJfYXN5bmNUb0dlbmVyYXRvciIsInN0b3JlZCIsImdldEl0ZW0iLCJ1c2VyRGF0YSIsIkpTT04iLCJwYXJzZSIsIm1pZ3JhdGVkVXNlciIsIk9iamVjdCIsImFzc2lnbiIsInJvbGUiLCJjaGlsZHJlbiIsImxhbmd1YWdlIiwiY2hhbmdlTGFuZ3VhZ2UiLCJfeWllbGQkaW1wb3J0IiwiZGV0ZWN0RGV2aWNlTGFuZ3VhZ2UiLCJkZXRlY3RlZExhbmciLCJpbmZvIiwiY29udGV4dCIsImVycm9yIiwiYWN0aW9uIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJPUyIsInNldFRpbWVvdXQiLCJjbGVhclRpbWVvdXQiLCJpZGVudGlmeVVzZXIiLCJfcmVmMiIsIm5ld1VzZXIiLCJpZCIsIkRhdGUiLCJub3ciLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHIiLCJjcmVhdGVkQXQiLCJzZXRJdGVtIiwic3RyaW5naWZ5IiwidXNlcklkIiwidXNlck5hbWUiLCJuYW1lIiwiY2hpbGRyZW5Db3VudCIsImxlbmd0aCIsIkVycm9yIiwiU3RyaW5nIiwiX3giLCJ1cGRhdGVVc2VyIiwiX3JlZjMiLCJ1cGRhdGVzIiwidXBkYXRlZFVzZXIiLCJfeDIiLCJhZGRDaGlsZCIsIl9yZWY0IiwiY2hpbGREYXRhIiwibmV3Q2hpbGQiLCJhZGRlZEF0IiwicGFyZW50SWQiLCJwZXJtaXNzaW9ucyIsImNhbkNoYW5nZUNoYXRCYWNrZ3JvdW5kcyIsImNhbkNoYW5nZU5vdGlmaWNhdGlvblNvdW5kcyIsImNhbkFkZENvbnRhY3RzIiwiY29uY2F0IiwiX3RvQ29uc3VtYWJsZUFycmF5IiwiY29uc29sZSIsImxvZyIsIl94MyIsInJlbW92ZUNoaWxkIiwiX3JlZjUiLCJjaGlsZElkIiwidXBkYXRlZENoaWxkcmVuIiwiZmlsdGVyIiwiY2hpbGQiLCJhY3RpdmVDaGlsZElkIiwidW5kZWZpbmVkIiwiX3g0Iiwic2V0QWN0aXZlQ2hpbGQiLCJfcmVmNiIsIl94NSIsImxvZ291dFVzZXIiLCJyZW1vdmVJdGVtIiwiYWN0aXZlQ2hpbGQiLCJmaW5kIiwiaXNBdXRoZW50aWNhdGVkIiwiX2NyZWF0ZUNvbnRleHRIb29rMiIsIlVzZXJQcm92aWRlciIsInVzZVVzZXIiXSwic291cmNlcyI6WyJVc2VyQ29udGV4dC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyZWF0ZUNvbnRleHRIb29rIGZyb20gJ0Bua3p3L2NyZWF0ZS1jb250ZXh0LWhvb2snO1xuaW1wb3J0IHsgdXNlU3RhdGUsIHVzZUVmZmVjdCwgdXNlQ2FsbGJhY2ssIHVzZU1lbW8gfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgQXN5bmNTdG9yYWdlIGZyb20gJ0ByZWFjdC1uYXRpdmUtYXN5bmMtc3RvcmFnZS9hc3luYy1zdG9yYWdlJztcbmltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAncmVhY3QtbmF0aXZlJztcbmltcG9ydCBpMThuIGZyb20gJy4vaTE4bic7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICdAL3V0aWxzL2xvZ2dlcic7XG5cbmltcG9ydCB7IFVzZXJSb2xlLCBQYXJlbnRHZW5kZXIgfSBmcm9tICcuL3R5cGVzJztcbmltcG9ydCB7IGhhbmRsZUVycm9yU2lsZW50bHksIHNob3dVc2VyRnJpZW5kbHlFcnJvciB9IGZyb20gJ0AvdXRpbHMvZXJyb3JIYW5kbGVyJztcblxuZXhwb3J0IGludGVyZmFjZSBDaGlsZFByb2ZpbGUge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGFnZT86IG51bWJlcjtcbiAgYXZhdGFyPzogc3RyaW5nO1xuICBkZXZpY2VJZD86IHN0cmluZztcbiAgYWRkZWRBdDogbnVtYmVyO1xuICBwYXJlbnRJZD86IHN0cmluZzsgLy8gSUQg0YDQvtC00LjRgtC10LvRjy3QstC70LDQtNC10LvRjNGG0LBcbiAgcGluPzogc3RyaW5nOyAvLyBQSU4g0LTQu9GPINCy0YXQvtC00LAg0YDQtdCx0LXQvdC60LAgKNC+0L/RhtC40L7QvdCw0LvRjNC90L4pXG4gIHBlcm1pc3Npb25zPzoge1xuICAgIGNhbkNoYW5nZUNoYXRCYWNrZ3JvdW5kcz86IGJvb2xlYW47XG4gICAgY2FuQ2hhbmdlTm90aWZpY2F0aW9uU291bmRzPzogYm9vbGVhbjtcbiAgICBjYW5BZGRDb250YWN0cz86IGJvb2xlYW47XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVXNlciB7XG4gIGlkOiBzdHJpbmc7XG4gIG5hbWU6IHN0cmluZztcbiAgZW1haWw/OiBzdHJpbmc7XG4gIGF2YXRhcj86IHN0cmluZztcbiAgY3JlYXRlZEF0OiBudW1iZXI7XG4gIGRldmljZUlkPzogc3RyaW5nO1xuICBsYW5ndWFnZT86IHN0cmluZztcbiAgcm9sZT86IFVzZXJSb2xlOyAvLyAncGFyZW50JyB8ICdjaGlsZCcgKNC+0L/RhtC40L7QvdCw0LvRjNC90L4g0LTQu9GPINC+0LHRgNCw0YLQvdC+0Lkg0YHQvtCy0LzQtdGB0YLQuNC80L7RgdGC0LgpXG4gIHBhcmVudElkPzogc3RyaW5nOyAvLyDQldGB0LvQuCByb2xlPSdjaGlsZCcsINGD0LrQsNC30YvQstCw0LXRgiDQvdCwINGA0L7QtNC40YLQtdC70Y9cbiAgcGFyZW50UGluPzogc3RyaW5nOyAvLyBQSU4g0YDQvtC00LjRgtC10LvRjyDQtNC70Y8g0LDRg9GC0LXQvdGC0LjRhNC40LrQsNGG0LjQuFxuICBwYXJlbnRHZW5kZXI/OiBQYXJlbnRHZW5kZXI7IC8vINCf0L7QuyDRgNC+0LTQuNGC0LXQu9GPICjQtNC70Y8g0LvQvtC60LDQu9C40LfQsNGG0LjQuClcbiAgY291bnRyeT86IHN0cmluZzsgLy8g0KHRgtGA0LDQvdCwICjQtNC70Y8g0LvQvtC60LDQu9C40LfQsNGG0LjQuClcbiAgY2hpbGRyZW46IENoaWxkUHJvZmlsZVtdOyAvLyDQnNCw0YHRgdC40LIg0LTQtdGC0LXQuSDRgNC+0LTQuNGC0LXQu9GPXG4gIGFjdGl2ZUNoaWxkSWQ/OiBzdHJpbmc7IC8vIElEINCw0LrRgtC40LLQvdC+0LPQviAo0LLRi9Cx0YDQsNC90L3QvtCz0L4pINGA0LXQsdC10L3QutCwINC00LvRjyDQv9GA0L7RgdC80L7RgtGA0LBcbn1cblxuY29uc3QgVVNFUl9TVE9SQUdFX0tFWSA9ICdAdXNlcl9kYXRhJztcblxuZXhwb3J0IGNvbnN0IFtVc2VyUHJvdmlkZXIsIHVzZVVzZXJdID0gY3JlYXRlQ29udGV4dEhvb2soKCkgPT4ge1xuICBjb25zdCBbdXNlciwgc2V0VXNlcl0gPSB1c2VTdGF0ZTxVc2VyIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxldCBpc01vdW50ZWQgPSB0cnVlO1xuICAgIGxldCB0aW1lcjogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0VGltZW91dD4gfCB1bmRlZmluZWQ7XG5cbiAgICBjb25zdCBsb2FkVXNlciA9IGFzeW5jICgpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHN0b3JlZCA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKFVTRVJfU1RPUkFHRV9LRVkpO1xuICAgICAgICBpZiAoIWlzTW91bnRlZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3RvcmVkKSB7XG4gICAgICAgICAgY29uc3QgdXNlckRhdGEgPSBKU09OLnBhcnNlKHN0b3JlZCk7XG4gICAgICAgICAgLy8g0JzQuNCz0YDQsNGG0LjRjzog0LXRgdC70Lgg0L3QtdGCIHJvbGUsINGD0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8ICdwYXJlbnQnINC/0L4g0YPQvNC+0LvRh9Cw0L3QuNGOXG4gICAgICAgICAgY29uc3QgbWlncmF0ZWRVc2VyOiBVc2VyID0ge1xuICAgICAgICAgICAgLi4udXNlckRhdGEsXG4gICAgICAgICAgICByb2xlOiB1c2VyRGF0YS5yb2xlIHx8ICdwYXJlbnQnLCAvLyDQn9C+INGD0LzQvtC70YfQsNC90LjRjiDRgNC+0LTQuNGC0LXQu9GMXG4gICAgICAgICAgICBjaGlsZHJlbjogdXNlckRhdGEuY2hpbGRyZW4gfHwgW10sIC8vINCe0LHQtdGB0L/QtdGH0LjQstCw0LXQvCDQvdCw0LvQuNGH0LjQtSBjaGlsZHJlblxuICAgICAgICAgIH07XG4gICAgICAgICAgc2V0VXNlcihtaWdyYXRlZFVzZXIpO1xuICAgICAgICAgIGlmIChtaWdyYXRlZFVzZXIubGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIGkxOG4uY2hhbmdlTGFuZ3VhZ2UobWlncmF0ZWRVc2VyLmxhbmd1YWdlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8g0J/QtdGA0LLRi9C5INC30LDQv9GD0YHQuiAtINC+0L/RgNC10LTQtdC70Y/QtdC8INGP0LfRi9C6INGD0YHRgtGA0L7QudGB0YLQstCwINCw0LLRgtC+0LzQsNGC0LjRh9C10YHQutC4XG4gICAgICAgICAgY29uc3QgeyBkZXRlY3REZXZpY2VMYW5ndWFnZSB9ID0gYXdhaXQgaW1wb3J0KCdAL2NvbnN0YW50cy9pMThuJyk7XG4gICAgICAgICAgY29uc3QgZGV0ZWN0ZWRMYW5nID0gYXdhaXQgZGV0ZWN0RGV2aWNlTGFuZ3VhZ2UoKTtcbiAgICAgICAgICBpZiAoZGV0ZWN0ZWRMYW5nICYmIGRldGVjdGVkTGFuZyAhPT0gaTE4bi5sYW5ndWFnZSkge1xuICAgICAgICAgICAgaTE4bi5jaGFuZ2VMYW5ndWFnZShkZXRlY3RlZExhbmcpO1xuICAgICAgICAgICAgbG9nZ2VyLmluZm8oJ0F1dG8tZGV0ZWN0ZWQgbGFuZ3VhZ2UnLCB7IGNvbnRleHQ6ICdVc2VyQ29udGV4dCcsIGxhbmd1YWdlOiBkZXRlY3RlZExhbmcgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBoYW5kbGVFcnJvclNpbGVudGx5KGVycm9yLCAnVXNlckNvbnRleHQnLCB7IGFjdGlvbjogJ2xvYWRVc2VyJyB9KTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGlmIChpc01vdW50ZWQpIHtcbiAgICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcblxuICAgIGlmIChQbGF0Zm9ybS5PUyAhPT0gJ3dlYicpIHtcbiAgICAgIGxvYWRVc2VyKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dChsb2FkVXNlciwgMCk7XG4gICAgfVxuXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIGlzTW91bnRlZCA9IGZhbHNlO1xuICAgICAgaWYgKHRpbWVyKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICB9XG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IGlkZW50aWZ5VXNlciA9IHVzZUNhbGxiYWNrKGFzeW5jICh1c2VyRGF0YTogT21pdDxVc2VyLCAnaWQnIHwgJ2NyZWF0ZWRBdCcgfCAnY2hpbGRyZW4nPiAmIHsgY2hpbGRyZW4/OiBDaGlsZFByb2ZpbGVbXSB9KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG5ld1VzZXI6IFVzZXIgPSB7XG4gICAgICAgIGlkOiBgdXNlcl8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgICAgIGNyZWF0ZWRBdDogRGF0ZS5ub3coKSxcbiAgICAgICAgY2hpbGRyZW46IHVzZXJEYXRhLmNoaWxkcmVuIHx8IFtdLFxuICAgICAgICAuLi51c2VyRGF0YSxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKFVTRVJfU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KG5ld1VzZXIpKTtcbiAgICAgIHNldFVzZXIobmV3VXNlcik7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdVc2VyIGlkZW50aWZpZWQnLCB7IGNvbnRleHQ6ICdVc2VyQ29udGV4dCcsIHVzZXJJZDogbmV3VXNlci5pZCwgdXNlck5hbWU6IG5ld1VzZXIubmFtZSwgY2hpbGRyZW5Db3VudDogbmV3VXNlci5jaGlsZHJlbi5sZW5ndGggfSk7XG5cbiAgICAgIHJldHVybiBuZXdVc2VyO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGlkZW50aWZ5aW5nIHVzZXInLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogJ1VzZXJDb250ZXh0JywgYWN0aW9uOiAnaWRlbnRpZnlVc2VyJyB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfSwgW10pO1xuXG4gIGNvbnN0IHVwZGF0ZVVzZXIgPSB1c2VDYWxsYmFjayhhc3luYyAodXBkYXRlczogUGFydGlhbDxPbWl0PFVzZXIsICdpZCcgfCAnY3JlYXRlZEF0Jz4+KSA9PiB7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVzZXIgdG8gdXBkYXRlJyk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0geyAuLi51c2VyLCAuLi51cGRhdGVzIH07XG4gICAgICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbShVU0VSX1NUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeSh1cGRhdGVkVXNlcikpO1xuICAgICAgc2V0VXNlcih1cGRhdGVkVXNlcik7XG5cbiAgICAgIGlmICh1cGRhdGVzLmxhbmd1YWdlKSB7XG4gICAgICAgIGkxOG4uY2hhbmdlTGFuZ3VhZ2UodXBkYXRlcy5sYW5ndWFnZSk7XG4gICAgICB9XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdVc2VyIHVwZGF0ZWQnLCB7IGNvbnRleHQ6ICdVc2VyQ29udGV4dCcsIHVzZXJJZDogdXBkYXRlZFVzZXIuaWQsIGFjdGlvbjogJ3VwZGF0ZVVzZXInIH0pO1xuICAgICAgcmV0dXJuIHVwZGF0ZWRVc2VyO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBoYW5kbGVFcnJvclNpbGVudGx5KGVycm9yLCAnVXNlckNvbnRleHQnLCB7IGFjdGlvbjogJ3VwZGF0ZVVzZXInIH0pO1xuICAgICAgYXdhaXQgc2hvd1VzZXJGcmllbmRseUVycm9yKGVycm9yLCAnVXNlckNvbnRleHQnLCB7IGFjdGlvbjogJ3VwZGF0ZVVzZXInIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9LCBbdXNlcl0pO1xuXG4gIGNvbnN0IGFkZENoaWxkID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNoaWxkRGF0YTogT21pdDxDaGlsZFByb2ZpbGUsICdpZCcgfCAnYWRkZWRBdCcgfCAncGFyZW50SWQnPikgPT4ge1xuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB1c2VyIHRvIGFkZCBjaGlsZCB0bycpO1xuICAgIH1cblxuICAgIC8vINCf0YDQvtCy0LXRgNC60LA6INGC0L7Qu9GM0LrQviDRgNC+0LTQuNGC0LXQu9GMINC80L7QttC10YIg0LTQvtCx0LDQstC70Y/RgtGMINC00LXRgtC10LlcbiAgICBpZiAodXNlci5yb2xlID09PSAnY2hpbGQnKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ09ubHkgcGFyZW50IGNhbiBhZGQgY2hpbGRyZW4nKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgbmV3Q2hpbGQ6IENoaWxkUHJvZmlsZSA9IHtcbiAgICAgICAgaWQ6IGBjaGlsZF8ke0RhdGUubm93KCl9XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyKDIsIDkpfWAsXG4gICAgICAgIGFkZGVkQXQ6IERhdGUubm93KCksXG4gICAgICAgIHBhcmVudElkOiB1c2VyLmlkLFxuICAgICAgICBwZXJtaXNzaW9uczoge1xuICAgICAgICAgIGNhbkNoYW5nZUNoYXRCYWNrZ3JvdW5kczogdHJ1ZSxcbiAgICAgICAgICBjYW5DaGFuZ2VOb3RpZmljYXRpb25Tb3VuZHM6IHRydWUsXG4gICAgICAgICAgY2FuQWRkQ29udGFjdHM6IGZhbHNlLCAvLyDQn9C+INGD0LzQvtC70YfQsNC90LjRjiDRgtC+0LvRjNC60L4g0YDQvtC00LjRgtC10LvRjFxuICAgICAgICAgIC4uLmNoaWxkRGF0YS5wZXJtaXNzaW9ucyxcbiAgICAgICAgfSxcbiAgICAgICAgLi4uY2hpbGREYXRhLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7XG4gICAgICAgIC4uLnVzZXIsXG4gICAgICAgIGNoaWxkcmVuOiBbLi4udXNlci5jaGlsZHJlbiwgbmV3Q2hpbGRdLFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnNldEl0ZW0oVVNFUl9TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFVzZXIpKTtcbiAgICAgIHNldFVzZXIodXBkYXRlZFVzZXIpO1xuXG4gICAgICBjb25zb2xlLmxvZygnQ2hpbGQgYWRkZWQ6JywgbmV3Q2hpbGQuaWQpO1xuICAgICAgcmV0dXJuIG5ld0NoaWxkO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBhZGRpbmcgY2hpbGQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9LCBbdXNlcl0pO1xuXG4gIGNvbnN0IHJlbW92ZUNoaWxkID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNoaWxkSWQ6IHN0cmluZykgPT4ge1xuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB1c2VyIHRvIHJlbW92ZSBjaGlsZCBmcm9tJyk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVwZGF0ZWRDaGlsZHJlbiA9IHVzZXIuY2hpbGRyZW4uZmlsdGVyKGNoaWxkID0+IGNoaWxkLmlkICE9PSBjaGlsZElkKTtcbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0ge1xuICAgICAgICAuLi51c2VyLFxuICAgICAgICBjaGlsZHJlbjogdXBkYXRlZENoaWxkcmVuLFxuICAgICAgICBhY3RpdmVDaGlsZElkOiB1c2VyLmFjdGl2ZUNoaWxkSWQgPT09IGNoaWxkSWQgPyB1bmRlZmluZWQgOiB1c2VyLmFjdGl2ZUNoaWxkSWQsXG4gICAgICB9O1xuXG4gICAgICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbShVU0VSX1NUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeSh1cGRhdGVkVXNlcikpO1xuICAgICAgc2V0VXNlcih1cGRhdGVkVXNlcik7XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdDaGlsZCByZW1vdmVkJywgeyBjb250ZXh0OiAnVXNlckNvbnRleHQnLCBjaGlsZElkLCBhY3Rpb246ICdyZW1vdmVDaGlsZCcgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3IgcmVtb3ZpbmcgY2hpbGQnLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IgOiBuZXcgRXJyb3IoU3RyaW5nKGVycm9yKSksIHsgY29udGV4dDogJ1VzZXJDb250ZXh0JywgYWN0aW9uOiAncmVtb3ZlQ2hpbGQnIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9LCBbdXNlcl0pO1xuXG4gIGNvbnN0IHNldEFjdGl2ZUNoaWxkID0gdXNlQ2FsbGJhY2soYXN5bmMgKGNoaWxkSWQ6IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB1c2VyIHRvIHVwZGF0ZScpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHsgLi4udXNlciwgYWN0aXZlQ2hpbGRJZDogY2hpbGRJZCB9O1xuICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnNldEl0ZW0oVVNFUl9TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFVzZXIpKTtcbiAgICAgIHNldFVzZXIodXBkYXRlZFVzZXIpO1xuXG4gICAgICBsb2dnZXIuaW5mbygnQWN0aXZlIGNoaWxkIHNldCcsIHsgY29udGV4dDogJ1VzZXJDb250ZXh0JywgY2hpbGRJZCwgYWN0aW9uOiAnc2V0QWN0aXZlQ2hpbGQnIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBoYW5kbGVFcnJvclNpbGVudGx5KGVycm9yLCAnVXNlckNvbnRleHQnLCB7IGFjdGlvbjogJ3NldEFjdGl2ZUNoaWxkJyB9KTtcbiAgICAgIGF3YWl0IHNob3dVc2VyRnJpZW5kbHlFcnJvcihlcnJvciwgJ1VzZXJDb250ZXh0JywgeyBhY3Rpb246ICdzZXRBY3RpdmVDaGlsZCcgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sIFt1c2VyXSk7XG5cbiAgY29uc3QgbG9nb3V0VXNlciA9IHVzZUNhbGxiYWNrKGFzeW5jICgpID0+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnJlbW92ZUl0ZW0oVVNFUl9TVE9SQUdFX0tFWSk7XG4gICAgICBzZXRVc2VyKG51bGwpO1xuICAgICAgbG9nZ2VyLmluZm8oJ1VzZXIgbG9nZ2VkIG91dCcsIHsgY29udGV4dDogJ1VzZXJDb250ZXh0JywgYWN0aW9uOiAnbG9nb3V0VXNlcicgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGhhbmRsZUVycm9yU2lsZW50bHkoZXJyb3IsICdVc2VyQ29udGV4dCcsIHsgYWN0aW9uOiAnbG9nb3V0VXNlcicgfSk7XG4gICAgICBhd2FpdCBzaG93VXNlckZyaWVuZGx5RXJyb3IoZXJyb3IsICdVc2VyQ29udGV4dCcsIHsgYWN0aW9uOiAnbG9nb3V0VXNlcicgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBhY3RpdmVDaGlsZCA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGlmICghdXNlciB8fCAhdXNlci5hY3RpdmVDaGlsZElkKSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4gdXNlci5jaGlsZHJlbi5maW5kKGNoaWxkID0+IGNoaWxkLmlkID09PSB1c2VyLmFjdGl2ZUNoaWxkSWQpIHx8IG51bGw7XG4gIH0sIFt1c2VyXSk7XG5cbiAgcmV0dXJuIHVzZU1lbW8oKCkgPT4gKHtcbiAgICB1c2VyLFxuICAgIGlzTG9hZGluZyxcbiAgICBpc0F1dGhlbnRpY2F0ZWQ6ICEhdXNlcixcbiAgICBhY3RpdmVDaGlsZCxcbiAgICBjaGlsZHJlbjogdXNlcj8uY2hpbGRyZW4gfHwgW10sXG4gICAgaWRlbnRpZnlVc2VyLFxuICAgIHVwZGF0ZVVzZXIsXG4gICAgYWRkQ2hpbGQsXG4gICAgcmVtb3ZlQ2hpbGQsXG4gICAgc2V0QWN0aXZlQ2hpbGQsXG4gICAgbG9nb3V0VXNlcixcbiAgfSksIFt1c2VyLCBpc0xvYWRpbmcsIGFjdGl2ZUNoaWxkLCBpZGVudGlmeVVzZXIsIHVwZGF0ZVVzZXIsIGFkZENoaWxkLCByZW1vdmVDaGlsZCwgc2V0QWN0aXZlQ2hpbGQsIGxvZ291dFVzZXJdKTtcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOzs7QUFBQSxPQUFPQSxpQkFBaUIsTUFBTSwyQkFBMkI7QUFDekQsU0FBU0MsUUFBUSxFQUFFQyxTQUFTLEVBQUVDLFdBQVcsRUFBRUMsT0FBTyxRQUFRLE9BQU87QUFDakUsT0FBT0MsWUFBWSxNQUFNLDJDQUEyQztBQUNwRSxTQUFTQyxRQUFRLFFBQVEsY0FBYztB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