{"version":3,"names":["Hono","trpcServer","cors","appRouter","createContext","app","cov_nwtsoetki","s","use","origin","f","allowedOrigins","process","env","NODE_ENV","b","includes","allowMethods","allowHeaders","maxAge","credentials","router","onError","_ref","error","path","console","get","c","json","status","message","err","stack","req","isDevelopment","errorMessage","startsWith","text","notFound","handler","fetch"],"sources":["index.ts"],"sourcesContent":["import { Hono } from \"hono\";\nimport { trpcServer } from \"@hono/trpc-server\";\nimport { cors } from \"hono/cors\";\nimport { appRouter } from \"./trpc/app-router.js\";\nimport { createContext } from \"./trpc/create-context.js\";\nimport type { Context as HonoContext } from \"hono\";\n\nconst app = new Hono();\n\n// Secure CORS configuration\napp.use(\"*\", cors({\n  origin: (origin) => {\n    // Allow requests from known origins\n    const allowedOrigins = [\n      'https://d8v7u672uumlfpscvnbps.rork.live',\n      'http://localhost:8081',\n      'http://localhost:19006',\n      'exp://localhost:8081',\n    ];\n\n    // In production, only allow specific origins\n    if (process.env.NODE_ENV === 'production') {\n      return allowedOrigins.includes(origin || '') ? origin : null;\n    }\n\n    // In development, allow localhost\n    if (origin && (origin.includes('localhost') || origin.includes('127.0.0.1'))) {\n      return origin;\n    }\n\n    return allowedOrigins.includes(origin || '') ? origin : null;\n  },\n  allowMethods: ['GET', 'POST', 'OPTIONS'],\n  allowHeaders: ['Content-Type', 'Authorization'],\n  maxAge: 86400, // 24 hours\n  credentials: true,\n}));\n\napp.use(\n  \"/api/trpc/*\",\n  trpcServer({\n    router: appRouter,\n    createContext,\n    onError: ({ error, path }) => {\n      console.error(`[tRPC] Error on ${path}:`, error);\n    },\n  })\n);\n\napp.get(\"/\", (c: HonoContext) => {\n  return c.json({ status: \"ok\", message: \"API is running\" });\n});\n\napp.onError((err: Error, c: HonoContext) => {\n  // Log full error for debugging (but don't expose to client)\n  console.error('[Hono] Error:', {\n    message: err.message,\n    stack: err.stack,\n    path: c.req.path,\n  });\n  \n  // Don't expose internal error details to clients\n  const isDevelopment = process.env.NODE_ENV === 'development';\n  const errorMessage = isDevelopment \n    ? err.message \n    : 'An internal error occurred. Please try again later.';\n  \n  if (c.req.path.startsWith('/api/trpc')) {\n    return c.text(`Error: ${errorMessage}`, 500);\n  }\n  \n  return c.json(\n    {\n      error: {\n        message: errorMessage,\n        status: 'error',\n      },\n    },\n    500\n  );\n});\n\napp.notFound((c: HonoContext) => {\n  return c.json(\n    {\n      error: {\n        message: 'Not Found',\n        status: 'error',\n        path: c.req.path,\n      },\n    },\n    404\n  );\n});\n\n// Vercel serverless function handler\nexport default app;\n\n// Export handler for Vercel\nexport const handler = app.fetch;\n"],"mappings":"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","ignoreList":[]}