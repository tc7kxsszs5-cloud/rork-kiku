{"version":3,"names":["AsyncStorage","trpcVanillaClient","logger","getDeviceId","_getDeviceId","apply","arguments","_asyncToGenerator","stored","getItem","deviceId","Date","now","Math","random","toString","substr","setItem","getLastSyncTimestamp","_x","_getLastSyncTimestamp","key","parseInt","setLastSyncTimestamp","_x2","_x3","_setLastSyncTimestamp","timestamp","isTimeoutError","error","Error","name","message","includes","isRetryableError","withRetry","_x4","_withRetry","fn","maxRetries","length","undefined","initialDelay","context","lastError","_loop","v","attempt","delay","pow","warn","Object","assign","component","action","String","Promise","resolve","setTimeout","_ret","ChatSyncService","_classCallCheck","lastSyncKey","initialized","_createClass","value","_initialize","initialize","_syncChats","chats","lastSync","result","sync","mutate","lastSyncTimestamp","chatsCount","success","info","data","errorMessage","isTimeout","syncChats","_x5","_getChats","get","query","getChats","AlertSyncService","_initialize2","_syncAlerts","alerts","alertsCount","syncAlerts","_x6","_getAlerts","getAlerts","SettingsSyncService","_initialize3","_syncSettings","settings","syncSettings","_x7","_getSettings","getSettings","chatSyncService","alertSyncService","settingsSyncService"],"sources":["syncService.ts"],"sourcesContent":["/**\n * Sync Service for chats, alerts, and settings\n * Handles synchronization between local storage and backend\n */\n\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Chat, Alert, ParentalSettings } from '@/constants/types';\nimport { trpcVanillaClient } from '@/lib/trpc';\nimport { logger } from '@/utils/logger';\n\nexport interface SyncResult<T> {\n  success: boolean;\n  data?: T;\n  error?: string;\n}\n\n/**\n * Get or create device ID\n */\nasync function getDeviceId(): Promise<string> {\n  const stored = await AsyncStorage.getItem('@device_id');\n  if (stored) {\n    return stored;\n  }\n  \n  const deviceId = `device_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  await AsyncStorage.setItem('@device_id', deviceId);\n  return deviceId;\n}\n\n/**\n * Get last sync timestamp\n */\nasync function getLastSyncTimestamp(key: string): Promise<number | null> {\n  const stored = await AsyncStorage.getItem(key);\n  return stored ? parseInt(stored, 10) : null;\n}\n\n/**\n * Set last sync timestamp\n */\nasync function setLastSyncTimestamp(key: string, timestamp: number): Promise<void> {\n  await AsyncStorage.setItem(key, timestamp.toString());\n}\n\n/**\n * Check if error is a timeout/network error\n */\nfunction isTimeoutError(error: unknown): boolean {\n  if (error instanceof Error) {\n    return (\n      error.name === 'AbortError' ||\n      error.message.includes('timeout') ||\n      error.message.includes('Timeout') ||\n      error.message.includes('network') ||\n      error.message.includes('Network') ||\n      error.message.includes('fetch failed') ||\n      error.message.includes('Failed to fetch')\n    );\n  }\n  return false;\n}\n\n/**\n * Check if error is retryable (network/timeout errors)\n */\nfunction isRetryableError(error: unknown): boolean {\n  if (error instanceof Error) {\n    // Retry on timeout, network errors, and 5xx server errors\n    return (\n      isTimeoutError(error) ||\n      error.message.includes('ECONNREFUSED') ||\n      error.message.includes('ENOTFOUND') ||\n      error.message.includes('ETIMEDOUT') ||\n      error.message.includes('500') ||\n      error.message.includes('502') ||\n      error.message.includes('503') ||\n      error.message.includes('504')\n    );\n  }\n  return false;\n}\n\n/**\n * Retry function with exponential backoff\n */\nasync function withRetry<T>(\n  fn: () => Promise<T>,\n  maxRetries: number = 3,\n  initialDelay: number = 1000,\n  context?: { component: string; action: string; [key: string]: unknown }\n): Promise<T> {\n  let lastError: Error | unknown;\n  \n  for (let attempt = 0; attempt < maxRetries; attempt++) {\n    try {\n      return await fn();\n    } catch (error) {\n      lastError = error;\n      \n      // Don't retry on last attempt or if error is not retryable\n      if (attempt === maxRetries - 1 || !isRetryableError(error)) {\n        throw error;\n      }\n      \n      // Calculate exponential backoff delay\n      const delay = initialDelay * Math.pow(2, attempt);\n      \n      logger.warn('Sync retry attempt', {\n        component: context?.component || 'SyncService',\n        action: context?.action || 'sync',\n        attempt: attempt + 1,\n        maxRetries,\n        delay,\n        error: error instanceof Error ? error.message : String(error),\n        ...context,\n      });\n      \n      // Wait before retry\n      await new Promise(resolve => setTimeout(resolve, delay));\n    }\n  }\n  \n  throw lastError || new Error('Max retries exceeded');\n}\n\n/**\n * Chat Sync Service\n */\nclass ChatSyncService {\n  private readonly lastSyncKey = '@chats_last_sync';\n  private initialized = false;\n\n  async initialize(): Promise<void> {\n    if (this.initialized) return;\n    this.initialized = true;\n  }\n\n  async syncChats(chats: Chat[]): Promise<SyncResult<Chat[]>> {\n    try {\n      await this.initialize();\n      const deviceId = await getDeviceId();\n      const lastSync = await getLastSyncTimestamp(this.lastSyncKey);\n\n      const result = await withRetry(\n        () => trpcVanillaClient.sync.chats.sync.mutate({\n          deviceId,\n          chats: chats as any,\n          lastSyncTimestamp: lastSync || 0,\n        }),\n        3,\n        1000,\n        { component: 'ChatSyncService', action: 'syncChats', deviceId, chatsCount: chats.length }\n      );\n\n      if (result.success && result.chats) {\n        await setLastSyncTimestamp(this.lastSyncKey, Date.now());\n        logger.info('Chats synced successfully', {\n          component: 'ChatSyncService',\n          action: 'syncChats',\n          deviceId,\n          chatsCount: result.chats.length,\n        });\n        return { success: true, data: result.chats as Chat[] };\n      }\n\n      return { success: false, error: 'Sync failed' };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      const isTimeout = isTimeoutError(error);\n      \n      logger.error('Chat sync failed', error instanceof Error ? error : new Error(errorMessage), {\n        component: 'ChatSyncService',\n        action: 'syncChats',\n        isTimeout,\n        errorMessage,\n      });\n      \n      return {\n        success: false,\n        error: isTimeout \n          ? 'Синхронизация прервана из-за таймаута. Проверьте подключение к интернету.'\n          : errorMessage,\n      };\n    }\n  }\n\n  async getChats(): Promise<SyncResult<Chat[]>> {\n    try {\n      await this.initialize();\n      const deviceId = await getDeviceId();\n      const lastSync = await getLastSyncTimestamp(this.lastSyncKey);\n\n      const result = await withRetry(\n        () => trpcVanillaClient.sync.chats.get.query({\n          deviceId,\n          lastSyncTimestamp: lastSync || 0,\n        }),\n        3,\n        1000,\n        { component: 'ChatSyncService', action: 'getChats', deviceId }\n      );\n\n      if (result && result.chats) {\n        await setLastSyncTimestamp(this.lastSyncKey, Date.now());\n        logger.info('Chats retrieved successfully', {\n          component: 'ChatSyncService',\n          action: 'getChats',\n          deviceId,\n          chatsCount: result.chats.length,\n        });\n        return { success: true, data: result.chats as Chat[] };\n      }\n\n      return { success: false, error: 'Get failed' };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      const isTimeout = isTimeoutError(error);\n      \n      logger.error('Get chats failed', error instanceof Error ? error : new Error(errorMessage), {\n        component: 'ChatSyncService',\n        action: 'getChats',\n        isTimeout,\n        errorMessage,\n      });\n      \n      return {\n        success: false,\n        error: isTimeout \n          ? 'Не удалось загрузить чаты. Проверьте подключение к интернету.'\n          : errorMessage,\n      };\n    }\n  }\n}\n\n/**\n * Alert Sync Service\n */\nclass AlertSyncService {\n  private readonly lastSyncKey = '@alerts_last_sync';\n  private initialized = false;\n\n  async initialize(): Promise<void> {\n    if (this.initialized) return;\n    this.initialized = true;\n  }\n\n  async syncAlerts(alerts: Alert[]): Promise<SyncResult<Alert[]>> {\n    try {\n      await this.initialize();\n      const deviceId = await getDeviceId();\n      const lastSync = await getLastSyncTimestamp(this.lastSyncKey);\n\n      const result = await withRetry(\n        () => trpcVanillaClient.sync.alerts.sync.mutate({\n          deviceId,\n          alerts: alerts as any,\n          lastSyncTimestamp: lastSync || 0,\n        }),\n        3,\n        1000,\n        { component: 'AlertSyncService', action: 'syncAlerts', deviceId, alertsCount: alerts.length }\n      );\n\n      if (result.success && result.alerts) {\n        await setLastSyncTimestamp(this.lastSyncKey, Date.now());\n        logger.info('Alerts synced successfully', {\n          component: 'AlertSyncService',\n          action: 'syncAlerts',\n          deviceId,\n          alertsCount: result.alerts.length,\n        });\n        return { success: true, data: result.alerts as Alert[] };\n      }\n\n      return { success: false, error: 'Sync failed' };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      const isTimeout = isTimeoutError(error);\n      \n      logger.error('Alert sync failed', error instanceof Error ? error : new Error(errorMessage), {\n        component: 'AlertSyncService',\n        action: 'syncAlerts',\n        isTimeout,\n        errorMessage,\n      });\n      \n      return {\n        success: false,\n        error: isTimeout \n          ? 'Синхронизация предупреждений прервана из-за таймаута. Проверьте подключение к интернету.'\n          : errorMessage,\n      };\n    }\n  }\n\n  async getAlerts(): Promise<SyncResult<Alert[]>> {\n    try {\n      await this.initialize();\n      const deviceId = await getDeviceId();\n      const lastSync = await getLastSyncTimestamp(this.lastSyncKey);\n\n      const result = await withRetry(\n        () => trpcVanillaClient.sync.alerts.get.query({\n          deviceId,\n          lastSyncTimestamp: lastSync || 0,\n        }),\n        3,\n        1000,\n        { component: 'AlertSyncService', action: 'getAlerts', deviceId }\n      );\n\n      if (result && result.alerts) {\n        await setLastSyncTimestamp(this.lastSyncKey, Date.now());\n        logger.info('Alerts retrieved successfully', {\n          component: 'AlertSyncService',\n          action: 'getAlerts',\n          deviceId,\n          alertsCount: result.alerts.length,\n        });\n        return { success: true, data: result.alerts };\n      }\n\n      return { success: false, error: 'Get failed' };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      const isTimeout = isTimeoutError(error);\n      \n      logger.error('Get alerts failed', error instanceof Error ? error : new Error(errorMessage), {\n        component: 'AlertSyncService',\n        action: 'getAlerts',\n        isTimeout,\n        errorMessage,\n      });\n      \n      return {\n        success: false,\n        error: isTimeout \n          ? 'Не удалось загрузить предупреждения. Проверьте подключение к интернету.'\n          : errorMessage,\n      };\n    }\n  }\n}\n\n/**\n * Settings Sync Service\n */\nclass SettingsSyncService {\n  private readonly lastSyncKey = '@settings_last_sync';\n  private initialized = false;\n\n  async initialize(): Promise<void> {\n    if (this.initialized) return;\n    this.initialized = true;\n  }\n\n  async syncSettings(settings: ParentalSettings): Promise<SyncResult<ParentalSettings>> {\n    try {\n      await this.initialize();\n      const deviceId = await getDeviceId();\n      const lastSync = await getLastSyncTimestamp(this.lastSyncKey);\n\n      const result = await withRetry(\n        () => trpcVanillaClient.sync.settings.sync.mutate({\n          deviceId,\n          settings,\n          lastSyncTimestamp: lastSync || 0,\n        }),\n        3,\n        1000,\n        { component: 'SettingsSyncService', action: 'syncSettings', deviceId }\n      );\n\n      if (result.success && result.settings) {\n        await setLastSyncTimestamp(this.lastSyncKey, Date.now());\n        logger.info('Settings synced successfully', {\n          component: 'SettingsSyncService',\n          action: 'syncSettings',\n          deviceId,\n        });\n        return { success: true, data: result.settings };\n      }\n\n      return { success: false, error: 'Sync failed' };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      const isTimeout = isTimeoutError(error);\n      \n      logger.error('Settings sync failed', error instanceof Error ? error : new Error(errorMessage), {\n        component: 'SettingsSyncService',\n        action: 'syncSettings',\n        isTimeout,\n        errorMessage,\n      });\n      \n      return {\n        success: false,\n        error: isTimeout \n          ? 'Синхронизация настроек прервана из-за таймаута. Проверьте подключение к интернету.'\n          : errorMessage,\n      };\n    }\n  }\n\n  async getSettings(): Promise<SyncResult<ParentalSettings>> {\n    try {\n      await this.initialize();\n      const deviceId = await getDeviceId();\n\n      const result = await withRetry(\n        () => trpcVanillaClient.sync.settings.get.query({\n          deviceId,\n        }),\n        3,\n        1000,\n        { component: 'SettingsSyncService', action: 'getSettings', deviceId }\n      );\n\n      if (result && result.settings) {\n        await setLastSyncTimestamp(this.lastSyncKey, Date.now());\n        logger.info('Settings retrieved successfully', {\n          component: 'SettingsSyncService',\n          action: 'getSettings',\n          deviceId,\n        });\n        return { success: true, data: result.settings };\n      }\n\n      return { success: false, error: 'Get failed' };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Unknown error';\n      const isTimeout = isTimeoutError(error);\n      \n      logger.error('Get settings failed', error instanceof Error ? error : new Error(errorMessage), {\n        component: 'SettingsSyncService',\n        action: 'getSettings',\n        isTimeout,\n        errorMessage,\n      });\n      \n      return {\n        success: false,\n        error: isTimeout \n          ? 'Не удалось загрузить настройки. Проверьте подключение к интернету.'\n          : errorMessage,\n      };\n    }\n  }\n}\n\n// Export singleton instances\nexport const chatSyncService = new ChatSyncService();\nexport const alertSyncService = new AlertSyncService();\nexport const settingsSyncService = new SettingsSyncService();\n"],"mappings":"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","ignoreList":[]}