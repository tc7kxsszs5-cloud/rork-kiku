{"version":3,"names":["calculateGrowthProjection","initialInstalls","arguments","length","undefined","growthRate","activationRate","dauRate","retentionD7","retentionD30","premiumPrice","premiumConversionRates","projections","currentInstalls","month","activations","Math","round","dau","mau","premiumConversionRate","premiumUsers","mrr","arr","push","installs","growth","calculateUnitEconomics","cac","averageLifetimeMonths","freeUserValue","ltvPremium","ltvFree","ltv","ltvCacRatio","averageRevenuePerUser","checkKPITargets","unitEconomics","month6","targets","userGrowthRate","achieved","month5","generateInvestorProjection","kpiStatus","totalUsers","totalRevenue","reduce","sum","p","allTargetsMet","Object","values","every","v","summary"],"sources":["kpiModeling.ts"],"sourcesContent":["/**\n * Моделирование и расчет KPIs для KIDS by KIKU\n * Используется для прогнозов и презентаций инвесторам\n */\n\nexport interface GrowthProjection {\n  month: number;\n  installs: number;\n  activations: number;\n  dau: number;\n  mau: number;\n  retentionD7: number;\n  retentionD30: number;\n  premiumUsers: number;\n  mrr: number; // Monthly Recurring Revenue\n  arr: number; // Annual Recurring Revenue\n}\n\nexport interface UnitEconomics {\n  cac: number; // Customer Acquisition Cost\n  ltv: number; // Lifetime Value\n  ltvCacRatio: number;\n  premiumConversionRate: number;\n  averageRevenuePerUser: number;\n}\n\nexport interface KPITargets {\n  dau: number;\n  mau: number;\n  userGrowthRate: number; // MoM %\n  retentionD7: number;\n  retentionD30: number;\n  activationRate: number;\n  premiumConversionRate: number;\n  cac: number;\n  ltv: number;\n  ltvCacRatio: number;\n}\n\n/**\n * Прогноз роста на 6 месяцев\n */\nexport function calculateGrowthProjection(\n  initialInstalls: number = 1000,\n  growthRate: number[] = [1.5, 1.0, 0.6, 0.5, 0.25], // Месячный рост (множитель)\n  activationRate: number = 0.6,\n  dauRate: number = 0.3, // % от установок\n  retentionD7: number[] = [0.35, 0.40, 0.42, 0.45, 0.45, 0.45],\n  retentionD30: number[] = [0.20, 0.25, 0.28, 0.30, 0.30, 0.30],\n  premiumPrice: number = 9.99,\n  premiumConversionRates: number[] = [0, 0, 0, 0.03, 0.05, 0.06] // Месяц 1-3: free модель\n): GrowthProjection[] {\n  const projections: GrowthProjection[] = [];\n  let currentInstalls = initialInstalls;\n\n  for (let month = 1; month <= 6; month++) {\n    const activations = Math.round(currentInstalls * activationRate);\n    const dau = Math.round(currentInstalls * dauRate);\n    const mau = currentInstalls; // Упрощение: MAU = установки за месяц\n\n    const premiumConversionRate = premiumConversionRates[month - 1] || 0;\n    const premiumUsers = Math.round(mau * premiumConversionRate);\n    const mrr = premiumUsers * premiumPrice;\n    const arr = mrr * 12;\n\n    projections.push({\n      month,\n      installs: currentInstalls,\n      activations,\n      dau,\n      mau,\n      retentionD7: retentionD7[month - 1] || 0.45,\n      retentionD30: retentionD30[month - 1] || 0.30,\n      premiumUsers,\n      mrr,\n      arr,\n    });\n\n    // Рост для следующего месяца\n    if (month < 6) {\n      const growth = growthRate[month - 1] || 1.25; // Множитель роста (1.25 = +25%)\n      currentInstalls = Math.round(currentInstalls * growth);\n    }\n  }\n\n  return projections;\n}\n\n/**\n * Расчет Unit Economics\n */\nexport function calculateUnitEconomics(\n  cac: number = 4, // Средний CAC\n  premiumPrice: number = 9.99,\n  averageLifetimeMonths: number = 12,\n  premiumConversionRate: number = 0.05,\n  freeUserValue: number = 15 // Косвенная ценность free пользователя\n): UnitEconomics {\n  const ltvPremium = premiumPrice * averageLifetimeMonths;\n  const ltvFree = freeUserValue;\n  const ltv = ltvPremium * premiumConversionRate + ltvFree * (1 - premiumConversionRate);\n  const ltvCacRatio = ltv / cac;\n  const averageRevenuePerUser = premiumPrice * premiumConversionRate;\n\n  return {\n    cac,\n    ltv,\n    ltvCacRatio,\n    premiumConversionRate,\n    averageRevenuePerUser,\n  };\n}\n\n/**\n * Проверка достижения целевых KPIs\n */\nexport function checkKPITargets(\n  projections: GrowthProjection[],\n  unitEconomics: UnitEconomics\n): { targets: KPITargets; achieved: Partial<Record<keyof KPITargets, boolean>> } {\n  const month6 = projections[5]; // 6-й месяц\n\n  const targets: KPITargets = {\n    dau: 10000,\n    mau: 50000,\n    userGrowthRate: 25, // %\n    retentionD7: 40, // %\n    retentionD30: 25, // %\n    activationRate: 50, // %\n    premiumConversionRate: 5, // %\n    cac: 10,\n    ltv: 50,\n    ltvCacRatio: 3,\n  };\n\n  const achieved: Partial<Record<keyof KPITargets, boolean>> = {\n    dau: month6.dau >= targets.dau,\n    mau: month6.mau >= targets.mau,\n    retentionD7: month6.retentionD7 * 100 >= targets.retentionD7,\n    retentionD30: month6.retentionD30 * 100 >= targets.retentionD30,\n    premiumConversionRate: unitEconomics.premiumConversionRate * 100 >= targets.premiumConversionRate,\n    cac: unitEconomics.cac <= targets.cac,\n    ltv: unitEconomics.ltv >= targets.ltv,\n    ltvCacRatio: unitEconomics.ltvCacRatio >= targets.ltvCacRatio,\n  };\n\n  // Расчет user growth rate (MoM)\n  if (projections.length >= 2) {\n    const month5 = projections[4];\n    const month6 = projections[5];\n    const growthRate = ((month6.mau - month5.mau) / month5.mau) * 100;\n    achieved.userGrowthRate = growthRate >= targets.userGrowthRate;\n  }\n\n  // Расчет activation rate\n  const activationRate = (month6.activations / month6.installs) * 100;\n  achieved.activationRate = activationRate >= targets.activationRate;\n\n  return { targets, achieved };\n}\n\n/**\n * Генерация прогноза для презентации\n */\nexport function generateInvestorProjection(): {\n  projections: GrowthProjection[];\n  unitEconomics: UnitEconomics;\n  kpiStatus: { targets: KPITargets; achieved: Partial<Record<keyof KPITargets, boolean>> };\n  summary: {\n    totalUsers: number;\n    totalRevenue: number;\n    arr: number;\n    allTargetsMet: boolean;\n  };\n} {\n  const projections = calculateGrowthProjection();\n  const unitEconomics = calculateUnitEconomics();\n  const kpiStatus = checkKPITargets(projections, unitEconomics);\n\n  const month6 = projections[5];\n  const totalUsers = month6.mau;\n  const totalRevenue = projections.reduce((sum, p) => sum + p.mrr, 0);\n  const arr = month6.arr;\n  const allTargetsMet = Object.values(kpiStatus.achieved).every((v) => v === true);\n\n  return {\n    projections,\n    unitEconomics,\n    kpiStatus,\n    summary: {\n      totalUsers,\n      totalRevenue,\n      arr,\n      allTargetsMet,\n    },\n  };\n}\n"],"mappings":"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","ignoreList":[]}