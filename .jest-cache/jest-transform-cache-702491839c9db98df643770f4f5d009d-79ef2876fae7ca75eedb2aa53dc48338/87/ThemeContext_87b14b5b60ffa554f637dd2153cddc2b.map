{"version":3,"names":["_createContextHook3","_interopRequireDefault","require","_asyncStorage","_react","_ColorSystem","_logger","THEME_STORAGE_KEY","createThemePalette","semanticColors","isDark","Object","assign","backgroundPrimary","background","primary","backgroundSecondary","secondary","card","surface","cardMuted","muted","textPrimary","text","textSecondary","accentPrimary","interactive","accentMuted","borderSoft","border","headerBackground","elevated","headerText","tabBarBackground","tabBarActive","tabBarInactive","tertiary","heroGradient","surfaceGradient","chipBackground","chipText","success","status","safe","warning","danger","THEMES","sunrise","lightThemeColors","midnight","darkThemeColors","THEME_OPTIONS","value","label","description","_createContextHook","createContextHook","_useState","useState","_useState2","_slicedToArray2","default","themeMode","setThemeModeState","_useState3","_useState4","isReady","setIsReady","useEffect","isMounted","loadTheme","_ref","_asyncToGenerator2","storedMode","AsyncStorage","getItem","logger","info","context","action","mode","error","Error","String","apply","arguments","persistMode","useCallback","_ref2","setItem","console","log","_x","setThemeMode","current","catch","toggleThemeMode","useMemo","theme","themeOptions","_createContextHook2","ThemeProvider","exports","useThemeMode"],"sources":["ThemeContext.tsx"],"sourcesContent":["import createContextHook from '@nkzw/create-context-hook';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useCallback, useEffect, useMemo, useState } from 'react';\nimport { lightThemeColors, darkThemeColors, SemanticColors } from './ColorSystem';\nimport { logger } from '@/utils/logger';\n\nexport type ThemeMode = 'sunrise' | 'midnight';\n\n/**\n * Расширенная палитра темы с улучшенной цветовой системой\n */\nexport interface ThemePalette extends SemanticColors {\n  // Legacy поддержка (для обратной совместимости)\n  backgroundPrimary: string;\n  backgroundSecondary: string;\n  card: string;\n  cardMuted: string;\n  textPrimary: string;\n  textSecondary: string;\n  accentPrimary: string;\n  accentMuted: string;\n  borderSoft: string;\n  headerBackground: string;\n  headerText: string;\n  tabBarBackground: string;\n  tabBarActive: string;\n  tabBarInactive: string;\n  heroGradient: [string, string];\n  surfaceGradient: [string, string];\n  chipBackground: string;\n  chipText: string;\n  isDark: boolean;\n  // Удобные алиасы для часто используемых цветов\n  primary: string;\n  success: string;\n  warning: string;\n  danger: string;\n}\n\nconst THEME_STORAGE_KEY = '@theme_mode_preference';\n\n/**\n * Создание полной палитры темы из семантических цветов\n */\nconst createThemePalette = (semanticColors: SemanticColors, isDark: boolean): ThemePalette => {\n  return {\n    ...semanticColors,\n    // Legacy поддержка\n    backgroundPrimary: semanticColors.background.primary,\n    backgroundSecondary: semanticColors.background.secondary,\n    card: semanticColors.surface.primary,\n    cardMuted: semanticColors.surface.muted,\n    textPrimary: semanticColors.text.primary,\n    textSecondary: semanticColors.text.secondary,\n    accentPrimary: semanticColors.interactive.primary,\n    accentMuted: semanticColors.interactive.secondary,\n    borderSoft: semanticColors.border.muted,\n    headerBackground: semanticColors.surface.elevated,\n    headerText: semanticColors.text.primary,\n    tabBarBackground: semanticColors.surface.elevated,\n    tabBarActive: semanticColors.interactive.primary,\n    tabBarInactive: semanticColors.text.tertiary,\n    heroGradient: [semanticColors.background.primary, semanticColors.background.secondary],\n    surfaceGradient: [semanticColors.surface.primary, semanticColors.surface.secondary],\n    chipBackground: semanticColors.surface.secondary,\n    chipText: semanticColors.text.primary,\n    isDark,\n    // Удобные алиасы\n    primary: semanticColors.interactive.primary,\n    success: semanticColors.status.safe,\n    warning: semanticColors.status.warning,\n    danger: semanticColors.status.danger,\n  };\n};\n\nconst THEMES: Record<ThemeMode, ThemePalette> = {\n  sunrise: createThemePalette(lightThemeColors, false),\n  midnight: createThemePalette(darkThemeColors, true),\n};\n\n// Уникальные названия тем с контекстом детской безопасности\nconst THEME_OPTIONS: { value: ThemeMode; label: string; description: string }[] = [\n  {\n    value: 'sunrise',\n    label: 'Теплый день',\n    description: 'Теплый защищающий фон с яркими акцентами безопасности',\n  },\n  {\n    value: 'midnight',\n    label: 'Ночной режим',\n    description: 'Глубокий темный фон с теплыми неоновыми акцентами',\n  },\n];\n\ninterface ThemeContextValue {\n  themeMode: ThemeMode;\n  theme: ThemePalette;\n  setThemeMode: (mode: ThemeMode) => void;\n  toggleThemeMode: () => void;\n  themeOptions: typeof THEME_OPTIONS;\n  isReady: boolean;\n}\n\nexport const [ThemeProvider, useThemeMode] = createContextHook<ThemeContextValue>(() => {\n  const [themeMode, setThemeModeState] = useState<ThemeMode>('sunrise');\n  const [isReady, setIsReady] = useState<boolean>(false);\n\n  useEffect(() => {\n    let isMounted = true;\n\n    const loadTheme = async () => {\n      try {\n        const storedMode = await AsyncStorage.getItem(THEME_STORAGE_KEY);\n        if (storedMode && (storedMode === 'sunrise' || storedMode === 'midnight') && isMounted) {\n          setThemeModeState(storedMode);\n          logger.info('Loaded mode from storage', { context: 'ThemeContext', action: 'loadTheme', mode: storedMode });\n        }\n      } catch (error) {\n        logger.error('Failed to load theme mode', error instanceof Error ? error : new Error(String(error)), { context: 'ThemeContext', action: 'loadTheme' });\n      } finally {\n        if (isMounted) {\n          setIsReady(true);\n        }\n      }\n    };\n\n    loadTheme();\n\n    return () => {\n      isMounted = false;\n    };\n  }, []);\n\n  const persistMode = useCallback(async (mode: ThemeMode) => {\n    try {\n      await AsyncStorage.setItem(THEME_STORAGE_KEY, mode);\n      console.log('[ThemeContext] Persisted theme mode', mode);\n    } catch (error) {\n      console.error('[ThemeContext] Failed to persist theme mode', error);\n    }\n  }, []);\n\n  const setThemeMode = useCallback(\n    (mode: ThemeMode) => {\n      setThemeModeState((current) => (current === mode ? current : mode));\n      persistMode(mode).catch((error) => logger.error('Failed to persist theme mode in setThemeMode', error instanceof Error ? error : new Error(String(error)), { context: 'ThemeContext', action: 'setThemeMode', mode }));\n    },\n    [persistMode],\n  );\n\n  const toggleThemeMode = useCallback(() => {\n    setThemeMode(themeMode === 'sunrise' ? 'midnight' : 'sunrise');\n  }, [setThemeMode, themeMode]);\n\n  const value = useMemo<ThemeContextValue>(() => ({\n    themeMode,\n    theme: THEMES[themeMode],\n    setThemeMode,\n    toggleThemeMode,\n    themeOptions: THEME_OPTIONS,\n    isReady,\n  }), [themeMode, setThemeMode, toggleThemeMode, isReady]);\n\n  return value;\n});\n"],"mappings":"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","ignoreList":[]}