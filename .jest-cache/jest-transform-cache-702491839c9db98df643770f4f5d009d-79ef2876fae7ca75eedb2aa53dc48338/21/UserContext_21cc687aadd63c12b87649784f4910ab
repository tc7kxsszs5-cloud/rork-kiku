4936447bb49ca261d5cdcd096c6a8c1a
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useUser = exports.UserProvider = void 0;
var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));
var _createContextHook3 = _interopRequireDefault(require("@nkzw/create-context-hook"));
var _react = require("react");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
var _reactNative = require("react-native");
var _i18n = _interopRequireDefault(require("./i18n"));
var _logger = require("@/utils/logger");
var _errorHandler = require("@/utils/errorHandler");
var USER_STORAGE_KEY = '@user_data';
var _createContextHook = (0, _createContextHook3.default)(function () {
    var _useState = (0, _react.useState)(null),
      _useState2 = (0, _slicedToArray2.default)(_useState, 2),
      user = _useState2[0],
      setUser = _useState2[1];
    var _useState3 = (0, _react.useState)(true),
      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
      isLoading = _useState4[0],
      setIsLoading = _useState4[1];
    (0, _react.useEffect)(function () {
      var isMounted = true;
      var timer;
      var loadUser = function () {
        var _ref = (0, _asyncToGenerator2.default)(function* () {
          try {
            var stored = yield _asyncStorage.default.getItem(USER_STORAGE_KEY);
            if (!isMounted) {
              return;
            }
            if (stored) {
              var userData = JSON.parse(stored);
              var migratedUser = Object.assign({}, userData, {
                role: userData.role || 'parent',
                children: userData.children || []
              });
              setUser(migratedUser);
              if (migratedUser.language) {
                _i18n.default.changeLanguage(migratedUser.language);
              }
            } else {
              var _yield$import = yield import('@/constants/i18n'),
                detectDeviceLanguage = _yield$import.detectDeviceLanguage;
              var detectedLang = yield detectDeviceLanguage();
              if (detectedLang && detectedLang !== _i18n.default.language) {
                _i18n.default.changeLanguage(detectedLang);
                _logger.logger.info('Auto-detected language', {
                  context: 'UserContext',
                  language: detectedLang
                });
              }
            }
          } catch (error) {
            (0, _errorHandler.handleErrorSilently)(error, 'UserContext', {
              action: 'loadUser'
            });
          } finally {
            if (isMounted) {
              setIsLoading(false);
            }
          }
        });
        return function loadUser() {
          return _ref.apply(this, arguments);
        };
      }();
      if (_reactNative.Platform.OS !== 'web') {
        loadUser();
      } else {
        timer = setTimeout(loadUser, 0);
      }
      return function () {
        isMounted = false;
        if (timer) {
          clearTimeout(timer);
        }
      };
    }, []);
    var identifyUser = (0, _react.useCallback)(function () {
      var _ref2 = (0, _asyncToGenerator2.default)(function* (userData) {
        try {
          var newUser = Object.assign({
            id: `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
            createdAt: Date.now(),
            children: userData.children || []
          }, userData);
          yield _asyncStorage.default.setItem(USER_STORAGE_KEY, JSON.stringify(newUser));
          setUser(newUser);
          _logger.logger.info('User identified', {
            context: 'UserContext',
            userId: newUser.id,
            userName: newUser.name,
            childrenCount: newUser.children.length
          });
          return newUser;
        } catch (error) {
          _logger.logger.error('Error identifying user', error instanceof Error ? error : new Error(String(error)), {
            context: 'UserContext',
            action: 'identifyUser'
          });
          throw error;
        }
      });
      return function (_x) {
        return _ref2.apply(this, arguments);
      };
    }(), []);
    var updateUser = (0, _react.useCallback)(function () {
      var _ref3 = (0, _asyncToGenerator2.default)(function* (updates) {
        if (!user) {
          throw new Error('No user to update');
        }
        try {
          var updatedUser = Object.assign({}, user, updates);
          yield _asyncStorage.default.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));
          setUser(updatedUser);
          if (updates.language) {
            _i18n.default.changeLanguage(updates.language);
          }
          _logger.logger.info('User updated', {
            context: 'UserContext',
            userId: updatedUser.id,
            action: 'updateUser'
          });
          return updatedUser;
        } catch (error) {
          (0, _errorHandler.handleErrorSilently)(error, 'UserContext', {
            action: 'updateUser'
          });
          yield (0, _errorHandler.showUserFriendlyError)(error, 'UserContext', {
            action: 'updateUser'
          });
          throw error;
        }
      });
      return function (_x2) {
        return _ref3.apply(this, arguments);
      };
    }(), [user]);
    var addChild = (0, _react.useCallback)(function () {
      var _ref4 = (0, _asyncToGenerator2.default)(function* (childData) {
        if (!user) {
          throw new Error('No user to add child to');
        }
        if (user.role === 'child') {
          throw new Error('Only parent can add children');
        }
        try {
          var newChild = Object.assign({
            id: `child_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
            addedAt: Date.now(),
            parentId: user.id,
            permissions: Object.assign({
              canChangeChatBackgrounds: true,
              canChangeNotificationSounds: true,
              canAddContacts: false
            }, childData.permissions)
          }, childData);
          var updatedUser = Object.assign({}, user, {
            children: [].concat((0, _toConsumableArray2.default)(user.children), [newChild])
          });
          yield _asyncStorage.default.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));
          setUser(updatedUser);
          console.log('Child added:', newChild.id);
          return newChild;
        } catch (error) {
          console.error('Error adding child:', error);
          throw error;
        }
      });
      return function (_x3) {
        return _ref4.apply(this, arguments);
      };
    }(), [user]);
    var removeChild = (0, _react.useCallback)(function () {
      var _ref5 = (0, _asyncToGenerator2.default)(function* (childId) {
        if (!user) {
          throw new Error('No user to remove child from');
        }
        try {
          var updatedChildren = user.children.filter(function (child) {
            return child.id !== childId;
          });
          var updatedUser = Object.assign({}, user, {
            children: updatedChildren,
            activeChildId: user.activeChildId === childId ? undefined : user.activeChildId
          });
          yield _asyncStorage.default.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));
          setUser(updatedUser);
          _logger.logger.info('Child removed', {
            context: 'UserContext',
            childId: childId,
            action: 'removeChild'
          });
        } catch (error) {
          _logger.logger.error('Error removing child', error instanceof Error ? error : new Error(String(error)), {
            context: 'UserContext',
            action: 'removeChild'
          });
          throw error;
        }
      });
      return function (_x4) {
        return _ref5.apply(this, arguments);
      };
    }(), [user]);
    var setActiveChild = (0, _react.useCallback)(function () {
      var _ref6 = (0, _asyncToGenerator2.default)(function* (childId) {
        if (!user) {
          throw new Error('No user to update');
        }
        try {
          var updatedUser = Object.assign({}, user, {
            activeChildId: childId
          });
          yield _asyncStorage.default.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));
          setUser(updatedUser);
          _logger.logger.info('Active child set', {
            context: 'UserContext',
            childId: childId,
            action: 'setActiveChild'
          });
        } catch (error) {
          (0, _errorHandler.handleErrorSilently)(error, 'UserContext', {
            action: 'setActiveChild'
          });
          yield (0, _errorHandler.showUserFriendlyError)(error, 'UserContext', {
            action: 'setActiveChild'
          });
          throw error;
        }
      });
      return function (_x5) {
        return _ref6.apply(this, arguments);
      };
    }(), [user]);
    var logoutUser = (0, _react.useCallback)((0, _asyncToGenerator2.default)(function* () {
      try {
        yield _asyncStorage.default.removeItem(USER_STORAGE_KEY);
        setUser(null);
        _logger.logger.info('User logged out', {
          context: 'UserContext',
          action: 'logoutUser'
        });
      } catch (error) {
        (0, _errorHandler.handleErrorSilently)(error, 'UserContext', {
          action: 'logoutUser'
        });
        yield (0, _errorHandler.showUserFriendlyError)(error, 'UserContext', {
          action: 'logoutUser'
        });
        throw error;
      }
    }), []);
    var activeChild = (0, _react.useMemo)(function () {
      if (!user || !user.activeChildId) return null;
      return user.children.find(function (child) {
        return child.id === user.activeChildId;
      }) || null;
    }, [user]);
    return (0, _react.useMemo)(function () {
      return {
        user: user,
        isLoading: isLoading,
        isAuthenticated: !!user,
        activeChild: activeChild,
        children: (user == null ? void 0 : user.children) || [],
        identifyUser: identifyUser,
        updateUser: updateUser,
        addChild: addChild,
        removeChild: removeChild,
        setActiveChild: setActiveChild,
        logoutUser: logoutUser
      };
    }, [user, isLoading, activeChild, identifyUser, updateUser, addChild, removeChild, setActiveChild, logoutUser]);
  }),
  _createContextHook2 = (0, _slicedToArray2.default)(_createContextHook, 2),
  UserProvider = exports.UserProvider = _createContextHook2[0],
  useUser = exports.useUser = _createContextHook2[1];
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY3JlYXRlQ29udGV4dEhvb2szIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfcmVhY3QiLCJfYXN5bmNTdG9yYWdlIiwiX3JlYWN0TmF0aXZlIiwiX2kxOG4iLCJfbG9nZ2VyIiwiX2Vycm9ySGFuZGxlciIsIlVTRVJfU1RPUkFHRV9LRVkiLCJfY3JlYXRlQ29udGV4dEhvb2siLCJjcmVhdGVDb250ZXh0SG9vayIsIl91c2VTdGF0ZSIsInVzZVN0YXRlIiwiX3VzZVN0YXRlMiIsIl9zbGljZWRUb0FycmF5MiIsImRlZmF1bHQiLCJ1c2VyIiwic2V0VXNlciIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0IiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwidXNlRWZmZWN0IiwiaXNNb3VudGVkIiwidGltZXIiLCJsb2FkVXNlciIsIl9yZWYiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJzdG9yZWQiLCJBc3luY1N0b3JhZ2UiLCJnZXRJdGVtIiwidXNlckRhdGEiLCJKU09OIiwicGFyc2UiLCJtaWdyYXRlZFVzZXIiLCJPYmplY3QiLCJhc3NpZ24iLCJyb2xlIiwiY2hpbGRyZW4iLCJsYW5ndWFnZSIsImkxOG4iLCJjaGFuZ2VMYW5ndWFnZSIsIl95aWVsZCRpbXBvcnQiLCJkZXRlY3REZXZpY2VMYW5ndWFnZSIsImRldGVjdGVkTGFuZyIsImxvZ2dlciIsImluZm8iLCJjb250ZXh0IiwiZXJyb3IiLCJoYW5kbGVFcnJvclNpbGVudGx5IiwiYWN0aW9uIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJQbGF0Zm9ybSIsIk9TIiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsImlkZW50aWZ5VXNlciIsInVzZUNhbGxiYWNrIiwiX3JlZjIiLCJuZXdVc2VyIiwiaWQiLCJEYXRlIiwibm93IiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwiY3JlYXRlZEF0Iiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInVzZXJJZCIsInVzZXJOYW1lIiwibmFtZSIsImNoaWxkcmVuQ291bnQiLCJsZW5ndGgiLCJFcnJvciIsIlN0cmluZyIsIl94IiwidXBkYXRlVXNlciIsIl9yZWYzIiwidXBkYXRlcyIsInVwZGF0ZWRVc2VyIiwic2hvd1VzZXJGcmllbmRseUVycm9yIiwiX3gyIiwiYWRkQ2hpbGQiLCJfcmVmNCIsImNoaWxkRGF0YSIsIm5ld0NoaWxkIiwiYWRkZWRBdCIsInBhcmVudElkIiwicGVybWlzc2lvbnMiLCJjYW5DaGFuZ2VDaGF0QmFja2dyb3VuZHMiLCJjYW5DaGFuZ2VOb3RpZmljYXRpb25Tb3VuZHMiLCJjYW5BZGRDb250YWN0cyIsImNvbmNhdCIsIl90b0NvbnN1bWFibGVBcnJheTIiLCJjb25zb2xlIiwibG9nIiwiX3gzIiwicmVtb3ZlQ2hpbGQiLCJfcmVmNSIsImNoaWxkSWQiLCJ1cGRhdGVkQ2hpbGRyZW4iLCJmaWx0ZXIiLCJjaGlsZCIsImFjdGl2ZUNoaWxkSWQiLCJ1bmRlZmluZWQiLCJfeDQiLCJzZXRBY3RpdmVDaGlsZCIsIl9yZWY2IiwiX3g1IiwibG9nb3V0VXNlciIsInJlbW92ZUl0ZW0iLCJhY3RpdmVDaGlsZCIsInVzZU1lbW8iLCJmaW5kIiwiaXNBdXRoZW50aWNhdGVkIiwiX2NyZWF0ZUNvbnRleHRIb29rMiIsIlVzZXJQcm92aWRlciIsImV4cG9ydHMiLCJ1c2VVc2VyIl0sInNvdXJjZXMiOlsiVXNlckNvbnRleHQudHN4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcmVhdGVDb250ZXh0SG9vayBmcm9tICdAbmt6dy9jcmVhdGUtY29udGV4dC1ob29rJztcbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VFZmZlY3QsIHVzZUNhbGxiYWNrLCB1c2VNZW1vIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IEFzeW5jU3RvcmFnZSBmcm9tICdAcmVhY3QtbmF0aXZlLWFzeW5jLXN0b3JhZ2UvYXN5bmMtc3RvcmFnZSc7XG5pbXBvcnQgeyBQbGF0Zm9ybSB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5pbXBvcnQgaTE4biBmcm9tICcuL2kxOG4nO1xuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnQC91dGlscy9sb2dnZXInO1xuXG5pbXBvcnQgeyBVc2VyUm9sZSwgUGFyZW50R2VuZGVyIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBoYW5kbGVFcnJvclNpbGVudGx5LCBzaG93VXNlckZyaWVuZGx5RXJyb3IgfSBmcm9tICdAL3V0aWxzL2Vycm9ySGFuZGxlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2hpbGRQcm9maWxlIHtcbiAgaWQ6IHN0cmluZztcbiAgbmFtZTogc3RyaW5nO1xuICBhZ2U/OiBudW1iZXI7XG4gIGF2YXRhcj86IHN0cmluZztcbiAgZGV2aWNlSWQ/OiBzdHJpbmc7XG4gIGFkZGVkQXQ6IG51bWJlcjtcbiAgcGFyZW50SWQ/OiBzdHJpbmc7IC8vIElEINGA0L7QtNC40YLQtdC70Y8t0LLQu9Cw0LTQtdC70YzRhtCwXG4gIHBpbj86IHN0cmluZzsgLy8gUElOINC00LvRjyDQstGF0L7QtNCwINGA0LXQsdC10L3QutCwICjQvtC/0YbQuNC+0L3QsNC70YzQvdC+KVxuICBwZXJtaXNzaW9ucz86IHtcbiAgICBjYW5DaGFuZ2VDaGF0QmFja2dyb3VuZHM/OiBib29sZWFuO1xuICAgIGNhbkNoYW5nZU5vdGlmaWNhdGlvblNvdW5kcz86IGJvb2xlYW47XG4gICAgY2FuQWRkQ29udGFjdHM/OiBib29sZWFuO1xuICB9O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVzZXIge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIGVtYWlsPzogc3RyaW5nO1xuICBhdmF0YXI/OiBzdHJpbmc7XG4gIGNyZWF0ZWRBdDogbnVtYmVyO1xuICBkZXZpY2VJZD86IHN0cmluZztcbiAgbGFuZ3VhZ2U/OiBzdHJpbmc7XG4gIHJvbGU/OiBVc2VyUm9sZTsgLy8gJ3BhcmVudCcgfCAnY2hpbGQnICjQvtC/0YbQuNC+0L3QsNC70YzQvdC+INC00LvRjyDQvtCx0YDQsNGC0L3QvtC5INGB0L7QstC80LXRgdGC0LjQvNC+0YHRgtC4KVxuICBwYXJlbnRJZD86IHN0cmluZzsgLy8g0JXRgdC70Lggcm9sZT0nY2hpbGQnLCDRg9C60LDQt9GL0LLQsNC10YIg0L3QsCDRgNC+0LTQuNGC0LXQu9GPXG4gIHBhcmVudFBpbj86IHN0cmluZzsgLy8gUElOINGA0L7QtNC40YLQtdC70Y8g0LTQu9GPINCw0YPRgtC10L3RgtC40YTQuNC60LDRhtC40LhcbiAgcGFyZW50R2VuZGVyPzogUGFyZW50R2VuZGVyOyAvLyDQn9C+0Lsg0YDQvtC00LjRgtC10LvRjyAo0LTQu9GPINC70L7QutCw0LvQuNC30LDRhtC40LgpXG4gIGNvdW50cnk/OiBzdHJpbmc7IC8vINCh0YLRgNCw0L3QsCAo0LTQu9GPINC70L7QutCw0LvQuNC30LDRhtC40LgpXG4gIGNoaWxkcmVuOiBDaGlsZFByb2ZpbGVbXTsgLy8g0JzQsNGB0YHQuNCyINC00LXRgtC10Lkg0YDQvtC00LjRgtC10LvRj1xuICBhY3RpdmVDaGlsZElkPzogc3RyaW5nOyAvLyBJRCDQsNC60YLQuNCy0L3QvtCz0L4gKNCy0YvQsdGA0LDQvdC90L7Qs9C+KSDRgNC10LHQtdC90LrQsCDQtNC70Y8g0L/RgNC+0YHQvNC+0YLRgNCwXG59XG5cbmNvbnN0IFVTRVJfU1RPUkFHRV9LRVkgPSAnQHVzZXJfZGF0YSc7XG5cbmV4cG9ydCBjb25zdCBbVXNlclByb3ZpZGVyLCB1c2VVc2VyXSA9IGNyZWF0ZUNvbnRleHRIb29rKCgpID0+IHtcbiAgY29uc3QgW3VzZXIsIHNldFVzZXJdID0gdXNlU3RhdGU8VXNlciB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBsZXQgaXNNb3VudGVkID0gdHJ1ZTtcbiAgICBsZXQgdGltZXI6IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+IHwgdW5kZWZpbmVkO1xuXG4gICAgY29uc3QgbG9hZFVzZXIgPSBhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzdG9yZWQgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0SXRlbShVU0VSX1NUT1JBR0VfS0VZKTtcbiAgICAgICAgaWYgKCFpc01vdW50ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHN0b3JlZCkge1xuICAgICAgICAgIGNvbnN0IHVzZXJEYXRhID0gSlNPTi5wYXJzZShzdG9yZWQpO1xuICAgICAgICAgIC8vINCc0LjQs9GA0LDRhtC40Y86INC10YHQu9C4INC90LXRgiByb2xlLCDRg9GB0YLQsNC90LDQstC70LjQstCw0LXQvCAncGFyZW50JyDQv9C+INGD0LzQvtC70YfQsNC90LjRjlxuICAgICAgICAgIGNvbnN0IG1pZ3JhdGVkVXNlcjogVXNlciA9IHtcbiAgICAgICAgICAgIC4uLnVzZXJEYXRhLFxuICAgICAgICAgICAgcm9sZTogdXNlckRhdGEucm9sZSB8fCAncGFyZW50JywgLy8g0J/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0YDQvtC00LjRgtC10LvRjFxuICAgICAgICAgICAgY2hpbGRyZW46IHVzZXJEYXRhLmNoaWxkcmVuIHx8IFtdLCAvLyDQntCx0LXRgdC/0LXRh9C40LLQsNC10Lwg0L3QsNC70LjRh9C40LUgY2hpbGRyZW5cbiAgICAgICAgICB9O1xuICAgICAgICAgIHNldFVzZXIobWlncmF0ZWRVc2VyKTtcbiAgICAgICAgICBpZiAobWlncmF0ZWRVc2VyLmxhbmd1YWdlKSB7XG4gICAgICAgICAgICBpMThuLmNoYW5nZUxhbmd1YWdlKG1pZ3JhdGVkVXNlci5sYW5ndWFnZSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8vINCf0LXRgNCy0YvQuSDQt9Cw0L/Rg9GB0LogLSDQvtC/0YDQtdC00LXQu9GP0LXQvCDRj9C30YvQuiDRg9GB0YLRgNC+0LnRgdGC0LLQsCDQsNCy0YLQvtC80LDRgtC40YfQtdGB0LrQuFxuICAgICAgICAgIGNvbnN0IHsgZGV0ZWN0RGV2aWNlTGFuZ3VhZ2UgfSA9IGF3YWl0IGltcG9ydCgnQC9jb25zdGFudHMvaTE4bicpO1xuICAgICAgICAgIGNvbnN0IGRldGVjdGVkTGFuZyA9IGF3YWl0IGRldGVjdERldmljZUxhbmd1YWdlKCk7XG4gICAgICAgICAgaWYgKGRldGVjdGVkTGFuZyAmJiBkZXRlY3RlZExhbmcgIT09IGkxOG4ubGFuZ3VhZ2UpIHtcbiAgICAgICAgICAgIGkxOG4uY2hhbmdlTGFuZ3VhZ2UoZGV0ZWN0ZWRMYW5nKTtcbiAgICAgICAgICAgIGxvZ2dlci5pbmZvKCdBdXRvLWRldGVjdGVkIGxhbmd1YWdlJywgeyBjb250ZXh0OiAnVXNlckNvbnRleHQnLCBsYW5ndWFnZTogZGV0ZWN0ZWRMYW5nIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgaGFuZGxlRXJyb3JTaWxlbnRseShlcnJvciwgJ1VzZXJDb250ZXh0JywgeyBhY3Rpb246ICdsb2FkVXNlcicgfSk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICBpZiAoaXNNb3VudGVkKSB7XG4gICAgICAgICAgc2V0SXNMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoUGxhdGZvcm0uT1MgIT09ICd3ZWInKSB7XG4gICAgICBsb2FkVXNlcigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aW1lciA9IHNldFRpbWVvdXQobG9hZFVzZXIsIDApO1xuICAgIH1cblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpc01vdW50ZWQgPSBmYWxzZTtcbiAgICAgIGlmICh0aW1lcikge1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZXIpO1xuICAgICAgfVxuICAgIH07XG4gIH0sIFtdKTtcblxuICBjb25zdCBpZGVudGlmeVVzZXIgPSB1c2VDYWxsYmFjayhhc3luYyAodXNlckRhdGE6IE9taXQ8VXNlciwgJ2lkJyB8ICdjcmVhdGVkQXQnIHwgJ2NoaWxkcmVuJz4gJiB7IGNoaWxkcmVuPzogQ2hpbGRQcm9maWxlW10gfSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBuZXdVc2VyOiBVc2VyID0ge1xuICAgICAgICBpZDogYHVzZXJfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gLFxuICAgICAgICBjcmVhdGVkQXQ6IERhdGUubm93KCksXG4gICAgICAgIGNoaWxkcmVuOiB1c2VyRGF0YS5jaGlsZHJlbiB8fCBbXSxcbiAgICAgICAgLi4udXNlckRhdGEsXG4gICAgICB9O1xuXG4gICAgICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbShVU0VSX1NUT1JBR0VfS0VZLCBKU09OLnN0cmluZ2lmeShuZXdVc2VyKSk7XG4gICAgICBzZXRVc2VyKG5ld1VzZXIpO1xuXG4gICAgICBsb2dnZXIuaW5mbygnVXNlciBpZGVudGlmaWVkJywgeyBjb250ZXh0OiAnVXNlckNvbnRleHQnLCB1c2VySWQ6IG5ld1VzZXIuaWQsIHVzZXJOYW1lOiBuZXdVc2VyLm5hbWUsIGNoaWxkcmVuQ291bnQ6IG5ld1VzZXIuY2hpbGRyZW4ubGVuZ3RoIH0pO1xuXG4gICAgICByZXR1cm4gbmV3VXNlcjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBpZGVudGlmeWluZyB1c2VyJywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6ICdVc2VyQ29udGV4dCcsIGFjdGlvbjogJ2lkZW50aWZ5VXNlcicgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCB1cGRhdGVVc2VyID0gdXNlQ2FsbGJhY2soYXN5bmMgKHVwZGF0ZXM6IFBhcnRpYWw8T21pdDxVc2VyLCAnaWQnIHwgJ2NyZWF0ZWRBdCc+PikgPT4ge1xuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyB1c2VyIHRvIHVwZGF0ZScpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHsgLi4udXNlciwgLi4udXBkYXRlcyB9O1xuICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnNldEl0ZW0oVVNFUl9TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFVzZXIpKTtcbiAgICAgIHNldFVzZXIodXBkYXRlZFVzZXIpO1xuXG4gICAgICBpZiAodXBkYXRlcy5sYW5ndWFnZSkge1xuICAgICAgICBpMThuLmNoYW5nZUxhbmd1YWdlKHVwZGF0ZXMubGFuZ3VhZ2UpO1xuICAgICAgfVxuXG4gICAgICBsb2dnZXIuaW5mbygnVXNlciB1cGRhdGVkJywgeyBjb250ZXh0OiAnVXNlckNvbnRleHQnLCB1c2VySWQ6IHVwZGF0ZWRVc2VyLmlkLCBhY3Rpb246ICd1cGRhdGVVc2VyJyB9KTtcbiAgICAgIHJldHVybiB1cGRhdGVkVXNlcjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaGFuZGxlRXJyb3JTaWxlbnRseShlcnJvciwgJ1VzZXJDb250ZXh0JywgeyBhY3Rpb246ICd1cGRhdGVVc2VyJyB9KTtcbiAgICAgIGF3YWl0IHNob3dVc2VyRnJpZW5kbHlFcnJvcihlcnJvciwgJ1VzZXJDb250ZXh0JywgeyBhY3Rpb246ICd1cGRhdGVVc2VyJyB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfSwgW3VzZXJdKTtcblxuICBjb25zdCBhZGRDaGlsZCA9IHVzZUNhbGxiYWNrKGFzeW5jIChjaGlsZERhdGE6IE9taXQ8Q2hpbGRQcm9maWxlLCAnaWQnIHwgJ2FkZGVkQXQnIHwgJ3BhcmVudElkJz4pID0+IHtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdXNlciB0byBhZGQgY2hpbGQgdG8nKTtcbiAgICB9XG5cbiAgICAvLyDQn9GA0L7QstC10YDQutCwOiDRgtC+0LvRjNC60L4g0YDQvtC00LjRgtC10LvRjCDQvNC+0LbQtdGCINC00L7QsdCw0LLQu9GP0YLRjCDQtNC10YLQtdC5XG4gICAgaWYgKHVzZXIucm9sZSA9PT0gJ2NoaWxkJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdPbmx5IHBhcmVudCBjYW4gYWRkIGNoaWxkcmVuJyk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IG5ld0NoaWxkOiBDaGlsZFByb2ZpbGUgPSB7XG4gICAgICAgIGlkOiBgY2hpbGRfJHtEYXRlLm5vdygpfV8ke01hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA5KX1gLFxuICAgICAgICBhZGRlZEF0OiBEYXRlLm5vdygpLFxuICAgICAgICBwYXJlbnRJZDogdXNlci5pZCxcbiAgICAgICAgcGVybWlzc2lvbnM6IHtcbiAgICAgICAgICBjYW5DaGFuZ2VDaGF0QmFja2dyb3VuZHM6IHRydWUsXG4gICAgICAgICAgY2FuQ2hhbmdlTm90aWZpY2F0aW9uU291bmRzOiB0cnVlLFxuICAgICAgICAgIGNhbkFkZENvbnRhY3RzOiBmYWxzZSwgLy8g0J/QviDRg9C80L7Qu9GH0LDQvdC40Y4g0YLQvtC70YzQutC+INGA0L7QtNC40YLQtdC70YxcbiAgICAgICAgICAuLi5jaGlsZERhdGEucGVybWlzc2lvbnMsXG4gICAgICAgIH0sXG4gICAgICAgIC4uLmNoaWxkRGF0YSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHVwZGF0ZWRVc2VyID0ge1xuICAgICAgICAuLi51c2VyLFxuICAgICAgICBjaGlsZHJlbjogWy4uLnVzZXIuY2hpbGRyZW4sIG5ld0NoaWxkXSxcbiAgICAgIH07XG5cbiAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKFVTRVJfU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KHVwZGF0ZWRVc2VyKSk7XG4gICAgICBzZXRVc2VyKHVwZGF0ZWRVc2VyKTtcblxuICAgICAgY29uc29sZS5sb2coJ0NoaWxkIGFkZGVkOicsIG5ld0NoaWxkLmlkKTtcbiAgICAgIHJldHVybiBuZXdDaGlsZDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgYWRkaW5nIGNoaWxkOicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfSwgW3VzZXJdKTtcblxuICBjb25zdCByZW1vdmVDaGlsZCA9IHVzZUNhbGxiYWNrKGFzeW5jIChjaGlsZElkOiBzdHJpbmcpID0+IHtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdXNlciB0byByZW1vdmUgY2hpbGQgZnJvbScpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cGRhdGVkQ2hpbGRyZW4gPSB1c2VyLmNoaWxkcmVuLmZpbHRlcihjaGlsZCA9PiBjaGlsZC5pZCAhPT0gY2hpbGRJZCk7XG4gICAgICBjb25zdCB1cGRhdGVkVXNlciA9IHtcbiAgICAgICAgLi4udXNlcixcbiAgICAgICAgY2hpbGRyZW46IHVwZGF0ZWRDaGlsZHJlbixcbiAgICAgICAgYWN0aXZlQ2hpbGRJZDogdXNlci5hY3RpdmVDaGlsZElkID09PSBjaGlsZElkID8gdW5kZWZpbmVkIDogdXNlci5hY3RpdmVDaGlsZElkLFxuICAgICAgfTtcblxuICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLnNldEl0ZW0oVVNFUl9TVE9SQUdFX0tFWSwgSlNPTi5zdHJpbmdpZnkodXBkYXRlZFVzZXIpKTtcbiAgICAgIHNldFVzZXIodXBkYXRlZFVzZXIpO1xuXG4gICAgICBsb2dnZXIuaW5mbygnQ2hpbGQgcmVtb3ZlZCcsIHsgY29udGV4dDogJ1VzZXJDb250ZXh0JywgY2hpbGRJZCwgYWN0aW9uOiAncmVtb3ZlQ2hpbGQnIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHJlbW92aW5nIGNoaWxkJywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6ICdVc2VyQ29udGV4dCcsIGFjdGlvbjogJ3JlbW92ZUNoaWxkJyB9KTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfSwgW3VzZXJdKTtcblxuICBjb25zdCBzZXRBY3RpdmVDaGlsZCA9IHVzZUNhbGxiYWNrKGFzeW5jIChjaGlsZElkOiBzdHJpbmcgfCB1bmRlZmluZWQpID0+IHtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gdXNlciB0byB1cGRhdGUnKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgdXBkYXRlZFVzZXIgPSB7IC4uLnVzZXIsIGFjdGl2ZUNoaWxkSWQ6IGNoaWxkSWQgfTtcbiAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5zZXRJdGVtKFVTRVJfU1RPUkFHRV9LRVksIEpTT04uc3RyaW5naWZ5KHVwZGF0ZWRVc2VyKSk7XG4gICAgICBzZXRVc2VyKHVwZGF0ZWRVc2VyKTtcblxuICAgICAgbG9nZ2VyLmluZm8oJ0FjdGl2ZSBjaGlsZCBzZXQnLCB7IGNvbnRleHQ6ICdVc2VyQ29udGV4dCcsIGNoaWxkSWQsIGFjdGlvbjogJ3NldEFjdGl2ZUNoaWxkJyB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaGFuZGxlRXJyb3JTaWxlbnRseShlcnJvciwgJ1VzZXJDb250ZXh0JywgeyBhY3Rpb246ICdzZXRBY3RpdmVDaGlsZCcgfSk7XG4gICAgICBhd2FpdCBzaG93VXNlckZyaWVuZGx5RXJyb3IoZXJyb3IsICdVc2VyQ29udGV4dCcsIHsgYWN0aW9uOiAnc2V0QWN0aXZlQ2hpbGQnIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9LCBbdXNlcl0pO1xuXG4gIGNvbnN0IGxvZ291dFVzZXIgPSB1c2VDYWxsYmFjayhhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IEFzeW5jU3RvcmFnZS5yZW1vdmVJdGVtKFVTRVJfU1RPUkFHRV9LRVkpO1xuICAgICAgc2V0VXNlcihudWxsKTtcbiAgICAgIGxvZ2dlci5pbmZvKCdVc2VyIGxvZ2dlZCBvdXQnLCB7IGNvbnRleHQ6ICdVc2VyQ29udGV4dCcsIGFjdGlvbjogJ2xvZ291dFVzZXInIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBoYW5kbGVFcnJvclNpbGVudGx5KGVycm9yLCAnVXNlckNvbnRleHQnLCB7IGFjdGlvbjogJ2xvZ291dFVzZXInIH0pO1xuICAgICAgYXdhaXQgc2hvd1VzZXJGcmllbmRseUVycm9yKGVycm9yLCAnVXNlckNvbnRleHQnLCB7IGFjdGlvbjogJ2xvZ291dFVzZXInIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9LCBbXSk7XG5cbiAgY29uc3QgYWN0aXZlQ2hpbGQgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBpZiAoIXVzZXIgfHwgIXVzZXIuYWN0aXZlQ2hpbGRJZCkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHVzZXIuY2hpbGRyZW4uZmluZChjaGlsZCA9PiBjaGlsZC5pZCA9PT0gdXNlci5hY3RpdmVDaGlsZElkKSB8fCBudWxsO1xuICB9LCBbdXNlcl0pO1xuXG4gIHJldHVybiB1c2VNZW1vKCgpID0+ICh7XG4gICAgdXNlcixcbiAgICBpc0xvYWRpbmcsXG4gICAgaXNBdXRoZW50aWNhdGVkOiAhIXVzZXIsXG4gICAgYWN0aXZlQ2hpbGQsXG4gICAgY2hpbGRyZW46IHVzZXI/LmNoaWxkcmVuIHx8IFtdLFxuICAgIGlkZW50aWZ5VXNlcixcbiAgICB1cGRhdGVVc2VyLFxuICAgIGFkZENoaWxkLFxuICAgIHJlbW92ZUNoaWxkLFxuICAgIHNldEFjdGl2ZUNoaWxkLFxuICAgIGxvZ291dFVzZXIsXG4gIH0pLCBbdXNlciwgaXNMb2FkaW5nLCBhY3RpdmVDaGlsZCwgaWRlbnRpZnlVc2VyLCB1cGRhdGVVc2VyLCBhZGRDaGlsZCwgcmVtb3ZlQ2hpbGQsIHNldEFjdGl2ZUNoaWxkLCBsb2dvdXRVc2VyXSk7XG59KTtcbiJdLCJtYXBwaW5n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