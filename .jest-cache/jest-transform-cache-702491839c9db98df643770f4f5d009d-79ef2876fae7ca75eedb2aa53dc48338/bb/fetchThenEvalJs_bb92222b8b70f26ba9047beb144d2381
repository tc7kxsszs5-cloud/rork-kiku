e412d5b6acd99b7ff67d96621c172a57
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.fetchThenEvalAsync = fetchThenEvalAsync;
var _errors = require("./errors");
var _fetchAsync = require("./fetchAsync");
function fetchThenEvalAsync(url) {
  return (0, _fetchAsync.fetchAsync)(url).then(function (_ref) {
    var body = _ref.body,
      status = _ref.status,
      headers = _ref.headers;
    if ((headers == null || headers.has == null ? void 0 : headers.has('Content-Type')) != null && headers.get('Content-Type').includes('application/json')) {
      throw new Error(JSON.parse(body).message || `Unknown error fetching '${url}'`);
    }
    if (status === 200) {
      return eval(body);
    } else {
      if (process.env.NODE_ENV === 'development') {
        var error = jsonParseOptional(body);
        if (error) {
          throw new _errors.MetroServerError(error, url);
        }
      }
      throw new Error(`Failed to load split bundle from URL: ${url}\n${body}`);
    }
  });
}
function jsonParseOptional(json) {
  try {
    return JSON.parse(json);
  } catch (_unused) {
    return null;
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXJyb3JzIiwicmVxdWlyZSIsIl9mZXRjaEFzeW5jIiwiZmV0Y2hUaGVuRXZhbEFzeW5jIiwidXJsIiwiZmV0Y2hBc3luYyIsInRoZW4iLCJfcmVmIiwiYm9keSIsInN0YXR1cyIsImhlYWRlcnMiLCJoYXMiLCJnZXQiLCJpbmNsdWRlcyIsIkVycm9yIiwiSlNPTiIsInBhcnNlIiwibWVzc2FnZSIsImV2YWwiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJlcnJvciIsImpzb25QYXJzZU9wdGlvbmFsIiwiTWV0cm9TZXJ2ZXJFcnJvciIsImpzb24iLCJfdW51c2VkIl0sInNvdXJjZXMiOlsiZmV0Y2hUaGVuRXZhbEpzLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IMKpIDIwMjIgNjUwIEluZHVzdHJpZXMuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UgZm91bmQgaW4gdGhlXG4gKiBMSUNFTlNFIGZpbGUgaW4gdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cbmltcG9ydCB7IE1ldHJvU2VydmVyRXJyb3IgfSBmcm9tICcuL2Vycm9ycyc7XG5pbXBvcnQgeyBmZXRjaEFzeW5jIH0gZnJvbSAnLi9mZXRjaEFzeW5jJztcbi8qKlxuICogTG9hZCBhIGJ1bmRsZSBmb3IgYSBVUkwgdXNpbmcgZmV0Y2ggKyBldmFsIG9uIG5hdGl2ZSBhbmQgc2NyaXB0IHRhZyBpbmplY3Rpb24gb24gd2ViLlxuICpcbiAqIEBwYXJhbSB1cmwgR2l2ZW4gYSBzdGF0ZW1lbnQgbGlrZSBgaW1wb3J0KCcuL0JhY29uJylgIGBidW5kbGVQYXRoYCB3b3VsZCBiZSBgQmFjb25gLlxuICovXG5leHBvcnQgZnVuY3Rpb24gZmV0Y2hUaGVuRXZhbEFzeW5jKHVybDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIHJldHVybiBmZXRjaEFzeW5jKHVybCkudGhlbigoeyBib2R5LCBzdGF0dXMsIGhlYWRlcnMgfSkgPT4ge1xuICAgIGlmIChcbiAgICAgIGhlYWRlcnM/Lmhhcz8uKCdDb250ZW50LVR5cGUnKSAhPSBudWxsICYmXG4gICAgICBoZWFkZXJzLmdldCgnQ29udGVudC1UeXBlJykhLmluY2x1ZGVzKCdhcHBsaWNhdGlvbi9qc29uJylcbiAgICApIHtcbiAgICAgIC8vIEVycm9ycyBhcmUgcmV0dXJuZWQgYXMgSlNPTi5cbiAgICAgIHRocm93IG5ldyBFcnJvcihKU09OLnBhcnNlKGJvZHkpLm1lc3NhZ2UgfHwgYFVua25vd24gZXJyb3IgZmV0Y2hpbmcgJyR7dXJsfSdgKTtcbiAgICB9XG5cbiAgICBpZiAoc3RhdHVzID09PSAyMDApIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1ldmFsXG4gICAgICByZXR1cm4gZXZhbChib2R5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRm9ybWF0IE1ldHJvIGVycm9ycyBpZiBwb3NzaWJsZS5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50Jykge1xuICAgICAgICAvLyBib2R5IGNhbiBiZSBhbiBlcnJvciBmcm9tIE1ldHJvIGlmIGEgbW9kdWxlIGlzIG1pc3NpbmcuXG4gICAgICAgIC8vIHtcIm9yaWdpbk1vZHVsZVBhdGhcIjpcIi9Vc2Vycy9ldmFuYmFjb24vRG9jdW1lbnRzL0dpdEh1Yi9leHBvLy5cIixcInRhcmdldE1vZHVsZU5hbWVcIjpcIi4vaHR0cDovL2xvY2FsaG9zdDo4MDgxL25vZGVfbW9kdWxlcy9yZWFjdC1uYXRpdmUvaW5kZXguanNcIixcIm1lc3NhZ2VcIjpcIi4uLlwifVxuICAgICAgICBjb25zdCBlcnJvciA9IGpzb25QYXJzZU9wdGlvbmFsKGJvZHkpO1xuICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAvLyBUT0RPOiBUaGlzIGlzIGVzc2VudGlhbGx5IGxpa2UgdGhlIE1ldHJvIG5hdGl2ZSByZWQgYm94IGVycm9ycy4gV2Ugc2hvdWxkIGRvIGEgYmV0dGVyIGpvYiBmb3JtYXR0aW5nIHRoZW0gc29cbiAgICAgICAgICAvLyB0aGUgdXNlciBleHBlcmllbmNlIGRvZXNuJ3QgZmVlbCBiYWQuIFRoaXMgY2FuIGJlIHRlc3RlZCBieSBsb2FkaW5nIGEgc3BsaXQgYnVuZGxlIHRoYXQgcmVzdWx0cyBpbiBhIG1pc3NpbmcgbW9kdWxlIGVycm9yIGZyb20gTWV0cm8uXG4gICAgICAgICAgdGhyb3cgbmV3IE1ldHJvU2VydmVyRXJyb3IoZXJyb3IsIHVybCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gbG9hZCBzcGxpdCBidW5kbGUgZnJvbSBVUkw6ICR7dXJsfVxcbiR7Ym9keX1gKTtcbiAgICB9XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBqc29uUGFyc2VPcHRpb25hbChqc29uOiBzdHJpbmcpOiBhbnkge1xuICB0cnkge1xuICAgIHJldHVybiBKU09OLnBhcnNlKGpzb24pO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7O0FBTUEsSUFBQUEsT0FBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsV0FBQSxHQUFBRCxPQUFBO0FBTU8sU0FBU0Usa0JBQWtCQSxDQUFDQyxHQUFXLEVBQWlCO0VBQzdELE9BQU8sSUFBQUMsc0JBQVUsRUFBQ0QsR0FBRyxDQUFDLENBQUNFLElBQUksQ0FBQyxVQUFBQyxJQUFBLEVBQStCO0lBQUEsSUFBNUJDLElBQUksR0FBQUQsSUFBQSxDQUFKQyxJQUFJO01BQUVDLE1BQU0sR0FBQUYsSUFBQSxDQUFORSxNQUFNO01BQUVDLE9BQU8sR0FBQUgsSUFBQSxDQUFQRyxPQUFPO0lBQ2xELElBQ0UsQ0FBQUEsT0FBTyxZQUFQQSxPQUFPLENBQUVDLEdBQUcsb0JBQVpELE9BQU8sQ0FBRUMsR0FBRyxDQUFHLGNBQWMsQ0FBQyxLQUFJLElBQUksSUFDdENELE9BQU8sQ0FBQ0UsR0FBRyxDQUFDLGNBQWMsQ0FBQyxDQUFFQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsRUFDekQ7TUFFQSxNQUFNLElBQUlDLEtBQUssQ0FBQ0MsSUFBSSxDQUFDQyxLQUFLLENBQUNSLElBQUksQ0FBQyxDQUFDUyxPQUFPLElBQUksMkJBQTJCYixHQUFHLEdBQUcsQ0FBQztJQUNoRjtJQUVBLElBQUlLLE1BQU0sS0FBSyxHQUFHLEVBQUU7TUFFbEIsT0FBT1MsSUFBSSxDQUFDVixJQUFJLENBQUM7SUFDbkIsQ0FBQyxNQUFNO01BRUwsSUFBSVcsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFFBQVEsS0FBSyxhQUFhLEVBQUU7UUFHMUMsSUFBTUMsS0FBSyxHQUFHQyxpQkFBaUIsQ0FBQ2YsSUFBSSxDQUFDO1FBQ3JDLElBQUljLEtBQUssRUFBRTtVQUdULE1BQU0sSUFBSUUsd0JBQWdCLENBQUNGLEtBQUssRUFBRWxCLEdBQUcsQ0FBQztRQUN4QztNQUNGO01BRUEsTUFBTSxJQUFJVSxLQUFLLENBQUMseUNBQXlDVixHQUFHLEtBQUtJLElBQUksRUFBRSxDQUFDO0lBQzFFO0VBQ0YsQ0FBQyxDQUFDO0FBQ0o7QUFFQSxTQUFTZSxpQkFBaUJBLENBQUNFLElBQVksRUFBTztFQUM1QyxJQUFJO0lBQ0YsT0FBT1YsSUFBSSxDQUFDQyxLQUFLLENBQUNTLElBQUksQ0FBQztFQUN6QixDQUFDLENBQUMsT0FBQUMsT0FBQSxFQUFNO0lBQ04sT0FBTyxJQUFJO0VBQ2I7QUFDRiIsImlnbm9yZUxpc3QiOltdfQ==