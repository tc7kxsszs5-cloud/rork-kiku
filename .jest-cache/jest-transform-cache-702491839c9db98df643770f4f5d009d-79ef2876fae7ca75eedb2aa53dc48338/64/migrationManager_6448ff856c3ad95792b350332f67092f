7601ba67211068e0ccf7b3928208339d
import _toConsumableArray from "@babel/runtime/helpers/toConsumableArray";
import _asyncToGenerator from "@babel/runtime/helpers/asyncToGenerator";
import _classCallCheck from "@babel/runtime/helpers/classCallCheck";
import _createClass from "@babel/runtime/helpers/createClass";
import AsyncStorage from '@react-native-async-storage/async-storage';
export var MigrationManager = function () {
  function MigrationManager() {
    _classCallCheck(this, MigrationManager);
    this.migrations = [];
    this.backupEnabled = true;
  }
  return _createClass(MigrationManager, [{
    key: "register",
    value: function register(migration) {
      var conflict = this.migrations.find(function (m) {
        return m.fromVersion === migration.fromVersion && m.toVersion === migration.toVersion;
      });
      if (conflict) {
        console.warn(`[MigrationManager] Migration conflict: ${migration.name} conflicts with ${conflict.name}`);
      }
      this.migrations.push(migration);
      this.migrations.sort(function (a, b) {
        return a.fromVersion - b.fromVersion;
      });
    }
  }, {
    key: "migrate",
    value: (function () {
      var _migrate = _asyncToGenerator(function* (data, fromVersion, toVersion) {
        var _this = this;
        if (fromVersion >= toVersion) {
          return {
            success: true,
            data: data,
            fromVersion: fromVersion,
            toVersion: toVersion
          };
        }
        var currentData = data;
        var currentVersion = fromVersion;
        try {
          if (this.backupEnabled) {
            yield this.saveBackup(currentData, currentVersion);
          }
          var _loop = function* _loop() {
            var nextVersion = currentVersion + 1;
            var migration = _this.migrations.find(function (m) {
              return m.fromVersion === currentVersion && m.toVersion === nextVersion;
            });
            if (!migration) {
              throw new Error(`No migration found from version ${currentVersion} to ${nextVersion}`);
            }
            console.log(`[MigrationManager] Migrating from ${currentVersion} to ${nextVersion}: ${migration.name}`);
            currentData = yield migration.migrate(currentData);
            currentVersion = migration.toVersion;
            if (currentData && typeof currentData === 'object') {
              currentData.version = currentVersion;
              currentData.migratedAt = Date.now();
              currentData.migratedFrom = migration.fromVersion;
            }
          };
          while (currentVersion < toVersion) {
            yield* _loop();
          }
          return {
            success: true,
            data: currentData,
            fromVersion: fromVersion,
            toVersion: currentVersion
          };
        } catch (error) {
          console.error('[MigrationManager] Migration failed:', error);
          return {
            success: false,
            data: currentData,
            fromVersion: fromVersion,
            toVersion: currentVersion,
            error: error instanceof Error ? error : new Error(String(error))
          };
        }
      });
      function migrate(_x, _x2, _x3) {
        return _migrate.apply(this, arguments);
      }
      return migrate;
    }())
  }, {
    key: "rollback",
    value: (function () {
      var _rollback = _asyncToGenerator(function* (data, fromVersion, toVersion) {
        var _this2 = this;
        if (fromVersion <= toVersion) {
          return {
            success: true,
            data: data,
            fromVersion: fromVersion,
            toVersion: toVersion
          };
        }
        var currentData = data;
        var currentVersion = fromVersion;
        try {
          var _loop2 = function* _loop2() {
            var prevVersion = currentVersion - 1;
            var migration = _this2.migrations.find(function (m) {
              return m.fromVersion === prevVersion && m.toVersion === currentVersion;
            });
            if (!migration || !migration.rollback) {
              throw new Error(`No rollback found from version ${currentVersion} to ${prevVersion}`);
            }
            console.log(`[MigrationManager] Rolling back from ${currentVersion} to ${prevVersion}: ${migration.name}`);
            currentData = yield migration.rollback(currentData);
            currentVersion = prevVersion;
          };
          while (currentVersion > toVersion) {
            yield* _loop2();
          }
          return {
            success: true,
            data: currentData,
            fromVersion: fromVersion,
            toVersion: currentVersion
          };
        } catch (error) {
          console.error('[MigrationManager] Rollback failed:', error);
          return {
            success: false,
            data: currentData,
            fromVersion: fromVersion,
            toVersion: currentVersion,
            error: error instanceof Error ? error : new Error(String(error))
          };
        }
      });
      function rollback(_x4, _x5, _x6) {
        return _rollback.apply(this, arguments);
      }
      return rollback;
    }())
  }, {
    key: "saveBackup",
    value: (function () {
      var _saveBackup = _asyncToGenerator(function* (data, version) {
        try {
          var backupKey = `@backup_v${version}_${Date.now()}`;
          yield AsyncStorage.setItem(backupKey, JSON.stringify(data));
          var keys = yield AsyncStorage.getAllKeys();
          var backupKeys = keys.filter(function (k) {
            return k.startsWith('@backup_');
          }).sort();
          if (backupKeys.length > 5) {
            var keysToRemove = backupKeys.slice(0, backupKeys.length - 5);
            yield AsyncStorage.multiRemove(keysToRemove);
          }
        } catch (error) {
          console.error('[MigrationManager] Failed to save backup:', error);
        }
      });
      function saveBackup(_x7, _x8) {
        return _saveBackup.apply(this, arguments);
      }
      return saveBackup;
    }())
  }, {
    key: "getMigrations",
    value: function getMigrations() {
      return _toConsumableArray(this.migrations);
    }
  }, {
    key: "setBackupEnabled",
    value: function setBackupEnabled(enabled) {
      this.backupEnabled = enabled;
    }
  }]);
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBc3luY1N0b3JhZ2UiLCJNaWdyYXRpb25NYW5hZ2VyIiwiX2NsYXNzQ2FsbENoZWNrIiwibWlncmF0aW9ucyIsImJhY2t1cEVuYWJsZWQiLCJfY3JlYXRlQ2xhc3MiLCJrZXkiLCJ2YWx1ZSIsInJlZ2lzdGVyIiwibWlncmF0aW9uIiwiY29uZmxpY3QiLCJmaW5kIiwibSIsImZyb21WZXJzaW9uIiwidG9WZXJzaW9uIiwiY29uc29sZSIsIndhcm4iLCJuYW1lIiwicHVzaCIsInNvcnQiLCJhIiwiYiIsIl9taWdyYXRlIiwiX2FzeW5jVG9HZW5lcmF0b3IiLCJkYXRhIiwiX3RoaXMiLCJzdWNjZXNzIiwiY3VycmVudERhdGEiLCJjdXJyZW50VmVyc2lvbiIsInNhdmVCYWNrdXAiLCJfbG9vcCIsIm5leHRWZXJzaW9uIiwiRXJyb3IiLCJsb2ciLCJtaWdyYXRlIiwidmVyc2lvbiIsIm1pZ3JhdGVkQXQiLCJEYXRlIiwibm93IiwibWlncmF0ZWRGcm9tIiwiZXJyb3IiLCJTdHJpbmciLCJfeCIsIl94MiIsIl94MyIsImFwcGx5IiwiYXJndW1lbnRzIiwiX3JvbGxiYWNrIiwiX3RoaXMyIiwiX2xvb3AyIiwicHJldlZlcnNpb24iLCJyb2xsYmFjayIsIl94NCIsIl94NSIsIl94NiIsIl9zYXZlQmFja3VwIiwiYmFja3VwS2V5Iiwic2V0SXRlbSIsIkpTT04iLCJzdHJpbmdpZnkiLCJrZXlzIiwiZ2V0QWxsS2V5cyIsImJhY2t1cEtleXMiLCJmaWx0ZXIiLCJrIiwic3RhcnRzV2l0aCIsImxlbmd0aCIsImtleXNUb1JlbW92ZSIsInNsaWNlIiwibXVsdGlSZW1vdmUiLCJfeDciLCJfeDgiLCJnZXRNaWdyYXRpb25zIiwiX3RvQ29uc3VtYWJsZUFycmF5Iiwic2V0QmFja3VwRW5hYmxlZCIsImVuYWJsZWQiXSwic291cmNlcyI6WyJtaWdyYXRpb25NYW5hZ2VyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICog0JzQtdC90LXQtNC20LXRgCDQvNC40LPRgNCw0YbQuNC5INC00LDQvdC90YvRhVxuICogXG4gKiDQo9C/0YDQsNCy0LvRj9C10YIg0LzQuNCz0YDQsNGG0LjRj9C80Lgg0LzQtdC20LTRgyDQstC10YDRgdC40Y/QvNC4INC00LDQvdC90YvRhVxuICovXG5cbmltcG9ydCBBc3luY1N0b3JhZ2UgZnJvbSAnQHJlYWN0LW5hdGl2ZS1hc3luYy1zdG9yYWdlL2FzeW5jLXN0b3JhZ2UnO1xuaW1wb3J0IHsgTWlncmF0aW9uLCBNaWdyYXRpb25SZXN1bHQgfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIE1pZ3JhdGlvbk1hbmFnZXIge1xuICBwcml2YXRlIG1pZ3JhdGlvbnM6IE1pZ3JhdGlvbltdID0gW107XG4gIHByaXZhdGUgYmFja3VwRW5hYmxlZDogYm9vbGVhbiA9IHRydWU7XG5cbiAgLyoqXG4gICAqINCX0LDRgNC10LPQuNGB0YLRgNC40YDQvtCy0LDRgtGMINC80LjQs9GA0LDRhtC40Y5cbiAgICovXG4gIHJlZ2lzdGVyKG1pZ3JhdGlvbjogTWlncmF0aW9uKTogdm9pZCB7XG4gICAgLy8g0J/RgNC+0LLQtdGA0Y/QtdC8INGH0YLQviDQvdC10YIg0LrQvtC90YTQu9C40LrRgtC+0LJcbiAgICBjb25zdCBjb25mbGljdCA9IHRoaXMubWlncmF0aW9ucy5maW5kKFxuICAgICAgbSA9PiBtLmZyb21WZXJzaW9uID09PSBtaWdyYXRpb24uZnJvbVZlcnNpb24gJiYgbS50b1ZlcnNpb24gPT09IG1pZ3JhdGlvbi50b1ZlcnNpb25cbiAgICApO1xuICAgIFxuICAgIGlmIChjb25mbGljdCkge1xuICAgICAgY29uc29sZS53YXJuKGBbTWlncmF0aW9uTWFuYWdlcl0gTWlncmF0aW9uIGNvbmZsaWN0OiAke21pZ3JhdGlvbi5uYW1lfSBjb25mbGljdHMgd2l0aCAke2NvbmZsaWN0Lm5hbWV9YCk7XG4gICAgfVxuICAgIFxuICAgIHRoaXMubWlncmF0aW9ucy5wdXNoKG1pZ3JhdGlvbik7XG4gICAgLy8g0KHQvtGA0YLQuNGA0YPQtdC8INC/0L4g0LLQtdGA0YHQuNGP0LxcbiAgICB0aGlzLm1pZ3JhdGlvbnMuc29ydCgoYSwgYikgPT4gYS5mcm9tVmVyc2lvbiAtIGIuZnJvbVZlcnNpb24pO1xuICB9XG5cbiAgLyoqXG4gICAqINCS0YvQv9C+0LvQvdC40YLRjCDQvNC40LPRgNCw0YbQuNGOINC00LDQvdC90YvRhVxuICAgKi9cbiAgYXN5bmMgbWlncmF0ZShcbiAgICBkYXRhOiBhbnksXG4gICAgZnJvbVZlcnNpb246IG51bWJlcixcbiAgICB0b1ZlcnNpb246IG51bWJlclxuICApOiBQcm9taXNlPE1pZ3JhdGlvblJlc3VsdD4ge1xuICAgIGlmIChmcm9tVmVyc2lvbiA+PSB0b1ZlcnNpb24pIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGEsXG4gICAgICAgIGZyb21WZXJzaW9uLFxuICAgICAgICB0b1ZlcnNpb24sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGxldCBjdXJyZW50RGF0YSA9IGRhdGE7XG4gICAgbGV0IGN1cnJlbnRWZXJzaW9uID0gZnJvbVZlcnNpb247XG5cbiAgICB0cnkge1xuICAgICAgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INGA0LXQt9C10YDQstC90YPRjiDQutC+0L/QuNGOINC/0LXRgNC10LQg0LzQuNCz0YDQsNGG0LjQtdC5XG4gICAgICBpZiAodGhpcy5iYWNrdXBFbmFibGVkKSB7XG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZUJhY2t1cChjdXJyZW50RGF0YSwgY3VycmVudFZlcnNpb24pO1xuICAgICAgfVxuXG4gICAgICAvLyDQktGL0L/QvtC70L3Rj9C10Lwg0LzQuNCz0YDQsNGG0LjQuCDQv9C+0YjQsNCz0L7QstC+XG4gICAgICB3aGlsZSAoY3VycmVudFZlcnNpb24gPCB0b1ZlcnNpb24pIHtcbiAgICAgICAgY29uc3QgbmV4dFZlcnNpb24gPSBjdXJyZW50VmVyc2lvbiArIDE7XG4gICAgICAgIGNvbnN0IG1pZ3JhdGlvbiA9IHRoaXMubWlncmF0aW9ucy5maW5kKFxuICAgICAgICAgIG0gPT4gbS5mcm9tVmVyc2lvbiA9PT0gY3VycmVudFZlcnNpb24gJiYgbS50b1ZlcnNpb24gPT09IG5leHRWZXJzaW9uXG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKCFtaWdyYXRpb24pIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICBgTm8gbWlncmF0aW9uIGZvdW5kIGZyb20gdmVyc2lvbiAke2N1cnJlbnRWZXJzaW9ufSB0byAke25leHRWZXJzaW9ufWBcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coYFtNaWdyYXRpb25NYW5hZ2VyXSBNaWdyYXRpbmcgZnJvbSAke2N1cnJlbnRWZXJzaW9ufSB0byAke25leHRWZXJzaW9ufTogJHttaWdyYXRpb24ubmFtZX1gKTtcblxuICAgICAgICAvLyDQktGL0L/QvtC70L3Rj9C10Lwg0LzQuNCz0YDQsNGG0LjRjlxuICAgICAgICBjdXJyZW50RGF0YSA9IGF3YWl0IG1pZ3JhdGlvbi5taWdyYXRlKGN1cnJlbnREYXRhKTtcbiAgICAgICAgY3VycmVudFZlcnNpb24gPSBtaWdyYXRpb24udG9WZXJzaW9uO1xuXG4gICAgICAgIC8vINCe0LHQvdC+0LLQu9GP0LXQvCDQstC10YDRgdC40Y4g0LIg0LTQsNC90L3Ri9GFXG4gICAgICAgIGlmIChjdXJyZW50RGF0YSAmJiB0eXBlb2YgY3VycmVudERhdGEgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgY3VycmVudERhdGEudmVyc2lvbiA9IGN1cnJlbnRWZXJzaW9uO1xuICAgICAgICAgIGN1cnJlbnREYXRhLm1pZ3JhdGVkQXQgPSBEYXRlLm5vdygpO1xuICAgICAgICAgIGN1cnJlbnREYXRhLm1pZ3JhdGVkRnJvbSA9IG1pZ3JhdGlvbi5mcm9tVmVyc2lvbjtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBjdXJyZW50RGF0YSxcbiAgICAgICAgZnJvbVZlcnNpb24sXG4gICAgICAgIHRvVmVyc2lvbjogY3VycmVudFZlcnNpb24sXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdbTWlncmF0aW9uTWFuYWdlcl0gTWlncmF0aW9uIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZGF0YTogY3VycmVudERhdGEsXG4gICAgICAgIGZyb21WZXJzaW9uLFxuICAgICAgICB0b1ZlcnNpb246IGN1cnJlbnRWZXJzaW9uLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog0J7RgtC60LDRgtC40YLRjCDQvNC40LPRgNCw0YbQuNGOXG4gICAqL1xuICBhc3luYyByb2xsYmFjayhcbiAgICBkYXRhOiBhbnksXG4gICAgZnJvbVZlcnNpb246IG51bWJlcixcbiAgICB0b1ZlcnNpb246IG51bWJlclxuICApOiBQcm9taXNlPE1pZ3JhdGlvblJlc3VsdD4ge1xuICAgIGlmIChmcm9tVmVyc2lvbiA8PSB0b1ZlcnNpb24pIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGEsXG4gICAgICAgIGZyb21WZXJzaW9uLFxuICAgICAgICB0b1ZlcnNpb24sXG4gICAgICB9O1xuICAgIH1cblxuICAgIGxldCBjdXJyZW50RGF0YSA9IGRhdGE7XG4gICAgbGV0IGN1cnJlbnRWZXJzaW9uID0gZnJvbVZlcnNpb247XG5cbiAgICB0cnkge1xuICAgICAgLy8g0JLRi9C/0L7Qu9C90Y/QtdC8INC+0YLQutCw0YIg0L/QvtGI0LDQs9C+0LLQvlxuICAgICAgd2hpbGUgKGN1cnJlbnRWZXJzaW9uID4gdG9WZXJzaW9uKSB7XG4gICAgICAgIGNvbnN0IHByZXZWZXJzaW9uID0gY3VycmVudFZlcnNpb24gLSAxO1xuICAgICAgICBjb25zdCBtaWdyYXRpb24gPSB0aGlzLm1pZ3JhdGlvbnMuZmluZChcbiAgICAgICAgICBtID0+IG0uZnJvbVZlcnNpb24gPT09IHByZXZWZXJzaW9uICYmIG0udG9WZXJzaW9uID09PSBjdXJyZW50VmVyc2lvblxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghbWlncmF0aW9uIHx8ICFtaWdyYXRpb24ucm9sbGJhY2spIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICBgTm8gcm9sbGJhY2sgZm91bmQgZnJvbSB2ZXJzaW9uICR7Y3VycmVudFZlcnNpb259IHRvICR7cHJldlZlcnNpb259YFxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zb2xlLmxvZyhgW01pZ3JhdGlvbk1hbmFnZXJdIFJvbGxpbmcgYmFjayBmcm9tICR7Y3VycmVudFZlcnNpb259IHRvICR7cHJldlZlcnNpb259OiAke21pZ3JhdGlvbi5uYW1lfWApO1xuXG4gICAgICAgIC8vINCS0YvQv9C+0LvQvdGP0LXQvCDQvtGC0LrQsNGCXG4gICAgICAgIGN1cnJlbnREYXRhID0gYXdhaXQgbWlncmF0aW9uLnJvbGxiYWNrKGN1cnJlbnREYXRhKTtcbiAgICAgICAgY3VycmVudFZlcnNpb24gPSBwcmV2VmVyc2lvbjtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogY3VycmVudERhdGEsXG4gICAgICAgIGZyb21WZXJzaW9uLFxuICAgICAgICB0b1ZlcnNpb246IGN1cnJlbnRWZXJzaW9uLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW01pZ3JhdGlvbk1hbmFnZXJdIFJvbGxiYWNrIGZhaWxlZDonLCBlcnJvcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZGF0YTogY3VycmVudERhdGEsXG4gICAgICAgIGZyb21WZXJzaW9uLFxuICAgICAgICB0b1ZlcnNpb246IGN1cnJlbnRWZXJzaW9uLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLFxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICog0KHQvtGF0YDQsNC90LjRgtGMINGA0LXQt9C10YDQstC90YPRjiDQutC+0L/QuNGOXG4gICAqL1xuICBwcml2YXRlIGFzeW5jIHNhdmVCYWNrdXAoZGF0YTogYW55LCB2ZXJzaW9uOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgYmFja3VwS2V5ID0gYEBiYWNrdXBfdiR7dmVyc2lvbn1fJHtEYXRlLm5vdygpfWA7XG4gICAgICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbShiYWNrdXBLZXksIEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcbiAgICAgIFxuICAgICAgLy8g0J7Qs9GA0LDQvdC40YfQuNCy0LDQtdC8INC60L7Qu9C40YfQtdGB0YLQstC+INGA0LXQt9C10YDQstC90YvRhSDQutC+0L/QuNC5ICjQv9C+0YHQu9C10LTQvdC40LUgNSlcbiAgICAgIGNvbnN0IGtleXMgPSBhd2FpdCBBc3luY1N0b3JhZ2UuZ2V0QWxsS2V5cygpO1xuICAgICAgY29uc3QgYmFja3VwS2V5cyA9IGtleXMuZmlsdGVyKGsgPT4gay5zdGFydHNXaXRoKCdAYmFja3VwXycpKS5zb3J0KCk7XG4gICAgICBpZiAoYmFja3VwS2V5cy5sZW5ndGggPiA1KSB7XG4gICAgICAgIGNvbnN0IGtleXNUb1JlbW92ZSA9IGJhY2t1cEtleXMuc2xpY2UoMCwgYmFja3VwS2V5cy5sZW5ndGggLSA1KTtcbiAgICAgICAgYXdhaXQgQXN5bmNTdG9yYWdlLm11bHRpUmVtb3ZlKGtleXNUb1JlbW92ZSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ1tNaWdyYXRpb25NYW5hZ2VyXSBGYWlsZWQgdG8gc2F2ZSBiYWNrdXA6JywgZXJyb3IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiDQn9C+0LvRg9GH0LjRgtGMINGB0L/QuNGB0L7QuiDQt9Cw0YDQtdCz0LjRgdGC0YDQuNGA0L7QstCw0L3QvdGL0YUg0LzQuNCz0YDQsNGG0LjQuVxuICAgKi9cbiAgZ2V0TWlncmF0aW9ucygpOiBNaWdyYXRpb25bXSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLm1pZ3JhdGlvbnNdO1xuICB9XG5cbiAgLyoqXG4gICAqINCS0LrQu9GO0YfQuNGC0Ywv0LLRi9C60LvRjtGH0LjRgtGMINGA0LXQt9C10YDQstC90YvQtSDQutC+0L/QuNC4XG4gICAqL1xuICBzZXRCYWNrdXBFbmFibGVkKGVuYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLmJhY2t1cEVuYWJsZWQgPSBlbmFibGVkO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7QUFNQSxPQUFPQSxZQUFZLE1BQU0sMkNBQTJDO0FBR3BFLFdBQWFDLGdCQUFnQjtFQUFBLFNBQUFBLGlCQUFBO0lBQUFDLGVBQUEsT0FBQUQsZ0JBQUE7SUFBQSxLQUNuQkUsVUFBVSxHQUFnQixFQUFFO0lBQUEsS0FDNUJDLGFBQWEsR0FBWSxJQUFJO0VBQUE7RUFBQSxPQUFBQyxZQUFBLENBQUFKLGdCQUFBO0lBQUFLLEdBQUE7SUFBQUMsS0FBQSxFQUtyQyxTQUFBQyxRQUFRQSxDQUFDQyxTQUFvQixFQUFRO01BRW5DLElBQU1DLFFBQVEsR0FBRyxJQUFJLENBQUNQLFVBQVUsQ0FBQ1EsSUFBSSxDQUNuQyxVQUFBQyxDQUFDO1FBQUEsT0FBSUEsQ0FBQyxDQUFDQyxXQUFXLEtBQUtKLFNBQVMsQ0FBQ0ksV0FBVyxJQUFJRCxDQUFDLENBQUNFLFNBQVMsS0FBS0wsU0FBUyxDQUFDSyxTQUFTO01BQUEsQ0FD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