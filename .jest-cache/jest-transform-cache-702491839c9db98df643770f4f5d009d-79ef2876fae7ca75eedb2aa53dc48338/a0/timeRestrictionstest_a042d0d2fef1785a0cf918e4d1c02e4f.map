{"version":3,"names":["_timeRestrictions","require","describe","it","restrictions","now","Date","expect","isTimeRestricted","toBe","enabled","dayOfWeek","startHour","startMinute","endHour","endMinute","now1","now2","now3","timestamp","getTime"],"sources":["timeRestrictions.test.ts"],"sourcesContent":["/**\n * Модульные тесты для проверки временных ограничений\n * Только детерминированные тесты - никаких интеграций/асинхронности\n */\n\nimport { isTimeRestricted, TimeRestriction } from '@/utils/timeRestrictions';\n\ndescribe('isTimeRestricted', () => {\n  it('должен возвращать false для пустого массива ограничений', () => {\n    const restrictions: TimeRestriction[] = [];\n    const now = new Date('2024-01-15T14:30:00'); // Понедельник, 14:30\n\n    expect(isTimeRestricted(restrictions, now)).toBe(false);\n  });\n\n  it('должен возвращать false если ограничение отключено', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: false,\n        dayOfWeek: 1, // Понедельник\n        startHour: 9,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const now = new Date('2024-01-15T14:30:00'); // Понедельник, 14:30\n\n    expect(isTimeRestricted(restrictions, now)).toBe(false);\n  });\n\n  it('должен возвращать false если день недели не совпадает', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 2, // Вторник\n        startHour: 9,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const now = new Date('2024-01-15T14:30:00'); // Понедельник (day 1), 14:30\n\n    expect(isTimeRestricted(restrictions, now)).toBe(false);\n  });\n\n  it('должен возвращать true если время до начала разрешенного периода', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 1, // Понедельник\n        startHour: 9,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const now = new Date('2024-01-15T08:30:00'); // Понедельник, 08:30 (до 9:00)\n\n    expect(isTimeRestricted(restrictions, now)).toBe(true);\n  });\n\n  it('должен возвращать false если время в разрешенном периоде', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 1, // Понедельник\n        startHour: 9,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const now = new Date('2024-01-15T14:30:00'); // Понедельник, 14:30 (между 9:00 и 17:00)\n\n    expect(isTimeRestricted(restrictions, now)).toBe(false);\n  });\n\n  it('должен возвращать true если время после окончания разрешенного периода', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 1, // Понедельник\n        startHour: 9,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const now = new Date('2024-01-15T18:30:00'); // Понедельник, 18:30 (после 17:00)\n\n    expect(isTimeRestricted(restrictions, now)).toBe(true);\n  });\n\n  it('должен возвращать false если время равно началу периода (граничный случай)', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 1,\n        startHour: 9,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const now = new Date('2024-01-15T09:00:00'); // Ровно 9:00\n\n    // Время в разрешенном периоде: startTime <= currentTime < endTime\n    // 540 >= 540 && 540 < 1020 = true && true = true (разрешен)\n    expect(isTimeRestricted(restrictions, now)).toBe(false);\n  });\n\n  it('должен возвращать true если время равно концу периода (граничный случай)', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 1,\n        startHour: 9,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const now = new Date('2024-01-15T17:00:00'); // Ровно 17:00\n\n    // currentTime >= endTime (1020 >= 1020 = true)\n    expect(isTimeRestricted(restrictions, now)).toBe(true);\n  });\n\n  it('должен работать с несколькими ограничениями (возвращает true если хотя бы одно активно)', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 1,\n        startHour: 9,\n        startMinute: 0,\n        endHour: 12,\n        endMinute: 0,\n      },\n      {\n        enabled: true,\n        dayOfWeek: 1,\n        startHour: 13,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const now1 = new Date('2024-01-15T11:00:00'); // 11:00 - в первом разрешенном периоде\n    const now2 = new Date('2024-01-15T12:30:00'); // 12:30 - между периодами (ограничено)\n    const now3 = new Date('2024-01-15T15:00:00'); // 15:00 - во втором разрешенном периоде\n\n    expect(isTimeRestricted(restrictions, now1)).toBe(false);\n    expect(isTimeRestricted(restrictions, now2)).toBe(true);\n    expect(isTimeRestricted(restrictions, now3)).toBe(false);\n  });\n\n  it('должен работать с timestamp вместо Date объекта', () => {\n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 1,\n        startHour: 9,\n        startMinute: 0,\n        endHour: 17,\n        endMinute: 0,\n      },\n    ];\n    const timestamp = new Date('2024-01-15T14:30:00').getTime();\n\n    expect(isTimeRestricted(restrictions, timestamp)).toBe(false);\n  });\n\n  it('должен правильно обрабатывать полночь (переход через день - ограничение реализации)', () => {\n    // Примечание: текущая реализация не поддерживает переход через полночь\n    // Если endTime < startTime (например, 22:00-02:00), это означает переход через полночь\n    // Текущая логика проверяет только текущий день и не обрабатывает этот случай\n    // Для полноценной поддержки нужна более сложная логика с проверкой следующего дня\n    \n    const restrictions: TimeRestriction[] = [\n      {\n        enabled: true,\n        dayOfWeek: 1, // Понедельник\n        startHour: 22,\n        startMinute: 0,\n        endHour: 2,\n        endMinute: 0, // До 2:00 следующего дня\n      },\n    ];\n    \n    // Для времени 23:30 понедельника:\n    // startTime = 22*60 = 1320, endTime = 2*60 = 120\n    // Проверка: 1410 >= 1320 && 1410 < 120 = true && false = false (не в периоде)\n    // Но так как endTime < startTime, это означает переход через полночь, который не поддерживается\n    const now1 = new Date('2024-01-15T23:30:00'); // Понедельник, 23:30\n    \n    // Текущая реализация: если endTime < startTime, проверка не работает корректно\n    // Это известное ограничение - для таких случаев нужна отдельная логика\n    expect(isTimeRestricted(restrictions, now1)).toBe(true); // Ограничено из-за ограничения реализации\n    \n    // Для других дней ограничение не применяется\n    const now2 = new Date('2024-01-16T01:30:00'); // Вторник, 01:30 - день недели не совпадает\n    const now3 = new Date('2024-01-16T03:00:00'); // Вторник, 03:00 - день недели не совпадает\n    expect(isTimeRestricted(restrictions, now2)).toBe(false);\n    expect(isTimeRestricted(restrictions, now3)).toBe(false);\n  });\n});\n"],"mappings":"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","ignoreList":[]}