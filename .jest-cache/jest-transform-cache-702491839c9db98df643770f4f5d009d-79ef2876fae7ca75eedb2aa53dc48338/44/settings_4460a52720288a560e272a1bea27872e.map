{"version":3,"names":["z","publicProcedure","createTRPCRouter","supabase","getSettingsInputSchema","rateLimiters","cov_2844h7pchf","s","mergeSettings","serverSettings","clientSettings","f","b","updatedAt","Object","assign","getSettingsFromDB","_ref","_asyncToGenerator","deviceId","Error","_ref2","from","select","eq","single","data","error","code","console","settings_data","_x","apply","arguments","saveSettingsToDB","_ref3","settings","timestamp","Date","now","_ref4","upsert","device_id","updated_at","created_at","onConflict","_x2","_x3","updateSettingsSyncStatus","_ref5","last_settings_sync","_x4","_x5","syncSettingsProcedure","input","object","string","any","optional","lastSyncTimestamp","number","mutation","_ref7","_ref6","_ref8","_ref8$lastSyncTimesta","finalSettings","success","serverTimestamp","message","_x6","getSettingsProcedure","use","sync","query","_ref10","_ref9","_ref11","lastSync","_ref12","_x7","syncSettingsRouter","get"],"sources":["settings.ts"],"sourcesContent":["import { z } from \"zod\";\nimport { publicProcedure, createTRPCRouter } from \"../../create-context.js\";\nimport { supabase } from \"../../../utils/supabase.js\";\nimport { syncSettingsInputSchema, getSettingsInputSchema } from \"../../../utils/validationSchemas.js\";\nimport { rateLimiters } from \"../../middleware/rateLimit.js\";\n\n// Merge настройки (клиентские перезаписывают серверные если новее)\nconst mergeSettings = (serverSettings: any, clientSettings: any): any => {\n  if (!serverSettings) return clientSettings;\n  if (!clientSettings) return serverSettings;\n\n  // Если есть timestamp - используем более свежие\n  if (serverSettings.updatedAt && clientSettings.updatedAt) {\n    return clientSettings.updatedAt > serverSettings.updatedAt ? clientSettings : serverSettings;\n  }\n\n  // Иначе merge (клиентские имеют приоритет для конфликтов)\n  return { ...serverSettings, ...clientSettings };\n};\n\n// Получить настройки из базы данных\nconst getSettingsFromDB = async (deviceId: string): Promise<any | null> => {\n  if (!supabase) {\n    throw new Error(\"Supabase клиент не инициализирован\");\n  }\n\n  const { data, error } = await supabase\n    .from('settings')\n    .select('*')\n    .eq('device_id', deviceId)\n    .single();\n\n  if (error) {\n    if (error.code === 'PGRST116') {\n      // Запись не найдена - это нормально для первого запуска\n      return null;\n    }\n    console.error('[getSettingsFromDB] Error:', error);\n    return null;\n  }\n\n  return data?.settings_data || null;\n};\n\n// Сохранить настройки в базу данных\nconst saveSettingsToDB = async (deviceId: string, settings: any): Promise<void> => {\n  if (!supabase) {\n    throw new Error(\"Supabase клиент не инициализирован\");\n  }\n\n  const timestamp = Date.now();\n\n  const { error } = await supabase\n    .from('settings')\n    .upsert({\n      device_id: deviceId,\n      settings_data: settings,\n      updated_at: timestamp,\n      created_at: timestamp,\n    }, { onConflict: 'device_id' });\n\n  if (error) {\n    console.error('[saveSettingsToDB] Error:', error);\n    throw error;\n  }\n};\n\n// Обновить статус синхронизации настроек\nconst updateSettingsSyncStatus = async (deviceId: string, timestamp: number): Promise<void> => {\n  if (!supabase) {\n    return;\n  }\n\n  await supabase\n    .from('sync_status')\n    .upsert({\n      device_id: deviceId,\n      last_settings_sync: timestamp,\n      updated_at: timestamp,\n    }, { onConflict: 'device_id' });\n};\n\nexport const syncSettingsProcedure = publicProcedure\n  .input(\n    z.object({\n      deviceId: z.string(),\n      settings: z.any().optional(),\n      lastSyncTimestamp: z.number().optional(),\n    })\n  )\n  .mutation(async ({ input }) => {\n    const { deviceId, settings, lastSyncTimestamp = 0 } = input;\n    const timestamp = Date.now();\n\n    try {\n      // Получаем настройки с сервера\n      const serverSettings = await getSettingsFromDB(deviceId);\n\n      let finalSettings = serverSettings || {};\n\n      // Если клиент отправил настройки - объединяем их\n      if (settings) {\n        finalSettings = mergeSettings(serverSettings, settings);\n        finalSettings.updatedAt = timestamp;\n\n        // Сохраняем объединенные настройки в БД\n        await saveSettingsToDB(deviceId, finalSettings);\n      }\n\n      // Обновляем статус синхронизации\n      await updateSettingsSyncStatus(deviceId, timestamp);\n\n      return {\n        success: true,\n        settings: finalSettings,\n        lastSyncTimestamp: timestamp,\n        serverTimestamp: timestamp,\n      };\n    } catch (error) {\n      console.error('[syncSettingsProcedure] Error:', error);\n      return {\n        success: false,\n        error: error instanceof Error ? error.message : 'Unknown error',\n        settings: {},\n        lastSyncTimestamp: timestamp,\n        serverTimestamp: timestamp,\n      };\n    }\n  });\n\nexport const getSettingsProcedure = publicProcedure\n  .use(rateLimiters.sync)\n  .input(getSettingsInputSchema)\n  .query(async ({ input }) => {\n    const { deviceId } = input;\n    const timestamp = Date.now();\n\n    try {\n      const settings = await getSettingsFromDB(deviceId);\n\n      // Получаем статус синхронизации для lastSyncTimestamp\n      let lastSync = 0;\n      if (supabase) {\n        const { data } = await supabase\n          .from('sync_status')\n          .select('last_settings_sync')\n          .eq('device_id', deviceId)\n          .single();\n\n        if (data?.last_settings_sync) {\n          lastSync = data.last_settings_sync;\n        }\n      }\n\n      return {\n        settings: settings || {},\n        lastSyncTimestamp: lastSync,\n        serverTimestamp: timestamp,\n      };\n    } catch (error) {\n      console.error('[getSettingsProcedure] Error:', error);\n      return {\n        settings: {},\n        lastSyncTimestamp: 0,\n        serverTimestamp: timestamp,\n      };\n    }\n  });\n\nexport const syncSettingsRouter = createTRPCRouter({\n  sync: syncSettingsProcedure,\n  get: getSettingsProcedure,\n});\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}