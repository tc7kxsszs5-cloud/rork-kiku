{"version":3,"names":["createContextHook","AsyncStorage","Notifications","Constants","Platform","useCallback","useEffect","useMemo","useRef","useState","trpc","useUser","setupNotificationChannels","isUuid","cov_1gw2js9sba","s","setNotificationHandler","handleNotification","_handleNotification","_asyncToGenerator","f","shouldShowAlert","shouldPlaySound","shouldSetBadge","shouldShowBanner","shouldShowList","apply","arguments","DEVICE_ID_STORAGE_KEY","PUSH_TOKEN_STORAGE_KEY","createDeviceId","Date","now","Math","random","toString","slice","resolveExpoProjectId","_ref","_ref2","_ref3","_Constants$expoConfig","_easConfig","_Constants$expoConfig2","candidate","b","_env","EXPO_PUBLIC_PROJECT_ID","expoConfig","extra","eas","projectId","easConfig","undefined","_ref4","_ref23","_ref6","user","_ref7","_ref8","_slicedToArray","deviceId","setDeviceId","_ref9","_ref10","expoPushToken","setExpoPushToken","_ref11","_ref12","permissionStatus","setPermissionStatus","_ref13","_ref14","isRegistering","setIsRegistering","_ref15","_ref16","isRunningDiagnostics","setIsRunningDiagnostics","_ref17","_ref18","lastError","setLastError","_ref19","_ref20","lastDiagnostics","setLastDiagnostics","autoSyncAttemptedRef","isSupported","OS","deviceLabel","_ref21","deviceName","registerMutation","notifications","registerDevice","useMutation","onError","error","console","logTestMutation","logDeviceTest","_ref22","getSyncStatus","useQuery","enabled","Boolean","staleTime","retry","refetchOnMount","refetchOnWindowFocus","syncData","data","refetchSyncStatus","refetch","isSyncing","isFetching","syncError","serverRecord","device","ensureDeviceId","stored","getItem","generated","setItem","isMounted","bootstrap","_ref25","storedId","resolvedId","storedToken","permissions","getPermissionsAsync","status","performRegistration","_ref26","requestPermissions","resolvedDeviceId","warn","permissionRequest","requestPermissionsAsync","tokenResponse","getExpoPushTokenAsync","platformValue","_Constants$expoConfig3","mutateAsync","pushToken","platform","appVersion","version","userId","id","mutationError","refetchError","_x","current","catch","refreshStatus","runDiagnostics","Error","tests","push","type","message","timestamp","lastSyncedAt","scheduleNotificationAsync","content","title","body","trigger","results","logError","_ref30","testResults","_ref5","NotificationsProvider","useNotifications"],"sources":["NotificationsContext.tsx"],"sourcesContent":["import createContextHook from '@nkzw/create-context-hook';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport * as Notifications from 'expo-notifications';\nimport Constants from 'expo-constants';\nimport { Platform } from 'react-native';\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'react';\nimport { trpc } from '@/lib/trpc';\nimport { NotificationDeviceRecord, NotificationTestResult } from './types';\nimport { useUser } from './UserContext';\nimport { setupNotificationChannels } from '@/utils/soundNotifications';\nimport { isUuid } from '@/utils/validation';\n\nNotifications.setNotificationHandler({\n  handleNotification: async () => ({\n    shouldShowAlert: true,\n    shouldPlaySound: true,\n    shouldSetBadge: false,\n    shouldShowBanner: true,\n    shouldShowList: true,\n  }),\n});\n\nconst DEVICE_ID_STORAGE_KEY = '@kids_device_id';\nconst PUSH_TOKEN_STORAGE_KEY = '@kids_push_token';\n\nconst createDeviceId = () => `device_${Date.now()}_${Math.random().toString(36).slice(2, 10)}`;\n\nconst resolveExpoProjectId = (): string | undefined => {\n  const candidate =\n    process.env.EXPO_PUBLIC_PROJECT_ID ??\n    (Constants.expoConfig as any)?.extra?.eas?.projectId ??\n    (Constants as any)?.easConfig?.projectId ??\n    (Constants.expoConfig as any)?.extra?.projectId;\n\n  return isUuid(candidate) ? candidate : undefined;\n};\n\nexport type PushPermissionState = Notifications.PermissionStatus | 'unavailable' | 'undetermined';\n\nexport interface NotificationsContextValue {\n  deviceId: string | null;\n  permissionStatus: PushPermissionState;\n  expoPushToken: string | null;\n  isRegistering: boolean;\n  isRunningDiagnostics: boolean;\n  lastError: string | null;\n  serverRecord: NotificationDeviceRecord | null;\n  lastDiagnostics: NotificationTestResult[];\n  registerDevice: () => Promise<void>;\n  refreshStatus: () => Promise<void>;\n  runDiagnostics: () => Promise<NotificationTestResult[]>;\n  isSupported: boolean;\n  isSyncing: boolean;\n}\n\nexport const [NotificationsProvider, useNotifications] = createContextHook<NotificationsContextValue>(() => {\n  const { user } = useUser();\n  const [deviceId, setDeviceId] = useState<string | null>(null);\n  const [expoPushToken, setExpoPushToken] = useState<string | null>(null);\n  const [permissionStatus, setPermissionStatus] = useState<PushPermissionState>(() => 'undetermined');\n  const [isRegistering, setIsRegistering] = useState(false);\n  const [isRunningDiagnostics, setIsRunningDiagnostics] = useState(false);\n  const [lastError, setLastError] = useState<string | null>(null);\n  const [lastDiagnostics, setLastDiagnostics] = useState<NotificationTestResult[]>([]);\n  const autoSyncAttemptedRef = useRef(false);\n  const isSupported = Platform.OS !== 'web';\n  const deviceLabel = useMemo(() => Constants.deviceName ?? Platform.OS, []);\n\n  const registerMutation = trpc.notifications.registerDevice.useMutation({\n    onError: (error) => {\n      console.error('[NotificationsContext] Register mutation error (ignored):', error);\n    },\n  });\n  const logTestMutation = trpc.notifications.logDeviceTest.useMutation({\n    onError: (error) => {\n      console.error('[NotificationsContext] Log test mutation error (ignored):', error);\n    },\n  });\n  const {\n    data: syncData,\n    refetch: refetchSyncStatus,\n    isFetching: isSyncing,\n    error: syncError,\n  } = trpc.notifications.getSyncStatus.useQuery(deviceId ? { deviceId } : undefined, {\n    enabled: Boolean(deviceId) && isSupported,\n    staleTime: 15_000,\n    retry: false,\n    refetchOnMount: false,\n    refetchOnWindowFocus: false,\n  });\n\n  useEffect(() => {\n    if (syncError) {\n      console.error('[NotificationsContext] Sync status query error (ignored):', syncError);\n    }\n  }, [syncError]);\n\n  const serverRecord = syncData?.device ?? null;\n\n  const ensureDeviceId = useCallback(async () => {\n    if (deviceId) {\n      return deviceId;\n    }\n    const stored = await AsyncStorage.getItem(DEVICE_ID_STORAGE_KEY);\n    if (stored) {\n      setDeviceId(stored);\n      return stored;\n    }\n    const generated = createDeviceId();\n    await AsyncStorage.setItem(DEVICE_ID_STORAGE_KEY, generated);\n    setDeviceId(generated);\n    return generated;\n  }, [deviceId]);\n\n  useEffect(() => {\n    let isMounted = true;\n    const bootstrap = async () => {\n      try {\n        const storedId = await AsyncStorage.getItem(DEVICE_ID_STORAGE_KEY);\n        let resolvedId = storedId;\n        if (!storedId) {\n          resolvedId = createDeviceId();\n          await AsyncStorage.setItem(DEVICE_ID_STORAGE_KEY, resolvedId);\n        }\n        if (isMounted && resolvedId) {\n          setDeviceId(resolvedId);\n        }\n\n        const storedToken = await AsyncStorage.getItem(PUSH_TOKEN_STORAGE_KEY);\n        if (isMounted && storedToken) {\n          setExpoPushToken(storedToken);\n        }\n\n        if (!isSupported) {\n          setPermissionStatus('unavailable');\n          return;\n        }\n\n        const permissions = await Notifications.getPermissionsAsync();\n        if (isMounted) {\n          setPermissionStatus(permissions.status);\n        }\n      } catch (error) {\n        console.error('[NotificationsContext] Bootstrap error', error);\n        if (isMounted) {\n          setLastError('Не удалось инициализировать уведомления');\n        }\n      }\n    };\n\n    bootstrap();\n\n    return () => {\n      isMounted = false;\n    };\n  }, [isSupported]);\n\n  const performRegistration = useCallback(\n    async (requestPermissions: boolean) => {\n      if (!isSupported) {\n        setPermissionStatus('unavailable');\n        setLastError(null);\n        return;\n      }\n\n      const resolvedDeviceId = await ensureDeviceId();\n      const projectId = resolveExpoProjectId();\n      if (!projectId) {\n        console.warn('[NotificationsContext] Push notifications disabled: missing Expo projectId');\n        setLastError(null);\n        return;\n      }\n\n      setIsRegistering(true);\n      setLastError(null);\n\n      try {\n        let permissions = await Notifications.getPermissionsAsync();\n        let status = permissions.status;\n        if (status !== 'granted' && requestPermissions) {\n          const permissionRequest = await Notifications.requestPermissionsAsync();\n          status = permissionRequest.status;\n        }\n        setPermissionStatus(status);\n        if (status !== 'granted') {\n          setLastError(null);\n          return;\n        }\n\n        // Настройка каналов уведомлений с поддержкой звуков\n        if (Platform.OS === 'android') {\n          await setupNotificationChannels();\n        }\n\n        const tokenResponse = await Notifications.getExpoPushTokenAsync({ projectId });\n        setExpoPushToken(tokenResponse.data);\n        await AsyncStorage.setItem(PUSH_TOKEN_STORAGE_KEY, tokenResponse.data);\n\n        const platformValue: 'ios' | 'android' | 'web' = Platform.OS === 'ios'\n          ? 'ios'\n          : Platform.OS === 'android'\n            ? 'android'\n            : 'web';\n\n        try {\n          await registerMutation.mutateAsync({\n            deviceId: resolvedDeviceId,\n            pushToken: tokenResponse.data,\n            platform: platformValue,\n            appVersion: Constants.expoConfig?.version,\n            userId: user?.id,\n            permissions: status,\n          });\n        } catch (mutationError) {\n          console.error('[NotificationsContext] Register mutation failed (ignored):', mutationError);\n        }\n\n        try {\n          await refetchSyncStatus();\n        } catch (refetchError) {\n          console.error('[NotificationsContext] Refetch sync status failed (ignored):', refetchError);\n        }\n      } catch (error) {\n        console.error('[NotificationsContext] Registration error (ignored)', error);\n        setLastError(null);\n      } finally {\n        setIsRegistering(false);\n      }\n    },\n    [ensureDeviceId, isSupported, refetchSyncStatus, registerMutation, user?.id],\n  );\n\n  useEffect(() => {\n    if (!isSupported || !deviceId || permissionStatus !== 'granted' || autoSyncAttemptedRef.current) {\n      return;\n    }\n\n    if (!resolveExpoProjectId()) {\n      autoSyncAttemptedRef.current = true;\n      console.warn('[NotificationsContext] Auto registration skipped: missing Expo projectId');\n      return;\n    }\n\n    autoSyncAttemptedRef.current = true;\n    performRegistration(false).catch((error) => {\n      console.error('[NotificationsContext] Auto registration failed (ignored)', error);\n    });\n  }, [deviceId, isSupported, permissionStatus, performRegistration]);\n\n  const refreshStatus = useCallback(async () => {\n    if (!deviceId || !isSupported) {\n      return;\n    }\n    try {\n      await refetchSyncStatus();\n    } catch (error) {\n      console.error('[NotificationsContext] Refresh status failed (ignored):', error);\n    }\n  }, [deviceId, isSupported, refetchSyncStatus]);\n\n  const registerDevice = useCallback(async () => {\n    autoSyncAttemptedRef.current = true;\n    await performRegistration(true);\n  }, [performRegistration]);\n\n  const runDiagnostics = useCallback(async () => {\n    if (!deviceId) {\n      throw new Error('Идентификатор устройства не готов');\n    }\n\n    setIsRunningDiagnostics(true);\n    const now = Date.now();\n    const tests: NotificationTestResult[] = [];\n\n    tests.push({\n      id: `perm_${now}`,\n      type: 'permissions',\n      status: permissionStatus === 'granted' ? 'passed' : 'failed',\n      message:\n        permissionStatus === 'granted'\n          ? 'Разрешение на уведомления выдано'\n          : 'Разрешение на уведомления отсутствует',\n      timestamp: now,\n      deviceLabel,\n    });\n\n    tests.push({\n      id: `token_${now + 1}`,\n      type: 'token',\n      status: expoPushToken ? 'passed' : 'failed',\n      message: expoPushToken ? 'Expo push токен получен' : 'Expo push токен отсутствует',\n      timestamp: now + 1,\n      deviceLabel,\n    });\n\n    tests.push({\n      id: `sync_${now + 2}`,\n      type: 'sync',\n      status: serverRecord?.lastSyncedAt ? 'passed' : 'failed',\n      message: serverRecord?.lastSyncedAt ? 'Сервер синхронизирован' : 'Нет данных синхронизации на сервере',\n      timestamp: now + 2,\n      deviceLabel,\n    });\n\n    if (!isSupported) {\n      tests.push({\n        id: `delivery_${now + 3}`,\n        type: 'delivery',\n        status: 'failed',\n        message: 'Веб-платформа не поддерживает локальные уведомления',\n        timestamp: now + 3,\n        deviceLabel,\n      });\n    } else {\n      try {\n        await Notifications.scheduleNotificationAsync({\n          content: {\n            title: 'Тестовое уведомление KIDS',\n            body: 'Проверка доставки уведомлений',\n            data: { type: 'diagnostic' },\n          },\n          trigger: null,\n        });\n        tests.push({\n          id: `delivery_${now + 3}`,\n          type: 'delivery',\n          status: 'passed',\n          message: 'Локальное уведомление успешно запланировано',\n          timestamp: now + 3,\n          deviceLabel,\n        });\n      } catch (error) {\n        console.error('[NotificationsContext] Delivery test failed', error);\n        tests.push({\n          id: `delivery_${now + 3}`,\n          type: 'delivery',\n          status: 'failed',\n          message: 'Не удалось запланировать локальное уведомление',\n          timestamp: now + 3,\n          deviceLabel,\n        });\n      }\n    }\n\n    try {\n      try {\n        await logTestMutation.mutateAsync({\n          deviceId,\n          results: tests,\n        });\n      } catch (logError) {\n        console.error('[NotificationsContext] Log test mutation failed (ignored):', logError);\n      }\n      setLastDiagnostics(tests);\n      try {\n        await refetchSyncStatus();\n      } catch (refetchError) {\n        console.error('[NotificationsContext] Refetch after diagnostics failed (ignored):', refetchError);\n      }\n      return tests;\n    } finally {\n      setIsRunningDiagnostics(false);\n    }\n  }, [deviceId, deviceLabel, expoPushToken, isSupported, logTestMutation, permissionStatus, refetchSyncStatus, serverRecord?.lastSyncedAt]);\n\n  return useMemo(\n    () => ({\n      deviceId,\n      permissionStatus,\n      expoPushToken,\n      isRegistering,\n      isRunningDiagnostics,\n      lastError,\n      serverRecord,\n      lastDiagnostics: serverRecord?.testResults ?? lastDiagnostics,\n      registerDevice,\n      refreshStatus,\n      runDiagnostics,\n      isSupported,\n      isSyncing,\n    }),\n    [\n      deviceId,\n      expoPushToken,\n      isRegistering,\n      isRunningDiagnostics,\n      lastDiagnostics,\n      lastError,\n      permissionStatus,\n      registerDevice,\n      refreshStatus,\n      runDiagnostics,\n      serverRecord,\n      isSupported,\n      isSyncing,\n    ],\n  );\n});\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,O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","ignoreList":[]}