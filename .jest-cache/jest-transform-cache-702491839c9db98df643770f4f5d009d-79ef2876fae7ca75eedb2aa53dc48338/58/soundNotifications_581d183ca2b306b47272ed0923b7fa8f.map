{"version":3,"names":["Notifications","Platform","getSoundForRiskLevel","riskLevel","getSoundForSOS","getSoundForRegularNotification","getAndroidPriorityForRiskLevel","AndroidNotificationPriority","MAX","HIGH","DEFAULT","LOW","MIN","setupNotificationChannels","_ref","_asyncToGenerator","OS","setNotificationChannelAsync","name","importance","AndroidImportance","description","sound","vibrationPattern","enableVibrate","enableLights","lightColor","bypassDnd","error","console","apply","arguments","getChannelIdForRiskLevel","createNotificationSoundConfig","channelId","Object","assign"],"sources":["soundNotifications.ts"],"sourcesContent":["/**\n * Утилита для управления звуковыми уведомлениями\n * Поддерживает различные звуки для разных уровней риска и типов уведомлений\n */\n\nimport * as Notifications from 'expo-notifications';\nimport { Platform } from 'react-native';\nimport { RiskLevel } from '@/constants/types';\n\n/**\n * Типы звуков для уведомлений\n */\nexport type NotificationSoundType = \n  | 'default'           // Системный звук по умолчанию\n  | 'alert'            // Звук для обычных алертов\n  | 'warning'          // Звук для предупреждений\n  | 'critical'         // Звук для критических алертов\n  | 'sos'              // Звук для SOS сигналов\n  | 'success'          // Звук для успешных действий\n  | boolean;           // true/false для включения/выключения звука\n\n/**\n * Получает звук для уведомления в зависимости от уровня риска\n */\nexport const getSoundForRiskLevel = (riskLevel: RiskLevel): NotificationSoundType => {\n  switch (riskLevel) {\n    case 'critical':\n      // Критические алерты - всегда со звуком, можно использовать кастомный звук\n      return true; // или 'critical' если добавлен кастомный звук\n    case 'high':\n      // Высокий риск - громкий звук\n      return true;\n    case 'medium':\n      // Средний риск - стандартный звук\n      return 'default';\n    case 'low':\n      // Низкий риск - тихий звук или без звука\n      return 'default';\n    case 'safe':\n    default:\n      // Безопасные сообщения - без звука\n      return false;\n  }\n};\n\n/**\n * Получает звук для SOS уведомлений\n */\nexport const getSoundForSOS = (): NotificationSoundType => {\n  return true; // или 'sos' если добавлен кастомный звук\n};\n\n/**\n * Получает звук для обычных уведомлений\n */\nexport const getSoundForRegularNotification = (): NotificationSoundType => {\n  return 'default';\n};\n\n/**\n * Получает приоритет Android уведомления в зависимости от уровня риска\n */\nexport const getAndroidPriorityForRiskLevel = (riskLevel: RiskLevel): Notifications.AndroidNotificationPriority => {\n  switch (riskLevel) {\n    case 'critical':\n      return Notifications.AndroidNotificationPriority.MAX;\n    case 'high':\n      return Notifications.AndroidNotificationPriority.HIGH;\n    case 'medium':\n      return Notifications.AndroidNotificationPriority.DEFAULT;\n    case 'low':\n      return Notifications.AndroidNotificationPriority.LOW;\n    case 'safe':\n    default:\n      return Notifications.AndroidNotificationPriority.MIN;\n  }\n};\n\n/**\n * Настройка канала уведомлений для Android с поддержкой звуков\n */\nexport const setupNotificationChannels = async (): Promise<void> => {\n  if (Platform.OS !== 'android') {\n    return;\n  }\n\n  try {\n    // Стандартный канал для обычных уведомлений\n    await Notifications.setNotificationChannelAsync('default', {\n      name: 'Стандартные уведомления',\n      importance: Notifications.AndroidImportance.HIGH,\n      description: 'Системные уведомления KIDS',\n      sound: 'default', // Системный звук по умолчанию\n      vibrationPattern: [0, 250, 250, 250],\n      enableVibrate: true,\n      enableLights: true,\n      lightColor: '#FF6B35',\n    });\n\n    // Канал для критических алертов\n    await Notifications.setNotificationChannelAsync('critical', {\n      name: 'Критические алерты',\n      importance: Notifications.AndroidImportance.MAX,\n      description: 'Критические уведомления о безопасности',\n      sound: 'default', // Можно заменить на кастомный звук\n      vibrationPattern: [0, 500, 250, 500, 250, 500],\n      enableVibrate: true,\n      enableLights: true,\n      lightColor: '#F5222D',\n      bypassDnd: true, // Обходит режим \"Не беспокоить\"\n    });\n\n    // Канал для высокого риска\n    await Notifications.setNotificationChannelAsync('high', {\n      name: 'Высокий риск',\n      importance: Notifications.AndroidImportance.HIGH,\n      description: 'Уведомления о высоком риске',\n      sound: 'default',\n      vibrationPattern: [0, 300, 200, 300],\n      enableVibrate: true,\n      enableLights: true,\n      lightColor: '#EF4444',\n    });\n\n    // Канал для SOS сигналов\n    await Notifications.setNotificationChannelAsync('sos', {\n      name: 'SOS сигналы',\n      importance: Notifications.AndroidImportance.MAX,\n      description: 'Экстренные SOS сигналы',\n      sound: 'default', // Можно заменить на кастомный звук\n      vibrationPattern: [0, 1000, 500, 1000],\n      enableVibrate: true,\n      enableLights: true,\n      lightColor: '#F5222D',\n      bypassDnd: true,\n    });\n  } catch (error) {\n    console.error('[SoundNotifications] Failed to setup notification channels:', error);\n  }\n};\n\n/**\n * Получает имя канала для Android в зависимости от уровня риска\n */\nexport const getChannelIdForRiskLevel = (riskLevel: RiskLevel): string => {\n  switch (riskLevel) {\n    case 'critical':\n      return 'critical';\n    case 'high':\n      return 'high';\n    case 'medium':\n    case 'low':\n    case 'safe':\n    default:\n      return 'default';\n  }\n};\n\n/**\n * Вспомогательная функция для создания конфигурации звука уведомления\n */\nexport const createNotificationSoundConfig = (\n  sound: NotificationSoundType,\n  channelId?: string\n): {\n  sound: NotificationSoundType;\n  channelId?: string;\n} => {\n  return {\n    sound,\n    ...(channelId && Platform.OS === 'android' ? { channelId } : {}),\n  };\n};\n"],"mappings":"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","ignoreList":[]}