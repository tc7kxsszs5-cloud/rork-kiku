{"version":3,"names":["analyzeMessageWithRealAI","getAIConfig","logger","DEFAULT_CONFIG","cov_2c2ypyic0p","s","useAdvancedAI","confidenceThreshold","enableImageAnalysis","enableSentimentAnalysis","analyzeMessageWithAI","_x","_analyzeMessageWithAI","apply","arguments","_asyncToGenerator","text","config","length","undefined","b","f","finalConfig","Object","assign","basicAnalysis","analyzeWithRules","riskLevel","aiConfig","provider","apiKey","debug","realAIAnalysis","combineAnalyses","advancedAnalysis","analyzeWithAdvancedHeuristics","error","Error","String","analyzeImageWithAI","_x2","_analyzeImageWithAI","imageUri","blocked","reasons","confidence","basicCheck","analyzeImageWithRules","context","action","normalized","toLowerCase","criticalPatterns","highPatterns","mediumPatterns","pattern","test","categories","_x3","_analyzeWithAdvancedHeuristics","capsRatio","match","isShouting","hasRepeats","hasPhonePattern","hasAddressPattern","hasNegativeEmotions","push","basic","advanced","levels","basicIndex","indexOf","advancedIndex","combinedLevel","combinedReasons","_toConsumableArray","Set","concat","combinedCategories","combinedConfidence","Math","min","riskKeywords","hit","find","keyword","includes"],"sources":["AIModerationService.ts"],"sourcesContent":["import { RiskLevel, RiskAnalysis } from './types';\nimport { analyzeMessageWithRealAI, getAIConfig } from '@/utils/aiService';\nimport { logger } from '@/utils/logger';\n\n/**\n * Расширенный сервис AI модерации\n * Использует комбинацию правил и AI для более точного анализа\n */\n\nexport interface AIModerationConfig {\n  useAdvancedAI: boolean;\n  confidenceThreshold: number;\n  enableImageAnalysis: boolean;\n  enableSentimentAnalysis: boolean;\n}\n\nconst DEFAULT_CONFIG: AIModerationConfig = {\n  useAdvancedAI: true,\n  confidenceThreshold: 0.7,\n  enableImageAnalysis: true,\n  enableSentimentAnalysis: true,\n};\n\n/**\n * Расширенный анализ сообщения с использованием AI\n */\nexport async function analyzeMessageWithAI(\n  text: string,\n  config: Partial<AIModerationConfig> = {}\n): Promise<RiskAnalysis> {\n  const finalConfig = { ...DEFAULT_CONFIG, ...config };\n\n  // Базовая проверка на ключевые слова (быстрая)\n  const basicAnalysis = analyzeWithRules(text);\n\n  // Если базовый анализ показал критический риск, возвращаем сразу\n  if (basicAnalysis.riskLevel === 'critical') {\n    return basicAnalysis;\n  }\n\n  // Если включен расширенный AI анализ\n  if (finalConfig.useAdvancedAI) {\n    try {\n      // Используем реальный AI API если настроен\n      const aiConfig = getAIConfig();\n      if (aiConfig.provider !== 'local' && aiConfig.apiKey) {\n        logger.debug('Using real AI API for analysis', { provider: aiConfig.provider });\n        const realAIAnalysis = await analyzeMessageWithRealAI(text, aiConfig);\n        // Объединяем с базовым анализом для большей точности\n        return combineAnalyses(basicAnalysis, realAIAnalysis);\n      }\n      \n      // Fallback на улучшенный эвристический анализ\n      const advancedAnalysis = await analyzeWithAdvancedHeuristics(text);\n      return combineAnalyses(basicAnalysis, advancedAnalysis);\n    } catch (error) {\n      logger.error('Advanced AI analysis failed, using basic', error instanceof Error ? error : new Error(String(error)));\n      return basicAnalysis;\n    }\n  }\n\n  return basicAnalysis;\n}\n\n/**\n * Анализ изображения с AI\n */\nexport async function analyzeImageWithAI(\n  imageUri: string,\n  config: Partial<AIModerationConfig> = {}\n): Promise<{ blocked: boolean; reasons: string[]; confidence: number }> {\n  const finalConfig = { ...DEFAULT_CONFIG, ...config };\n\n  if (!finalConfig.enableImageAnalysis) {\n    return { blocked: false, reasons: [], confidence: 0 };\n  }\n\n  try {\n    // Базовая проверка на ключевые слова в URI\n    const basicCheck = analyzeImageWithRules(imageUri);\n    \n    if (basicCheck.blocked) {\n      return { ...basicCheck, confidence: 0.8 };\n    }\n\n    // Здесь можно добавить реальный AI анализ изображений\n    // Например, через Vision API или специализированные сервисы модерации\n    \n    return { blocked: false, reasons: [], confidence: 0.5 };\n  } catch (error) {\n    logger.error('Image analysis failed', error instanceof Error ? error : new Error(String(error)), { context: 'AIModerationService', action: 'analyzeImageWithAI' });\n    return { blocked: false, reasons: [], confidence: 0 };\n  }\n}\n\n/**\n * Базовый анализ с правилами (быстрый)\n */\nfunction analyzeWithRules(text: string): RiskAnalysis {\n  const normalized = text.toLowerCase();\n  \n  // Критические паттерны\n  const criticalPatterns = [\n    /(убью|убей|поконч|самоуб|умереть|взорв|бомб)/i,\n    /(убить|смерть|суицид)/i,\n  ];\n  \n  // Высокие риски\n  const highPatterns = [\n    /(адрес|домашн|парол|паспорт|номер карты|cvv|секретный код)/i,\n    /(перевед[ие]|деньг|карта|плати|5000|срочно оплат)/i,\n    /(оруж|пистолет|нож|наркот|взрывчат)/i,\n  ];\n  \n  // Средние риски\n  const mediumPatterns = [\n    /(никому не говори|встреча без взрослых|секретная встреча|ночью|приди один)/i,\n    /(дурак|тупой|ненавижу тебя|жирный|урод|никчем)/i,\n    /(страшно|мне плохо|я боюсь|меня преследуют|издеваются)/i,\n  ];\n\n  // Проверка критических\n  for (const pattern of criticalPatterns) {\n    if (pattern.test(normalized)) {\n      return {\n        riskLevel: 'critical',\n        reasons: ['Обнаружены критические угрозы'],\n        confidence: 0.95,\n        categories: ['threats'],\n      };\n    }\n  }\n\n  // Проверка высоких\n  for (const pattern of highPatterns) {\n    if (pattern.test(normalized)) {\n      return {\n        riskLevel: 'high',\n        reasons: ['Обнаружен высокий риск'],\n        confidence: 0.85,\n        categories: ['privacy', 'fraud'],\n      };\n    }\n  }\n\n  // Проверка средних\n  for (const pattern of mediumPatterns) {\n    if (pattern.test(normalized)) {\n      return {\n        riskLevel: 'medium',\n        reasons: ['Обнаружен средний риск'],\n        confidence: 0.7,\n        categories: ['grooming', 'bullying'],\n      };\n    }\n  }\n\n  return {\n    riskLevel: 'safe',\n    reasons: [],\n    confidence: 0.3,\n    categories: [],\n  };\n}\n\n/**\n * Расширенный эвристический анализ\n */\nasync function analyzeWithAdvancedHeuristics(text: string): Promise<RiskAnalysis> {\n  // Анализ длины сообщения\n  const length = text.length;\n  \n  // Анализ использования заглавных букв (крики)\n  const capsRatio = length > 0 ? (text.match(/[A-ZА-Я]/g) || []).length / length : 0;\n  const isShouting = capsRatio > 0.5 && length > 10;\n  \n  // Анализ повторяющихся символов\n  const hasRepeats = /(.)\\1{4,}/.test(text);\n  \n  // Анализ числовых паттернов (возможные телефоны, адреса)\n  const hasPhonePattern = /\\d{10,}/.test(text);\n  const hasAddressPattern = /(улица|дом|квартира|адрес)/i.test(text);\n  \n  // Анализ эмоциональных маркеров\n  const hasNegativeEmotions = /(плохо|страшно|боюсь|ненавижу|ужасно)/i.test(text);\n  \n  let riskLevel: RiskLevel = 'safe';\n  const reasons: string[] = [];\n  const categories: string[] = [];\n  let confidence = 0.3;\n\n  if (isShouting && hasNegativeEmotions) {\n    riskLevel = 'medium';\n    reasons.push('Агрессивное сообщение с негативными эмоциями');\n    categories.push('bullying');\n    confidence = 0.65;\n  }\n\n  if (hasPhonePattern || hasAddressPattern) {\n    riskLevel = 'high';\n    reasons.push('Обнаружены личные данные');\n    categories.push('privacy');\n    confidence = 0.8;\n  }\n\n  if (hasRepeats && length > 20) {\n    riskLevel = 'low';\n    reasons.push('Подозрительный паттерн сообщения');\n    categories.push('suspicious');\n    confidence = 0.5;\n  }\n\n  return {\n    riskLevel,\n    reasons,\n    confidence,\n    categories,\n  };\n}\n\n/**\n * Объединение результатов анализа\n */\nfunction combineAnalyses(\n  basic: RiskAnalysis,\n  advanced: RiskAnalysis\n): RiskAnalysis {\n  const levels: RiskLevel[] = ['safe', 'low', 'medium', 'high', 'critical'];\n  const basicIndex = levels.indexOf(basic.riskLevel);\n  const advancedIndex = levels.indexOf(advanced.riskLevel);\n  \n  // Берем более высокий уровень риска\n  const combinedLevel = basicIndex > advancedIndex ? basic.riskLevel : advanced.riskLevel;\n  \n  // Объединяем причины\n  const combinedReasons = [...new Set([...basic.reasons, ...advanced.reasons])];\n  const combinedCategories = [...new Set([...basic.categories, ...advanced.categories])];\n  \n  // Усредняем уверенность\n  const combinedConfidence = (basic.confidence + advanced.confidence) / 2;\n\n  return {\n    riskLevel: combinedLevel,\n    reasons: combinedReasons,\n    confidence: Math.min(0.99, combinedConfidence),\n    categories: combinedCategories,\n  };\n}\n\n/**\n * Базовый анализ изображений\n */\nfunction analyzeImageWithRules(imageUri: string): { blocked: boolean; reasons: string[] } {\n  const normalized = imageUri.toLowerCase();\n  const riskKeywords = ['weapon', 'blood', 'nsfw', 'violence', 'gun', 'knife', 'nude', 'explicit'];\n  \n  const hit = riskKeywords.find((keyword) => normalized.includes(keyword));\n  if (hit) {\n    return {\n      blocked: true,\n      reasons: [`Изображение содержит рискованный контент: ${hit}`],\n    };\n  }\n\n  return { blocked: false, reasons: [] };\n}\n\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}