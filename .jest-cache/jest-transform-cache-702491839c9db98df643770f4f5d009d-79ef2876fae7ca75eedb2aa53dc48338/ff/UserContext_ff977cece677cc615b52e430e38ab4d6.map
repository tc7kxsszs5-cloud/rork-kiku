{"version":3,"names":["_createContextHook3","_interopRequireDefault","require","_react","_asyncStorage","_reactNative","_i18n","_logger","_errorHandler","USER_STORAGE_KEY","_createContextHook","createContextHook","_useState","useState","_useState2","_slicedToArray2","default","user","setUser","_useState3","_useState4","isLoading","setIsLoading","useEffect","isMounted","timer","loadUser","_ref","_asyncToGenerator2","stored","AsyncStorage","getItem","userData","JSON","parse","migratedUser","Object","assign","role","children","language","i18n","changeLanguage","_yield$import","detectDeviceLanguage","detectedLang","logger","info","context","error","handleErrorSilently","action","apply","arguments","Platform","OS","setTimeout","clearTimeout","identifyUser","useCallback","_ref2","newUser","id","Date","now","Math","random","toString","substr","createdAt","setItem","stringify","userId","userName","name","childrenCount","length","Error","String","_x","updateUser","_ref3","updates","updatedUser","showUserFriendlyError","_x2","addChild","_ref4","childData","newChild","addedAt","parentId","permissions","canChangeChatBackgrounds","canChangeNotificationSounds","canAddContacts","concat","_toConsumableArray2","console","log","_x3","removeChild","_ref5","childId","updatedChildren","filter","child","activeChildId","undefined","_x4","setActiveChild","_ref6","_x5","logoutUser","removeItem","activeChild","useMemo","find","isAuthenticated","_createContextHook2","UserProvider","exports","useUser"],"sources":["UserContext.tsx"],"sourcesContent":["import createContextHook from '@nkzw/create-context-hook';\nimport { useState, useEffect, useCallback, useMemo } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\nimport i18n from './i18n';\nimport { logger } from '@/utils/logger';\n\nimport { UserRole, ParentGender } from './types';\nimport { handleErrorSilently, showUserFriendlyError } from '@/utils/errorHandler';\n\nexport interface ChildProfile {\n  id: string;\n  name: string;\n  age?: number;\n  avatar?: string;\n  deviceId?: string;\n  addedAt: number;\n  parentId?: string; // ID родителя-владельца\n  pin?: string; // PIN для входа ребенка (опционально)\n  permissions?: {\n    canChangeChatBackgrounds?: boolean;\n    canChangeNotificationSounds?: boolean;\n    canAddContacts?: boolean;\n  };\n}\n\nexport interface User {\n  id: string;\n  name: string;\n  email?: string;\n  avatar?: string;\n  createdAt: number;\n  deviceId?: string;\n  language?: string;\n  role?: UserRole; // 'parent' | 'child' (опционально для обратной совместимости)\n  parentId?: string; // Если role='child', указывает на родителя\n  parentPin?: string; // PIN родителя для аутентификации\n  parentGender?: ParentGender; // Пол родителя (для локализации)\n  country?: string; // Страна (для локализации)\n  children: ChildProfile[]; // Массив детей родителя\n  activeChildId?: string; // ID активного (выбранного) ребенка для просмотра\n}\n\nconst USER_STORAGE_KEY = '@user_data';\n\nexport const [UserProvider, useUser] = createContextHook(() => {\n  const [user, setUser] = useState<User | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  useEffect(() => {\n    let isMounted = true;\n    let timer: ReturnType<typeof setTimeout> | undefined;\n\n    const loadUser = async () => {\n      try {\n        const stored = await AsyncStorage.getItem(USER_STORAGE_KEY);\n        if (!isMounted) {\n          return;\n        }\n        if (stored) {\n          const userData = JSON.parse(stored);\n          // Миграция: если нет role, устанавливаем 'parent' по умолчанию\n          const migratedUser: User = {\n            ...userData,\n            role: userData.role || 'parent', // По умолчанию родитель\n            children: userData.children || [], // Обеспечиваем наличие children\n          };\n          setUser(migratedUser);\n          if (migratedUser.language) {\n            i18n.changeLanguage(migratedUser.language);\n          }\n        } else {\n          // Первый запуск - определяем язык устройства автоматически\n          const { detectDeviceLanguage } = await import('@/constants/i18n');\n          const detectedLang = await detectDeviceLanguage();\n          if (detectedLang && detectedLang !== i18n.language) {\n            i18n.changeLanguage(detectedLang);\n            logger.info('Auto-detected language', { context: 'UserContext', language: detectedLang });\n          }\n        }\n      } catch (error) {\n        handleErrorSilently(error, 'UserContext', { action: 'loadUser' });\n      } finally {\n        if (isMounted) {\n          setIsLoading(false);\n        }\n      }\n    };\n\n    if (Platform.OS !== 'web') {\n      loadUser();\n    } else {\n      timer = setTimeout(loadUser, 0);\n    }\n\n    return () => {\n      isMounted = false;\n      if (timer) {\n        clearTimeout(timer);\n      }\n    };\n  }, []);\n\n  const identifyUser = useCallback(async (userData: Omit<User, 'id' | 'createdAt' | 'children'> & { children?: ChildProfile[] }) => {\n    try {\n      const newUser: User = {\n        id: `user_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        createdAt: Date.now(),\n        children: userData.children || [],\n        ...userData,\n      };\n\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(newUser));\n      setUser(newUser);\n\n      logger.info('User identified', { context: 'UserContext', userId: newUser.id, userName: newUser.name, childrenCount: newUser.children.length });\n\n      return newUser;\n    } catch (error) {\n      logger.error('Error identifying user', error instanceof Error ? error : new Error(String(error)), { context: 'UserContext', action: 'identifyUser' });\n      throw error;\n    }\n  }, []);\n\n  const updateUser = useCallback(async (updates: Partial<Omit<User, 'id' | 'createdAt'>>) => {\n    if (!user) {\n      throw new Error('No user to update');\n    }\n\n    try {\n      const updatedUser = { ...user, ...updates };\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));\n      setUser(updatedUser);\n\n      if (updates.language) {\n        i18n.changeLanguage(updates.language);\n      }\n\n      logger.info('User updated', { context: 'UserContext', userId: updatedUser.id, action: 'updateUser' });\n      return updatedUser;\n    } catch (error) {\n      handleErrorSilently(error, 'UserContext', { action: 'updateUser' });\n      await showUserFriendlyError(error, 'UserContext', { action: 'updateUser' });\n      throw error;\n    }\n  }, [user]);\n\n  const addChild = useCallback(async (childData: Omit<ChildProfile, 'id' | 'addedAt' | 'parentId'>) => {\n    if (!user) {\n      throw new Error('No user to add child to');\n    }\n\n    // Проверка: только родитель может добавлять детей\n    if (user.role === 'child') {\n      throw new Error('Only parent can add children');\n    }\n\n    try {\n      const newChild: ChildProfile = {\n        id: `child_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        addedAt: Date.now(),\n        parentId: user.id,\n        permissions: {\n          canChangeChatBackgrounds: true,\n          canChangeNotificationSounds: true,\n          canAddContacts: false, // По умолчанию только родитель\n          ...childData.permissions,\n        },\n        ...childData,\n      };\n\n      const updatedUser = {\n        ...user,\n        children: [...user.children, newChild],\n      };\n\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));\n      setUser(updatedUser);\n\n      console.log('Child added:', newChild.id);\n      return newChild;\n    } catch (error) {\n      console.error('Error adding child:', error);\n      throw error;\n    }\n  }, [user]);\n\n  const removeChild = useCallback(async (childId: string) => {\n    if (!user) {\n      throw new Error('No user to remove child from');\n    }\n\n    try {\n      const updatedChildren = user.children.filter(child => child.id !== childId);\n      const updatedUser = {\n        ...user,\n        children: updatedChildren,\n        activeChildId: user.activeChildId === childId ? undefined : user.activeChildId,\n      };\n\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));\n      setUser(updatedUser);\n\n      logger.info('Child removed', { context: 'UserContext', childId, action: 'removeChild' });\n    } catch (error) {\n      logger.error('Error removing child', error instanceof Error ? error : new Error(String(error)), { context: 'UserContext', action: 'removeChild' });\n      throw error;\n    }\n  }, [user]);\n\n  const setActiveChild = useCallback(async (childId: string | undefined) => {\n    if (!user) {\n      throw new Error('No user to update');\n    }\n\n    try {\n      const updatedUser = { ...user, activeChildId: childId };\n      await AsyncStorage.setItem(USER_STORAGE_KEY, JSON.stringify(updatedUser));\n      setUser(updatedUser);\n\n      logger.info('Active child set', { context: 'UserContext', childId, action: 'setActiveChild' });\n    } catch (error) {\n      handleErrorSilently(error, 'UserContext', { action: 'setActiveChild' });\n      await showUserFriendlyError(error, 'UserContext', { action: 'setActiveChild' });\n      throw error;\n    }\n  }, [user]);\n\n  const logoutUser = useCallback(async () => {\n    try {\n      await AsyncStorage.removeItem(USER_STORAGE_KEY);\n      setUser(null);\n      logger.info('User logged out', { context: 'UserContext', action: 'logoutUser' });\n    } catch (error) {\n      handleErrorSilently(error, 'UserContext', { action: 'logoutUser' });\n      await showUserFriendlyError(error, 'UserContext', { action: 'logoutUser' });\n      throw error;\n    }\n  }, []);\n\n  const activeChild = useMemo(() => {\n    if (!user || !user.activeChildId) return null;\n    return user.children.find(child => child.id === user.activeChildId) || null;\n  }, [user]);\n\n  return useMemo(() => ({\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n    activeChild,\n    children: user?.children || [],\n    identifyUser,\n    updateUser,\n    addChild,\n    removeChild,\n    setActiveChild,\n    logoutUser,\n  }), [user, isLoading, activeChild, identifyUser, updateUser, addChild, removeChild, setActiveChild, logoutUser]);\n});\n"],"mappings":"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","ignoreList":[]}