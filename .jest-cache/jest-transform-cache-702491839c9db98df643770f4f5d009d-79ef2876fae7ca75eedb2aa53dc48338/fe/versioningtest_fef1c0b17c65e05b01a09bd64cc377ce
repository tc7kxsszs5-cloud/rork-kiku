9af210a8404e4584b2b6f8597f14970d
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _versioning = require("@/utils/versioning");
var _asyncStorage = _interopRequireDefault(require("@react-native-async-storage/async-storage"));
jest.doMock('@react-native-async-storage/async-storage', function () {
  var mock = {
    getItem: jest.fn(function () {
      return Promise.resolve(null);
    }),
    setItem: jest.fn(function () {
      return Promise.resolve();
    }),
    removeItem: jest.fn(function () {
      return Promise.resolve();
    }),
    clear: jest.fn(function () {
      return Promise.resolve();
    }),
    getAllKeys: jest.fn(function () {
      return Promise.resolve([]);
    }),
    multiGet: jest.fn(function () {
      return Promise.resolve([]);
    }),
    multiSet: jest.fn(function () {
      return Promise.resolve();
    }),
    multiRemove: jest.fn(function () {
      return Promise.resolve();
    })
  };
  return Object.assign({}, mock, {
    default: mock
  });
});
describe('versioning', function () {
  beforeEach(function () {
    jest.clearAllMocks();
    _asyncStorage.default.getItem.mockClear();
    _asyncStorage.default.setItem.mockClear();
  });
  describe('getVersionInfo', function () {
    it('должен вернуть информацию о версиях', function () {
      var versionInfo = (0, _versioning.getVersionInfo)();
      expect(versionInfo).toHaveProperty('appVersion');
      expect(versionInfo).toHaveProperty('dataVersion');
      expect(versionInfo).toHaveProperty('apiVersion');
      expect(versionInfo).toHaveProperty('schemaVersion');
      expect(typeof versionInfo.appVersion).toBe('string');
      expect(typeof versionInfo.dataVersion).toBe('number');
      expect(typeof versionInfo.apiVersion).toBe('number');
      expect(typeof versionInfo.schemaVersion).toBe('number');
    });
  });
  describe('createVersionedData', function () {
    it('должен создать версионированные данные', function () {
      var data = {
        test: 'data'
      };
      var versioned = (0, _versioning.createVersionedData)(data, 2);
      expect(versioned.version).toBe(2);
      expect(versioned.data).toBe(data);
      expect(versioned.migratedAt).toBeDefined();
    });
    it('должен использовать дефолтную версию если не указана', function () {
      var data = {
        test: 'data'
      };
      var versioned = (0, _versioning.createVersionedData)(data);
      expect(versioned.version).toBeDefined();
      expect(typeof versioned.version).toBe('number');
    });
  });
  describe('needsMigration', function () {
    it('должен вернуть true если версия меньше целевой', function () {
      expect((0, _versioning.needsMigration)(1, 2)).toBe(true);
      expect((0, _versioning.needsMigration)(1, 3)).toBe(true);
    });
    it('должен вернуть false если версия равна целевой', function () {
      expect((0, _versioning.needsMigration)(2, 2)).toBe(false);
    });
    it('должен вернуть false если версия больше целевой', function () {
      expect((0, _versioning.needsMigration)(3, 2)).toBe(false);
    });
    it('должен использовать дефолтную целевую версию', function () {
      var result = (0, _versioning.needsMigration)(1);
      expect(typeof result).toBe('boolean');
    });
  });
  describe('getStoredVersion', function () {
    it('должен получить версию из хранилища', (0, _asyncToGenerator2.default)(function* () {
      _asyncStorage.default.getItem.mockResolvedValue('2');
      var version = yield (0, _versioning.getStoredVersion)('@test_key');
      expect(version).toBe(2);
      expect(_asyncStorage.default.getItem).toHaveBeenCalledWith('@test_key_version');
    }));
    it('должен вернуть 1 если версия не найдена', (0, _asyncToGenerator2.default)(function* () {
      _asyncStorage.default.getItem.mockResolvedValue(null);
      var version = yield (0, _versioning.getStoredVersion)('@test_key');
      expect(version).toBe(1);
      expect(_asyncStorage.default.getItem).toHaveBeenCalledWith('@test_key_version');
    }));
    it('должен вернуть 1 при ошибке', (0, _asyncToGenerator2.default)(function* () {
      _asyncStorage.default.getItem.mockRejectedValue(new Error('Storage error'));
      var version = yield (0, _versioning.getStoredVersion)('@test_key');
      expect(version).toBe(1);
    }));
  });
  describe('saveStoredVersion', function () {
    it('должен сохранить версию в хранилище', (0, _asyncToGenerator2.default)(function* () {
      _asyncStorage.default.setItem.mockResolvedValue(undefined);
      yield (0, _versioning.saveStoredVersion)('@test_key', 2);
      expect(_asyncStorage.default.setItem).toHaveBeenCalledWith('@test_key_version', '2');
    }));
    it('должен обработать ошибку при сохранении', (0, _asyncToGenerator2.default)(function* () {
      var originalError = console.error;
      var errorSpy = jest.fn();
      console.error = errorSpy;
      try {
        _asyncStorage.default.setItem.mockRejectedValue(new Error('Storage error'));
        var errorThrown = false;
        try {
          yield (0, _versioning.saveStoredVersion)('@test_key', 2);
        } catch (error) {
          errorThrown = true;
        }
        expect(errorThrown).toBe(false);
        expect(_asyncStorage.default.setItem).toHaveBeenCalledWith('@test_key_version', '2');
        expect(errorSpy).toHaveBeenCalled();
      } finally {
        console.error = originalError;
      }
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdmVyc2lvbmluZyIsInJlcXVpcmUiLCJfYXN5bmNTdG9yYWdlIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsImplc3QiLCJkb01vY2siLCJtb2NrIiwiZ2V0SXRlbSIsImZuIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRJdGVtIiwicmVtb3ZlSXRlbSIsImNsZWFyIiwiZ2V0QWxsS2V5cyIsIm11bHRpR2V0IiwibXVsdGlTZXQiLCJtdWx0aVJlbW92ZSIsIk9iamVjdCIsImFzc2lnbiIsImRlZmF1bHQiLCJkZXNjcmliZSIsImJlZm9yZUVhY2giLCJjbGVhckFsbE1vY2tzIiwiQXN5bmNTdG9yYWdlIiwibW9ja0NsZWFyIiwiaXQiLCJ2ZXJzaW9uSW5mbyIsImdldFZlcnNpb25JbmZvIiwiZXhwZWN0IiwidG9IYXZlUHJvcGVydHkiLCJhcHBWZXJzaW9uIiwidG9CZSIsImRhdGFWZXJzaW9uIiwiYXBpVmVyc2lvbiIsInNjaGVtYVZlcnNpb24iLCJkYXRhIiwidGVzdCIsInZlcnNpb25lZCIsImNyZWF0ZVZlcnNpb25lZERhdGEiLCJ2ZXJzaW9uIiwibWlncmF0ZWRBdCIsInRvQmVEZWZpbmVkIiwibmVlZHNNaWdyYXRpb24iLCJyZXN1bHQiLCJfYXN5bmNUb0dlbmVyYXRvcjIiLCJtb2NrUmVzb2x2ZWRWYWx1ZSIsImdldFN0b3JlZFZlcnNpb24iLCJ0b0hhdmVCZWVuQ2FsbGVkV2l0aCIsIm1vY2tSZWplY3RlZFZhbHVlIiwiRXJyb3IiLCJ1bmRlZmluZWQiLCJzYXZlU3RvcmVkVmVyc2lvbiIsIm9yaWdpbmFsRXJyb3IiLCJjb25zb2xlIiwiZXJyb3IiLCJlcnJvclNweSIsImVycm9yVGhyb3duIiwidG9IYXZlQmVlbkNhbGxlZCJdLCJzb3VyY2VzIjpbInZlcnNpb25pbmcudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqINCi0LXRgdGC0Ysg0LTQu9GPINGB0LjRgdGC0LXQvNGLINCy0LXRgNGB0LjQvtC90LjRgNC+0LLQsNC90LjRj1xuICogQXN5bmNTdG9yYWdlINC80L7QutCw0LXRgtGB0Y8g0LIgamVzdC5zZXR1cC5qcyAoZGVmYXVsdCArIG5hbWVkIGV4cG9ydHMpLlxuICog0JTQu9GPINC00LjQvdCw0LzQuNGH0LXRgdC60L7Qs9C+INC40LzQv9C+0YDRgtCwINC40YHQv9C+0LvRjNC30YPQtdC8INC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdGL0Lkg0LzQvtC6LlxuICovXG5cbmltcG9ydCB7XG4gIGdldFZlcnNpb25JbmZvLFxuICBjcmVhdGVWZXJzaW9uZWREYXRhLFxuICBuZWVkc01pZ3JhdGlvbixcbiAgZ2V0U3RvcmVkVmVyc2lvbixcbiAgc2F2ZVN0b3JlZFZlcnNpb24sXG59IGZyb20gJ0AvdXRpbHMvdmVyc2lvbmluZyc7XG5pbXBvcnQgQXN5bmNTdG9yYWdlIGZyb20gJ0ByZWFjdC1uYXRpdmUtYXN5bmMtc3RvcmFnZS9hc3luYy1zdG9yYWdlJztcblxuLy8g0JzQvtC60LDQtdC8INC80L7QtNGD0LvRjCDQtNC70Y8g0LTQuNC90LDQvNC40YfQtdGB0LrQvtCz0L4g0LjQvNC/0L7RgNGC0LAgKNC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdC+INC6IGplc3Quc2V0dXAuanMpXG4vLyDQrdGC0L4g0L3Rg9C20L3Qviwg0YLQsNC6INC60LDQuiDQtNC40L3QsNC80LjRh9C10YHQutC40Lkg0LjQvNC/0L7RgNGCINC80L7QttC10YIg0L3QtSDQuNGB0L/QvtC70YzQt9C+0LLQsNGC0Ywg0LPQu9C+0LHQsNC70YzQvdGL0Lkg0LzQvtC6XG5qZXN0LmRvTW9jaygnQHJlYWN0LW5hdGl2ZS1hc3luYy1zdG9yYWdlL2FzeW5jLXN0b3JhZ2UnLCAoKSA9PiB7XG4gIGNvbnN0IG1vY2sgPSB7XG4gICAgZ2V0SXRlbTogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUobnVsbCkpLFxuICAgIHNldEl0ZW06IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCkpLFxuICAgIHJlbW92ZUl0ZW06IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCkpLFxuICAgIGNsZWFyOiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSgpKSxcbiAgICBnZXRBbGxLZXlzOiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZShbXSkpLFxuICAgIG11bHRpR2V0OiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZShbXSkpLFxuICAgIG11bHRpU2V0OiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSgpKSxcbiAgICBtdWx0aVJlbW92ZTogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoKSksXG4gIH07XG4gIHJldHVybiB7IC4uLm1vY2ssIGRlZmF1bHQ6IG1vY2sgfTtcbn0pO1xuXG5kZXNjcmliZSgndmVyc2lvbmluZycsICgpID0+IHtcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgLy8g0KHQsdGA0LDRgdGL0LLQsNC10Lwg0LzQvtC60Lgg0L/QtdGA0LXQtCDQutCw0LbQtNGL0Lwg0YLQtdGB0YLQvtC8XG4gICAgKEFzeW5jU3RvcmFnZS5nZXRJdGVtIGFzIGplc3QuTW9jaykubW9ja0NsZWFyKCk7XG4gICAgKEFzeW5jU3RvcmFnZS5zZXRJdGVtIGFzIGplc3QuTW9jaykubW9ja0NsZWFyKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdnZXRWZXJzaW9uSW5mbycsICgpID0+IHtcbiAgICBpdCgn0LTQvtC70LbQtdC9INCy0LXRgNC90YPRgtGMINC40L3RhNC+0YDQvNCw0YbQuNGOINC+INCy0LXRgNGB0LjRj9GFJywgKCkgPT4ge1xuICAgICAgY29uc3QgdmVyc2lvbkluZm8gPSBnZXRWZXJzaW9uSW5mbygpO1xuXG4gICAgICBleHBlY3QodmVyc2lvbkluZm8pLnRvSGF2ZVByb3BlcnR5KCdhcHBWZXJzaW9uJyk7XG4gICAgICBleHBlY3QodmVyc2lvbkluZm8pLnRvSGF2ZVByb3BlcnR5KCdkYXRhVmVyc2lvbicpO1xuICAgICAgZXhwZWN0KHZlcnNpb25JbmZvKS50b0hhdmVQcm9wZXJ0eSgnYXBpVmVyc2lvbicpO1xuICAgICAgZXhwZWN0KHZlcnNpb25JbmZvKS50b0hhdmVQcm9wZXJ0eSgnc2NoZW1hVmVyc2lvbicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiB2ZXJzaW9uSW5mby5hcHBWZXJzaW9uKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgdmVyc2lvbkluZm8uZGF0YVZlcnNpb24pLnRvQmUoJ251bWJlcicpO1xuICAgICAgZXhwZWN0KHR5cGVvZiB2ZXJzaW9uSW5mby5hcGlWZXJzaW9uKS50b0JlKCdudW1iZXInKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgdmVyc2lvbkluZm8uc2NoZW1hVmVyc2lvbikudG9CZSgnbnVtYmVyJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdjcmVhdGVWZXJzaW9uZWREYXRhJywgKCkgPT4ge1xuICAgIGl0KCfQtNC+0LvQttC10L0g0YHQvtC30LTQsNGC0Ywg0LLQtdGA0YHQuNC+0L3QuNGA0L7QstCw0L3QvdGL0LUg0LTQsNC90L3Ri9C1JywgKCkgPT4ge1xuICAgICAgY29uc3QgZGF0YSA9IHsgdGVzdDogJ2RhdGEnIH07XG4gICAgICBjb25zdCB2ZXJzaW9uZWQgPSBjcmVhdGVWZXJzaW9uZWREYXRhKGRhdGEsIDIpO1xuXG4gICAgICBleHBlY3QodmVyc2lvbmVkLnZlcnNpb24pLnRvQmUoMik7XG4gICAgICBleHBlY3QodmVyc2lvbmVkLmRhdGEpLnRvQmUoZGF0YSk7XG4gICAgICBleHBlY3QodmVyc2lvbmVkLm1pZ3JhdGVkQXQpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG5cbiAgICBpdCgn0LTQvtC70LbQtdC9INC40YHQv9C+0LvRjNC30L7QstCw0YLRjCDQtNC10YTQvtC70YLQvdGD0Y4g0LLQtdGA0YHQuNGOINC10YHQu9C4INC90LUg0YPQutCw0LfQsNC90LAnLCAoKSA9PiB7XG4gICAgICBjb25zdCBkYXRhID0geyB0ZXN0OiAnZGF0YScgfTtcbiAgICAgIGNvbnN0IHZlcnNpb25lZCA9IGNyZWF0ZVZlcnNpb25lZERhdGEoZGF0YSk7XG5cbiAgICAgIGV4cGVjdCh2ZXJzaW9uZWQudmVyc2lvbikudG9CZURlZmluZWQoKTtcbiAgICAgIGV4cGVjdCh0eXBlb2YgdmVyc2lvbmVkLnZlcnNpb24pLnRvQmUoJ251bWJlcicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnbmVlZHNNaWdyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ9C00L7Qu9C20LXQvSDQstC10YDQvdGD0YLRjCB0cnVlINC10YHQu9C4INCy0LXRgNGB0LjRjyDQvNC10L3RjNGI0LUg0YbQtdC70LXQstC+0LknLCAoKSA9PiB7XG4gICAgICBleHBlY3QobmVlZHNNaWdyYXRpb24oMSwgMikpLnRvQmUodHJ1ZSk7XG4gICAgICBleHBlY3QobmVlZHNNaWdyYXRpb24oMSwgMykpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgn0LTQvtC70LbQtdC9INCy0LXRgNC90YPRgtGMIGZhbHNlINC10YHQu9C4INCy0LXRgNGB0LjRjyDRgNCw0LLQvdCwINGG0LXQu9C10LLQvtC5JywgKCkgPT4ge1xuICAgICAgZXhwZWN0KG5lZWRzTWlncmF0aW9uKDIsIDIpKS50b0JlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGl0KCfQtNC+0LvQttC10L0g0LLQtdGA0L3Rg9GC0YwgZmFsc2Ug0LXRgdC70Lgg0LLQtdGA0YHQuNGPINCx0L7Qu9GM0YjQtSDRhtC10LvQtdCy0L7QuScsICgpID0+IHtcbiAgICAgIGV4cGVjdChuZWVkc01pZ3JhdGlvbigzLCAyKSkudG9CZShmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBpdCgn0LTQvtC70LbQtdC9INC40YHQv9C+0LvRjNC30L7QstCw0YLRjCDQtNC10YTQvtC70YLQvdGD0Y4g0YbQtdC70LXQstGD0Y4g0LLQtdGA0YHQuNGOJywgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gbmVlZHNNaWdyYXRpb24oMSk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdCkudG9CZSgnYm9vbGVhbicpO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnZ2V0U3RvcmVkVmVyc2lvbicsICgpID0+IHtcbiAgICBpdCgn0LTQvtC70LbQtdC9INC/0L7Qu9GD0YfQuNGC0Ywg0LLQtdGA0YHQuNGOINC40Lcg0YXRgNCw0L3QuNC70LjRidCwJywgYXN5bmMgKCkgPT4ge1xuICAgICAgKEFzeW5jU3RvcmFnZS5nZXRJdGVtIGFzIGplc3QuTW9jaykubW9ja1Jlc29sdmVkVmFsdWUoJzInKTtcblxuICAgICAgY29uc3QgdmVyc2lvbiA9IGF3YWl0IGdldFN0b3JlZFZlcnNpb24oJ0B0ZXN0X2tleScpO1xuXG4gICAgICBleHBlY3QodmVyc2lvbikudG9CZSgyKTtcbiAgICAgIGV4cGVjdChBc3luY1N0b3JhZ2UuZ2V0SXRlbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0B0ZXN0X2tleV92ZXJzaW9uJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn0LTQvtC70LbQtdC9INCy0LXRgNC90YPRgtGMIDEg0LXRgdC70Lgg0LLQtdGA0YHQuNGPINC90LUg0L3QsNC50LTQtdC90LAnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoQXN5bmNTdG9yYWdlLmdldEl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgY29uc3QgdmVyc2lvbiA9IGF3YWl0IGdldFN0b3JlZFZlcnNpb24oJ0B0ZXN0X2tleScpO1xuXG4gICAgICBleHBlY3QodmVyc2lvbikudG9CZSgxKTtcbiAgICAgIGV4cGVjdChBc3luY1N0b3JhZ2UuZ2V0SXRlbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0B0ZXN0X2tleV92ZXJzaW9uJyk7XG4gICAgfSk7XG5cbiAgICBpdCgn0LTQvtC70LbQtdC9INCy0LXRgNC90YPRgtGMIDEg0L/RgNC4INC+0YjQuNCx0LrQtScsIGFzeW5jICgpID0+IHtcbiAgICAgIChBc3luY1N0b3JhZ2UuZ2V0SXRlbSBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignU3RvcmFnZSBlcnJvcicpKTtcblxuICAgICAgY29uc3QgdmVyc2lvbiA9IGF3YWl0IGdldFN0b3JlZFZlcnNpb24oJ0B0ZXN0X2tleScpO1xuXG4gICAgICBleHBlY3QodmVyc2lvbikudG9CZSgxKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ3NhdmVTdG9yZWRWZXJzaW9uJywgKCkgPT4ge1xuICAgIGl0KCfQtNC+0LvQttC10L0g0YHQvtGF0YDQsNC90LjRgtGMINCy0LXRgNGB0LjRjiDQsiDRhdGA0LDQvdC40LvQuNGJ0LUnLCBhc3luYyAoKSA9PiB7XG4gICAgICAoQXN5bmNTdG9yYWdlLnNldEl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZSh1bmRlZmluZWQpO1xuXG4gICAgICBhd2FpdCBzYXZlU3RvcmVkVmVyc2lvbignQHRlc3Rfa2V5JywgMik7XG5cbiAgICAgIGV4cGVjdChBc3luY1N0b3JhZ2Uuc2V0SXRlbSkudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0B0ZXN0X2tleV92ZXJzaW9uJywgJzInKTtcbiAgICB9KTtcblxuICAgIGl0KCfQtNC+0LvQttC10L0g0L7QsdGA0LDQsdC+0YLQsNGC0Ywg0L7RiNC40LHQutGDINC/0YDQuCDRgdC+0YXRgNCw0L3QtdC90LjQuCcsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vINCf0L7QtNCw0LLQu9GP0LXQvCDQstGL0LLQvtC0INC+0YjQuNCx0LrQuCDQsiDQutC+0L3RgdC+0LvRjCDQtNC70Y8g0Y3RgtC+0LPQviDRgtC10YHRgtCwXG4gICAgICBjb25zdCBvcmlnaW5hbEVycm9yID0gY29uc29sZS5lcnJvcjtcbiAgICAgIGNvbnN0IGVycm9yU3B5ID0gamVzdC5mbigpO1xuICAgICAgY29uc29sZS5lcnJvciA9IGVycm9yU3B5O1xuXG4gICAgICB0cnkge1xuICAgICAgICAoQXN5bmNTdG9yYWdlLnNldEl0ZW0gYXMgamVzdC5Nb2NrKS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ1N0b3JhZ2UgZXJyb3InKSk7XG5cbiAgICAgICAgLy8g0KTRg9C90LrRhtC40Y8g0L3QtSDQtNC+0LvQttC90LAg0LLRi9Cx0YDQvtGB0LjRgtGMINC+0YjQuNCx0LrRgywg0LTQvtC70LbQvdCwINC+0LHRgNCw0LHQvtGC0LDRgtGMINC10ZEg0LLQvdGD0YLRgNC4XG4gICAgICAgIGxldCBlcnJvclRocm93biA9IGZhbHNlO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IHNhdmVTdG9yZWRWZXJzaW9uKCdAdGVzdF9rZXknLCAyKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBlcnJvclRocm93biA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBleHBlY3QoZXJyb3JUaHJvd24pLnRvQmUoZmFsc2UpO1xuICAgICAgICBleHBlY3QoQXN5bmNTdG9yYWdlLnNldEl0ZW0pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdAdGVzdF9rZXlfdmVyc2lvbicsICcyJyk7XG4gICAgICAgIC8vINCf0YDQvtCy0LXRgNGP0LXQvCwg0YfRgtC+INC+0YjQuNCx0LrQsCDQsdGL0LvQsCDQt9Cw0LvQvtCz0LjRgNC+0LLQsNC90LBcbiAgICAgICAgZXhwZWN0KGVycm9yU3B5KS50b0hhdmVCZWVuQ2FsbGVkKCk7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICAvLyDQktC+0YHRgdGC0LDQvdCw0LLQu9C40LLQsNC10LwgY29uc29sZS5lcnJvclxuICAgICAgICBjb25zb2xlLmVycm9yID0gb3JpZ2luYWxFcnJvcjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFNQSxJQUFBQSxXQUFBLEdBQUFDLE9BQUE7QUFPQSxJQUFBQyxhQUFBLEdBQUFDLHNCQUFBLENBQUFGLE9BQUE7QUFJQUcsSUFBSSxDQUFDQyxNQUFNLENBQUMsMkNBQTJDLEVBQUUsWUFBTTtFQUM3RCxJQUFNQyxJQUFJLEdBQUc7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