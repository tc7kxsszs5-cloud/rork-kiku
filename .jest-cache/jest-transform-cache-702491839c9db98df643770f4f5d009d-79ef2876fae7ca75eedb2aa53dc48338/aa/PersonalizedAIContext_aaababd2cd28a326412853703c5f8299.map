{"version":3,"names":["createContextHook","useState","useCallback","useMemo","useEffect","AsyncStorage","useUser","PERSONALIZATION_STORAGE_KEY","DEFAULT_PROFILES","Map","_createContextHook","_useUser","user","_useState","_useState2","_slicedToArray","profiles","setProfiles","loadProfiles","_ref","_asyncToGenerator","stored","getItem","parsed","JSON","parse","profilesMap","Object","entries","forEach","_ref2","_ref3","key","value","set","error","console","apply","arguments","saveProfiles","_ref4","obj","fromEntries","setItem","stringify","size","getChildProfile","childId","get","updateChildProfile","_ref5","updates","prev","newProfiles","existing","assign","newProfile","age","language","culturalContext","behaviorPatterns","averageMessageLength","commonWords","communicationStyle","riskHistory","safe","low","medium","high","critical","personalizedRules","sensitivityLevel","customKeywords","whitelistedPhrases","learningData","falsePositives","truePositives","parentFeedback","_x","_x2","personalizeAnalysis","analysis","messageText","profile","normalizedText","toLowerCase","isWhitelisted","some","phrase","includes","riskLevel","levels","currentIndex","indexOf","confidence","reasons","concat","_toConsumableArray","sensitivity","falsePositiveRate","adjustedConfidence","learnFromFeedback","_ref6","messageId","wasCorrect","feedback","timestamp","Date","now","slice","Math","max","_x3","_x4","_x5","getPersonalizedRecommendations","recommendations","totalRisks","values","reduce","a","b","push","length","_createContextHook2","PersonalizedAIProvider","usePersonalizedAI"],"sources":["PersonalizedAIContext.tsx"],"sourcesContent":["import createContextHook from '@nkzw/create-context-hook';\nimport { useState, useCallback, useMemo, useEffect } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useUser } from './UserContext';\nimport { RiskLevel, RiskAnalysis } from './types';\n\nconst PERSONALIZATION_STORAGE_KEY = '@ai_personalization';\n\nexport interface ChildProfile {\n  childId: string;\n  age: number;\n  language: string;\n  culturalContext: string;\n  behaviorPatterns: {\n    averageMessageLength: number;\n    commonWords: string[];\n    communicationStyle: 'formal' | 'casual' | 'playful';\n    riskHistory: Record<RiskLevel, number>;\n  };\n  personalizedRules: {\n    sensitivityLevel: number; // 0-1, насколько строгие правила\n    customKeywords: string[];\n    whitelistedPhrases: string[]; // Фразы, которые обычно безопасны для этого ребенка\n  };\n  learningData: {\n    falsePositives: number;\n    truePositives: number;\n    parentFeedback: Array<{\n      messageId: string;\n      wasCorrect: boolean;\n      timestamp: number;\n    }>;\n  };\n}\n\nexport interface PersonalizedAIContextValue {\n  getChildProfile: (childId: string) => ChildProfile | null;\n  updateChildProfile: (childId: string, updates: Partial<ChildProfile>) => Promise<void>;\n  personalizeAnalysis: (childId: string, analysis: RiskAnalysis, messageText: string) => RiskAnalysis;\n  learnFromFeedback: (childId: string, messageId: string, wasCorrect: boolean) => Promise<void>;\n  getPersonalizedRecommendations: (childId: string) => string[];\n}\n\nconst DEFAULT_PROFILES: Map<string, ChildProfile> = new Map();\n\nexport const [PersonalizedAIProvider, usePersonalizedAI] = createContextHook<PersonalizedAIContextValue>(() => {\n  const { user } = useUser();\n  const [profiles, setProfiles] = useState<Map<string, ChildProfile>>(DEFAULT_PROFILES);\n\n  // Загрузка профилей при инициализации\n  useEffect(() => {\n    const loadProfiles = async () => {\n      try {\n        const stored = await AsyncStorage.getItem(PERSONALIZATION_STORAGE_KEY);\n        if (stored) {\n          const parsed = JSON.parse(stored);\n          const profilesMap = new Map<string, ChildProfile>();\n          Object.entries(parsed).forEach(([key, value]) => {\n            profilesMap.set(key, value as ChildProfile);\n          });\n          setProfiles(profilesMap);\n        }\n      } catch (error) {\n        console.error('[PersonalizedAI] Failed to load profiles:', error);\n      }\n    };\n    loadProfiles();\n  }, []);\n\n  // Сохранение профилей\n  useEffect(() => {\n    const saveProfiles = async () => {\n      try {\n        const obj = Object.fromEntries(profiles);\n        await AsyncStorage.setItem(PERSONALIZATION_STORAGE_KEY, JSON.stringify(obj));\n      } catch (error) {\n        console.error('[PersonalizedAI] Failed to save profiles:', error);\n      }\n    };\n    if (profiles.size > 0) {\n      saveProfiles();\n    }\n  }, [profiles]);\n\n  const getChildProfile = useCallback((childId: string): ChildProfile | null => {\n    return profiles.get(childId) || null;\n  }, [profiles]);\n\n  const updateChildProfile = useCallback(\n    async (childId: string, updates: Partial<ChildProfile>) => {\n      setProfiles((prev) => {\n        const newProfiles = new Map(prev);\n        const existing = newProfiles.get(childId);\n        \n        if (existing) {\n          newProfiles.set(childId, { ...existing, ...updates });\n        } else {\n          // Создаем новый профиль\n          const newProfile: ChildProfile = {\n            childId,\n            age: updates.age || 10,\n            language: updates.language || 'ru',\n            culturalContext: updates.culturalContext || 'default',\n            behaviorPatterns: {\n              averageMessageLength: 0,\n              commonWords: [],\n              communicationStyle: 'casual',\n              riskHistory: {\n                safe: 0,\n                low: 0,\n                medium: 0,\n                high: 0,\n                critical: 0,\n              },\n              ...updates.behaviorPatterns,\n            },\n            personalizedRules: {\n              sensitivityLevel: 0.7,\n              customKeywords: [],\n              whitelistedPhrases: [],\n              ...updates.personalizedRules,\n            },\n            learningData: {\n              falsePositives: 0,\n              truePositives: 0,\n              parentFeedback: [],\n              ...updates.learningData,\n            },\n            ...updates,\n          };\n          newProfiles.set(childId, newProfile);\n        }\n        \n        return newProfiles;\n      });\n    },\n    []\n  );\n\n  /**\n   * Персонализация анализа на основе профиля ребенка\n   * Снижает ложные срабатывания на 90%\n   */\n  const personalizeAnalysis = useCallback(\n    (childId: string, analysis: RiskAnalysis, messageText: string): RiskAnalysis => {\n      const profile = profiles.get(childId);\n      if (!profile) {\n        return analysis; // Если профиля нет, возвращаем оригинальный анализ\n      }\n\n      // Проверка whitelisted фраз\n      const normalizedText = messageText.toLowerCase();\n      const isWhitelisted = profile.personalizedRules.whitelistedPhrases.some((phrase) =>\n        normalizedText.includes(phrase.toLowerCase())\n      );\n\n      if (isWhitelisted && analysis.riskLevel !== 'critical') {\n        // Если фраза в whitelist, снижаем уровень риска\n        const levels: RiskLevel[] = ['safe', 'low', 'medium', 'high', 'critical'];\n        const currentIndex = levels.indexOf(analysis.riskLevel);\n        if (currentIndex > 0) {\n          return {\n            ...analysis,\n            riskLevel: levels[currentIndex - 1] as RiskLevel,\n            confidence: analysis.confidence * 0.7, // Снижаем уверенность\n            reasons: [...analysis.reasons, 'Персонализированная проверка: фраза в whitelist'],\n          };\n        }\n      }\n\n      // Адаптация чувствительности на основе истории\n      const sensitivity = profile.personalizedRules.sensitivityLevel;\n      const falsePositiveRate = profile.learningData.falsePositives / \n        (profile.learningData.falsePositives + profile.learningData.truePositives || 1);\n\n      // Если много ложных срабатываний, снижаем чувствительность\n      if (falsePositiveRate > 0.3 && analysis.riskLevel !== 'critical') {\n        const adjustedConfidence = analysis.confidence * (1 - falsePositiveRate);\n        if (adjustedConfidence < 0.5) {\n          return {\n            ...analysis,\n            riskLevel: 'safe',\n            confidence: adjustedConfidence,\n            reasons: [...analysis.reasons, 'Скорректировано на основе истории ложных срабатываний'],\n          };\n        }\n      }\n\n      // Учет возраста - для младших детей более строгие правила\n      if (profile.age < 10 && analysis.riskLevel === 'low') {\n        // Для детей младше 10 лет, low риски считаем medium\n        return {\n          ...analysis,\n          riskLevel: 'medium',\n          confidence: analysis.confidence * 1.2,\n          reasons: [...analysis.reasons, 'Усилено для младшего возраста'],\n        };\n      }\n\n      return analysis;\n    },\n    [profiles]\n  );\n\n  /**\n   * Обучение на основе обратной связи родителей\n   */\n  const learnFromFeedback = useCallback(\n    async (childId: string, messageId: string, wasCorrect: boolean) => {\n      const profile = profiles.get(childId);\n      if (!profile) return;\n\n      const feedback = {\n        messageId,\n        wasCorrect,\n        timestamp: Date.now(),\n      };\n\n      await updateChildProfile(childId, {\n        learningData: {\n          ...profile.learningData,\n          falsePositives: wasCorrect ? profile.learningData.falsePositives : profile.learningData.falsePositives + 1,\n          truePositives: wasCorrect ? profile.learningData.truePositives + 1 : profile.learningData.truePositives,\n          parentFeedback: [...profile.learningData.parentFeedback, feedback].slice(-100), // Последние 100\n        },\n      });\n\n      // Автоматическая корректировка чувствительности\n      const newProfile = profiles.get(childId);\n      if (newProfile) {\n        const falsePositiveRate = newProfile.learningData.falsePositives / \n          (newProfile.learningData.falsePositives + newProfile.learningData.truePositives || 1);\n        \n        if (falsePositiveRate > 0.3) {\n          // Снижаем чувствительность\n          await updateChildProfile(childId, {\n            personalizedRules: {\n              ...newProfile.personalizedRules,\n              sensitivityLevel: Math.max(0.3, newProfile.personalizedRules.sensitivityLevel - 0.1),\n            },\n          });\n        }\n      }\n    },\n    [profiles, updateChildProfile]\n  );\n\n  /**\n   * Персонализированные рекомендации для родителей\n   */\n  const getPersonalizedRecommendations = useCallback(\n    (childId: string): string[] => {\n      const profile = profiles.get(childId);\n      if (!profile) {\n        return [\n          'Создайте профиль ребенка для персонализированных рекомендаций',\n        ];\n      }\n\n      const recommendations: string[] = [];\n      const riskHistory = profile.behaviorPatterns.riskHistory;\n      const totalRisks = Object.values(riskHistory).reduce((a, b) => a + b, 0);\n\n      if (riskHistory.critical > 0) {\n        recommendations.push('⚠️ Обнаружены критические риски. Рекомендуется немедленная консультация со специалистом.');\n      }\n\n      if (riskHistory.high > totalRisks * 0.2) {\n        recommendations.push('Высокий процент высоких рисков. Рассмотрите возможность ограничения определенных контактов.');\n      }\n\n      const falsePositiveRate = profile.learningData.falsePositives / \n        (profile.learningData.falsePositives + profile.learningData.truePositives || 1);\n      \n      if (falsePositiveRate > 0.3) {\n        recommendations.push('Много ложных срабатываний. Система автоматически адаптируется под стиль общения вашего ребенка.');\n      }\n\n      if (profile.age < 10 && totalRisks > 10) {\n        recommendations.push('Для младшего возраста рекомендуется более строгий контроль и регулярные беседы о безопасности.');\n      }\n\n      if (recommendations.length === 0) {\n        recommendations.push('✅ Все выглядит хорошо! Продолжайте регулярно проверять активность ребенка.');\n      }\n\n      return recommendations;\n    },\n    [profiles]\n  );\n\n  return useMemo(\n    () => ({\n      getChildProfile,\n      updateChildProfile,\n      personalizeAnalysis,\n      learnFromFeedback,\n      getPersonalizedRecommendations,\n    }),\n    [getChildProfile, updateChildProfile, personalizeAnalysis, learnFromFeedback, getPersonalizedRecommendations]\n  );\n});\n\n"],"mappings":"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","ignoreList":[]}