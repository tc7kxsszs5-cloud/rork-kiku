{"version":3,"names":["isTimeRestricted","restrictions","currentTime","now","Date","dayOfWeek","getDay","currentHour","getHours","currentMinute","getMinutes","currentTimeMinutes","activeRestrictions","filter","r","enabled","length","isInAnyAllowedPeriod","some","restriction","startTime","startHour","startMinute","endTime","endHour","endMinute"],"sources":["timeRestrictions.ts"],"sourcesContent":["/**\n * Чистые детерминированные функции для проверки временных ограничений\n * Вынесено из ParentalControlsContext для модульного тестирования\n */\n\nexport interface TimeRestriction {\n  enabled: boolean;\n  dayOfWeek: number; // 0 = Sunday, 1 = Monday, ..., 6 = Saturday\n  startHour: number;\n  startMinute: number;\n  endHour: number;\n  endMinute: number;\n}\n\n/**\n * Проверяет, находится ли текущее время в пределах временного ограничения\n * Чистая детерминированная функция\n * \n * Логика: доступ ограничен если есть хотя бы одно активное ограничение для текущего дня,\n * и текущее время находится вне разрешенного периода этого ограничения.\n * Если есть несколько ограничений для одного дня, доступ разрешен если время попадает\n * в любой из разрешенных периодов.\n * \n * @param restrictions - Массив временных ограничений\n * @param currentTime - Текущее время (объект Date или timestamp)\n * @returns true если доступ ограничен (вне разрешенного времени)\n */\nexport function isTimeRestricted(\n  restrictions: TimeRestriction[],\n  currentTime: Date | number\n): boolean {\n  const now = currentTime instanceof Date ? currentTime : new Date(currentTime);\n  const dayOfWeek = now.getDay();\n  const currentHour = now.getHours();\n  const currentMinute = now.getMinutes();\n  const currentTimeMinutes = currentHour * 60 + currentMinute;\n\n  // Фильтруем активные ограничения для текущего дня\n  const activeRestrictions = restrictions.filter(\n    (r) => r.enabled && r.dayOfWeek === dayOfWeek\n  );\n\n  if (activeRestrictions.length === 0) {\n    return false; // Нет ограничений для этого дня\n  }\n\n  // Проверяем, попадает ли время в любой из разрешенных периодов\n  const isInAnyAllowedPeriod = activeRestrictions.some((restriction) => {\n    const startTime = restriction.startHour * 60 + restriction.startMinute;\n    const endTime = restriction.endHour * 60 + restriction.endMinute;\n\n    // Время в разрешенном периоде если: startTime <= currentTime < endTime\n    return currentTimeMinutes >= startTime && currentTimeMinutes < endTime;\n  });\n\n  // Доступ ограничен если время НЕ попадает ни в один разрешенный период\n  return !isInAnyAllowedPeriod;\n}\n"],"mappings":";;;;AA2BO,SAASA,gBAAgBA,CAC9BC,YAA+B,EAC/BC,WAA0B,EACjB;EACT,IAAMC,GAAG,GAAGD,WAAW,YAAYE,IAAI,GAAGF,WAAW,GAAG,IAAIE,IAAI,CAACF,WAAW,CAAC;EAC7E,IAAMG,SAAS,GAAGF,GAAG,CAACG,MAAM,CAAC,CAAC;EAC9B,IAAMC,WAAW,GAAGJ,GAAG,CAACK,QAAQ,CAAC,CAAC;EAClC,IAAMC,aAAa,GAAGN,GAAG,CAACO,UAAU,CAAC,CAAC;EACtC,IAAMC,kBAAkB,GAAGJ,WAAW,GAAG,EAAE,GAAGE,aAAa;EAG3D,IAAMG,kBAAkB,GAAGX,YAAY,CAACY,MAAM,CAC5C,UAACC,CAAC;IAAA,OAAKA,CAAC,CAACC,OAAO,IAAID,CAAC,CAACT,SAAS,KAAKA,SAAS;EAAA,CAC/C,CAAC;EAED,IAAIO,kBAAkB,CAACI,MAAM,KAAK,CAAC,EAAE;IACnC,OAAO,KAAK;EACd;EAGA,IAAMC,oBAAoB,GAAGL,kBAAkB,CAACM,IAAI,CAAC,UAACC,WAAW,EAAK;IACpE,IAAMC,SAAS,GAAGD,WAAW,CAACE,SAAS,GAAG,EAAE,GAAGF,WAAW,CAACG,WAAW;IACtE,IAAMC,OAAO,GAAGJ,WAAW,CAACK,OAAO,GAAG,EAAE,GAAGL,WAAW,CAACM,SAAS;IAGhE,OAAOd,kBAAkB,IAAIS,SAAS,IAAIT,kBAAkB,GAAGY,OAAO;EACxE,CAAC,CAAC;EAGF,OAAO,CAACN,oBAAoB;AAC9B","ignoreList":[]}