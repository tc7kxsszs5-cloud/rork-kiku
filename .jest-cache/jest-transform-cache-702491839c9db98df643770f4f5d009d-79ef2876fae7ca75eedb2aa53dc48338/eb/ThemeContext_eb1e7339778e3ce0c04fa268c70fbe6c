c44e1ff67a630c249d69b3d6f66012b3
import _asyncToGenerator from "@babel/runtime/helpers/asyncToGenerator";
import _slicedToArray from "@babel/runtime/helpers/slicedToArray";
import createContextHook from '@nkzw/create-context-hook';
import AsyncStorage from '@react-native-async-storage/async-storage';
import { useCallback, useEffect, useMemo, useState } from 'react';
import { lightThemeColors, darkThemeColors } from './ColorSystem';
import { logger } from '@/utils/logger';
var THEME_STORAGE_KEY = '@theme_mode_preference';
var createThemePalette = function createThemePalette(semanticColors, isDark) {
  return Object.assign({}, semanticColors, {
    backgroundPrimary: semanticColors.background.primary,
    backgroundSecondary: semanticColors.background.secondary,
    card: semanticColors.surface.primary,
    cardMuted: semanticColors.surface.muted,
    textPrimary: semanticColors.text.primary,
    textSecondary: semanticColors.text.secondary,
    accentPrimary: semanticColors.interactive.primary,
    accentMuted: semanticColors.interactive.secondary,
    borderSoft: semanticColors.border.muted,
    headerBackground: semanticColors.surface.elevated,
    headerText: semanticColors.text.primary,
    tabBarBackground: semanticColors.surface.elevated,
    tabBarActive: semanticColors.interactive.primary,
    tabBarInactive: semanticColors.text.tertiary,
    heroGradient: [semanticColors.background.primary, semanticColors.background.secondary],
    surfaceGradient: [semanticColors.surface.primary, semanticColors.surface.secondary],
    chipBackground: semanticColors.surface.secondary,
    chipText: semanticColors.text.primary,
    isDark: isDark,
    primary: semanticColors.interactive.primary,
    success: semanticColors.status.safe,
    warning: semanticColors.status.warning,
    danger: semanticColors.status.danger
  });
};
var THEMES = {
  sunrise: createThemePalette(lightThemeColors, false),
  midnight: createThemePalette(darkThemeColors, true)
};
var THEME_OPTIONS = [{
  value: 'sunrise',
  label: 'Теплый день',
  description: 'Теплый защищающий фон с яркими акцентами безопасности'
}, {
  value: 'midnight',
  label: 'Ночной режим',
  description: 'Глубокий темный фон с теплыми неоновыми акцентами'
}];
var _createContextHook = createContextHook(function () {
    var _useState = useState('sunrise'),
      _useState2 = _slicedToArray(_useState, 2),
      themeMode = _useState2[0],
      setThemeModeState = _useState2[1];
    var _useState3 = useState(false),
      _useState4 = _slicedToArray(_useState3, 2),
      isReady = _useState4[0],
      setIsReady = _useState4[1];
    useEffect(function () {
      var isMounted = true;
      var loadTheme = function () {
        var _ref = _asyncToGenerator(function* () {
          try {
            var storedMode = yield AsyncStorage.getItem(THEME_STORAGE_KEY);
            if (storedMode && (storedMode === 'sunrise' || storedMode === 'midnight') && isMounted) {
              setThemeModeState(storedMode);
              logger.info('Loaded mode from storage', {
                context: 'ThemeContext',
                action: 'loadTheme',
                mode: storedMode
              });
            }
          } catch (error) {
            logger.error('Failed to load theme mode', error instanceof Error ? error : new Error(String(error)), {
              context: 'ThemeContext',
              action: 'loadTheme'
            });
          } finally {
            if (isMounted) {
              setIsReady(true);
            }
          }
        });
        return function loadTheme() {
          return _ref.apply(this, arguments);
        };
      }();
      loadTheme();
      return function () {
        isMounted = false;
      };
    }, []);
    var persistMode = useCallback(function () {
      var _ref2 = _asyncToGenerator(function* (mode) {
        try {
          yield AsyncStorage.setItem(THEME_STORAGE_KEY, mode);
          console.log('[ThemeContext] Persisted theme mode', mode);
        } catch (error) {
          console.error('[ThemeContext] Failed to persist theme mode', error);
        }
      });
      return function (_x) {
        return _ref2.apply(this, arguments);
      };
    }(), []);
    var setThemeMode = useCallback(function (mode) {
      setThemeModeState(function (current) {
        return current === mode ? current : mode;
      });
      persistMode(mode).catch(function (error) {
        return logger.error('Failed to persist theme mode in setThemeMode', error instanceof Error ? error : new Error(String(error)), {
          context: 'ThemeContext',
          action: 'setThemeMode',
          mode: mode
        });
      });
    }, [persistMode]);
    var toggleThemeMode = useCallback(function () {
      setThemeMode(themeMode === 'sunrise' ? 'midnight' : 'sunrise');
    }, [setThemeMode, themeMode]);
    var value = useMemo(function () {
      return {
        themeMode: themeMode,
        theme: THEMES[themeMode],
        setThemeMode: setThemeMode,
        toggleThemeMode: toggleThemeMode,
        themeOptions: THEME_OPTIONS,
        isReady: isReady
      };
    }, [themeMode, setThemeMode, toggleThemeMode, isReady]);
    return value;
  }),
  _createContextHook2 = _slicedToArray(_createContextHook, 2),
  ThemeProvider = _createContextHook2[0],
  useThemeMode = _createContextHook2[1];
export { ThemeProvider, useThemeMode };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjcmVhdGVDb250ZXh0SG9vayIsIkFzeW5jU3RvcmFnZSIsInVzZUNhbGxiYWNrIiwidXNlRWZmZWN0IiwidXNlTWVtbyIsInVzZVN0YXRlIiwibGlnaHRUaGVtZUNvbG9ycyIsImRhcmtUaGVtZUNvbG9ycyIsImxvZ2dlciIsIlRIRU1FX1NUT1JBR0VfS0VZIiwiY3JlYXRlVGhlbWVQYWxldHRlIiwic2VtYW50aWNDb2xvcnMiLCJpc0RhcmsiLCJPYmplY3QiLCJhc3NpZ24iLCJiYWNrZ3JvdW5kUHJpbWFyeSIsImJhY2tncm91bmQiLCJwcmltYXJ5IiwiYmFja2dyb3VuZFNlY29uZGFyeSIsInNlY29uZGFyeSIsImNhcmQiLCJzdXJmYWNlIiwiY2FyZE11dGVkIiwibXV0ZWQiLCJ0ZXh0UHJpbWFyeSIsInRleHQiLCJ0ZXh0U2Vjb25kYXJ5IiwiYWNjZW50UHJpbWFyeSIsImludGVyYWN0aXZlIiwiYWNjZW50TXV0ZWQiLCJib3JkZXJTb2Z0IiwiYm9yZGVyIiwiaGVhZGVyQmFja2dyb3VuZCIsImVsZXZhdGVkIiwiaGVhZGVyVGV4dCIsInRhYkJhckJhY2tncm91bmQiLCJ0YWJCYXJBY3RpdmUiLCJ0YWJCYXJJbmFjdGl2ZSIsInRlcnRpYXJ5IiwiaGVyb0dyYWRpZW50Iiwic3VyZmFjZUdyYWRpZW50IiwiY2hpcEJhY2tncm91bmQiLCJjaGlwVGV4dCIsInN1Y2Nlc3MiLCJzdGF0dXMiLCJzYWZlIiwid2FybmluZyIsImRhbmdlciIsIlRIRU1FUyIsInN1bnJpc2UiLCJtaWRuaWdodCIsIlRIRU1FX09QVElPTlMiLCJ2YWx1ZSIsImxhYmVsIiwiZGVzY3JpcHRpb24iLCJfY3JlYXRlQ29udGV4dEhvb2siLCJfdXNlU3RhdGUiLCJfdXNlU3RhdGUyIiwiX3NsaWNlZFRvQXJyYXkiLCJ0aGVtZU1vZGUiLCJzZXRUaGVtZU1vZGVTdGF0ZSIsIl91c2VTdGF0ZTMiLCJfdXNlU3RhdGU0IiwiaXNSZWFkeSIsInNldElzUmVhZHkiLCJpc01vdW50ZWQiLCJsb2FkVGhlbWUiLCJfcmVmIiwiX2FzeW5jVG9HZW5lcmF0b3IiLCJzdG9yZWRNb2RlIiwiZ2V0SXRlbSIsImluZm8iLCJjb250ZXh0IiwiYWN0aW9uIiwibW9kZSIsImVycm9yIiwiRXJyb3IiLCJTdHJpbmciLCJhcHBseSIsImFyZ3VtZW50cyIsInBlcnNpc3RNb2RlIiwiX3JlZjIiLCJzZXRJdGVtIiwiY29uc29sZSIsImxvZyIsIl94Iiwic2V0VGhlbWVNb2RlIiwiY3VycmVudCIsImNhdGNoIiwidG9nZ2xlVGhlbWVNb2RlIiwidGhlbWUiLCJ0aGVtZU9wdGlvbnMiLCJfY3JlYXRlQ29udGV4dEhvb2syIiwiVGhlbWVQcm92aWRlciIsInVzZVRoZW1lTW9kZSJdLCJzb3VyY2VzIjpbIlRoZW1lQ29udGV4dC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyZWF0ZUNvbnRleHRIb29rIGZyb20gJ0Bua3p3L2NyZWF0ZS1jb250ZXh0LWhvb2snO1xuaW1wb3J0IEFzeW5jU3RvcmFnZSBmcm9tICdAcmVhY3QtbmF0aXZlLWFzeW5jLXN0b3JhZ2UvYXN5bmMtc3RvcmFnZSc7XG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VTdGF0ZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7IGxpZ2h0VGhlbWVDb2xvcnMsIGRhcmtUaGVtZUNvbG9ycywgU2VtYW50aWNDb2xvcnMgfSBmcm9tICcuL0NvbG9yU3lzdGVtJztcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJ0AvdXRpbHMvbG9nZ2VyJztcblxuZXhwb3J0IHR5cGUgVGhlbWVNb2RlID0gJ3N1bnJpc2UnIHwgJ21pZG5pZ2h0JztcblxuLyoqXG4gKiDQoNCw0YHRiNC40YDQtdC90L3QsNGPINC/0LDQu9C40YLRgNCwINGC0LXQvNGLINGBINGD0LvRg9GH0YjQtdC90L3QvtC5INGG0LLQtdGC0L7QstC+0Lkg0YHQuNGB0YLQtdC80L7QuVxuICovXG5leHBvcnQgaW50ZXJmYWNlIFRoZW1lUGFsZXR0ZSBleHRlbmRzIFNlbWFudGljQ29sb3JzIHtcbiAgLy8gTGVnYWN5INC/0L7QtNC00LXRgNC20LrQsCAo0LTQu9GPINC+0LHRgNCw0YLQvdC+0Lkg0YHQvtCy0LzQtdGB0YLQuNC80L7RgdGC0LgpXG4gIGJhY2tncm91bmRQcmltYXJ5OiBzdHJpbmc7XG4gIGJhY2tncm91bmRTZWNvbmRhcnk6IHN0cmluZztcbiAgY2FyZDogc3RyaW5nO1xuICBjYXJkTXV0ZWQ6IHN0cmluZztcbiAgdGV4dFByaW1hcnk6IHN0cmluZztcbiAgdGV4dFNlY29uZGFyeTogc3RyaW5nO1xuICBhY2NlbnRQcmltYXJ5OiBzdHJpbmc7XG4gIGFjY2VudE11dGVkOiBzdHJpbmc7XG4gIGJvcmRlclNvZnQ6IHN0cmluZztcbiAgaGVhZGVyQmFja2dyb3VuZDogc3RyaW5nO1xuICBoZWFkZXJUZXh0OiBzdHJpbmc7XG4gIHRhYkJhckJhY2tncm91bmQ6IHN0cmluZztcbiAgdGFiQmFyQWN0aXZlOiBzdHJpbmc7XG4gIHRhYkJhckluYWN0aXZlOiBzdHJpbmc7XG4gIGhlcm9HcmFkaWVudDogW3N0cmluZywgc3RyaW5nXTtcbiAgc3VyZmFjZUdyYWRpZW50OiBbc3RyaW5nLCBzdHJpbmddO1xuICBjaGlwQmFja2dyb3VuZDogc3RyaW5nO1xuICBjaGlwVGV4dDogc3RyaW5nO1xuICBpc0Rhcms6IGJvb2xlYW47XG4gIC8vINCj0LTQvtCx0L3Ri9C1INCw0LvQuNCw0YHRiyDQtNC70Y8g0YfQsNGB0YLQviDQuNGB0L/QvtC70YzQt9GD0LXQvNGL0YUg0YbQstC10YLQvtCyXG4gIHByaW1hcnk6IHN0cmluZztcbiAgc3VjY2Vzczogc3RyaW5nO1xuICB3YXJuaW5nOiBzdHJpbmc7XG4gIGRhbmdlcjogc3RyaW5nO1xufVxuXG5jb25zdCBUSEVNRV9TVE9SQUdFX0tFWSA9ICdAdGhlbWVfbW9kZV9wcmVmZXJlbmNlJztcblxuLyoqXG4gKiDQodC+0LfQtNCw0L3QuNC1INC/0L7Qu9C90L7QuSDQv9Cw0LvQuNGC0YDRiyDRgtC10LzRiyDQuNC3INGB0LXQvNCw0L3RgtC40YfQtdGB0LrQuNGFINGG0LLQtdGC0L7QslxuICovXG5jb25zdCBjcmVhdGVUaGVtZVBhbGV0dGUgPSAoc2VtYW50aWNDb2xvcnM6IFNlbWFudGljQ29sb3JzLCBpc0Rhcms6IGJvb2xlYW4pOiBUaGVtZVBhbGV0dGUgPT4ge1xuICByZXR1cm4ge1xuICAgIC4uLnNlbWFudGljQ29sb3JzLFxuICAgIC8vIExlZ2FjeSDQv9C+0LTQtNC10YDQttC60LBcbiAgICBiYWNrZ3JvdW5kUHJpbWFyeTogc2VtYW50aWNDb2xvcnMuYmFja2dyb3VuZC5wcmltYXJ5LFxuICAgIGJhY2tncm91bmRTZWNvbmRhcnk6IHNlbWFudGljQ29sb3JzLmJhY2tncm91bmQuc2Vjb25kYXJ5LFxuICAgIGNhcmQ6IHNlbWFudGljQ29sb3JzLnN1cmZhY2UucHJpbWFyeSxcbiAgICBjYXJkTXV0ZWQ6IHNlbWFudGljQ29sb3JzLnN1cmZhY2UubXV0ZWQsXG4gICAgdGV4dFByaW1hcnk6IHNlbWFudGljQ29sb3JzLnRleHQucHJpbWFyeSxcbiAgICB0ZXh0U2Vjb25kYXJ5OiBzZW1hbnRpY0NvbG9ycy50ZXh0LnNlY29uZGFyeSxcbiAgICBhY2NlbnRQcmltYXJ5OiBzZW1hbnRpY0NvbG9ycy5pbnRlcmFjdGl2ZS5wcmltYXJ5LFxuICAgIGFjY2VudE11dGVkOiBzZW1hbnRpY0NvbG9ycy5pbnRlcmFjdGl2ZS5zZWNvbmRhcnksXG4gICAgYm9yZGVyU29mdDogc2VtYW50aWNDb2xvcnMuYm9yZGVyLm11dGVkLFxuICAgIGhlYWRlckJhY2tncm91bmQ6IHNlbWFudGljQ29sb3JzLnN1cmZhY2UuZWxldmF0ZWQsXG4gICAgaGVhZGVyVGV4dDogc2VtYW50aWNDb2xvcnMudGV4dC5wcmltYXJ5LFxuICAgIHRhYkJhckJhY2tncm91bmQ6IHNlbWFudGljQ29sb3JzLnN1cmZhY2UuZWxldmF0ZWQsXG4gICAgdGFiQmFyQWN0aXZlOiBzZW1hbnRpY0NvbG9ycy5pbnRlcmFjdGl2ZS5wcmltYXJ5LFxuICAgIHRhYkJhckluYWN0aXZlOiBzZW1hbnRpY0NvbG9ycy50ZXh0LnRlcnRpYXJ5LFxuICAgIGhlcm9HcmFkaWVudDogW3NlbWFudGljQ29sb3JzLmJhY2tncm91bmQucHJpbWFyeSwgc2VtYW50aWNDb2xvcnMuYmFja2dyb3VuZC5zZWNvbmRhcnldLFxuICAgIHN1cmZhY2VHcmFkaWVudDogW3NlbWFudGljQ29sb3JzLnN1cmZhY2UucHJpbWFyeSwgc2VtYW50aWNDb2xvcnMuc3VyZmFjZS5zZWNvbmRhcnldLFxuICAgIGNoaXBCYWNrZ3JvdW5kOiBzZW1hbnRpY0NvbG9ycy5zdXJmYWNlLnNlY29uZGFyeSxcbiAgICBjaGlwVGV4dDogc2VtYW50aWNDb2xvcnMudGV4dC5wcmltYXJ5LFxuICAgIGlzRGFyayxcbiAgICAvLyDQo9C00L7QsdC90YvQtSDQsNC70LjQsNGB0YtcbiAgICBwcmltYXJ5OiBzZW1hbnRpY0NvbG9ycy5pbnRlcmFjdGl2ZS5wcmltYXJ5LFxuICAgIHN1Y2Nlc3M6IHNlbWFudGljQ29sb3JzLnN0YXR1cy5zYWZlLFxuICAgIHdhcm5pbmc6IHNlbWFudGljQ29sb3JzLnN0YXR1cy53YXJuaW5nLFxuICAgIGRhbmdlcjogc2VtYW50aWNDb2xvcnMuc3RhdHVzLmRhbmdlcixcbiAgfTtcbn07XG5cbmNvbnN0IFRIRU1FUzogUmVjb3JkPFRoZW1lTW9kZSwgVGhlbWVQYWxldHRlPiA9IHtcbiAgc3VucmlzZTogY3JlYXRlVGhlbWVQYWxldHRlKGxpZ2h0VGhlbWVDb2xvcnMsIGZhbHNlKSxcbiAgbWlkbmlnaHQ6IGNyZWF0ZVRoZW1lUGFsZXR0ZShkYXJrVGhlbWVDb2xvcnMsIHRydWUpLFxufTtcblxuLy8g0KPQvdC40LrQsNC70YzQvdGL0LUg0L3QsNC30LLQsNC90LjRjyDRgtC10Lwg0YEg0LrQvtC90YLQtdC60YHRgtC+0Lwg0LTQtdGC0YHQutC+0Lkg0LHQtdC30L7Qv9Cw0YHQvdC+0YHRgtC4XG5jb25zdCBUSEVNRV9PUFRJT05TOiB7IHZhbHVlOiBUaGVtZU1vZGU7IGxhYmVsOiBzdHJpbmc7IGRlc2NyaXB0aW9uOiBzdHJpbmcgfVtdID0gW1xuICB7XG4gICAgdmFsdWU6ICdzdW5yaXNlJyxcbiAgICBsYWJlbDogJ9Ci0LXQv9C70YvQuSDQtNC10L3RjCcsXG4gICAgZGVzY3JpcHRpb246ICfQotC10L/Qu9GL0Lkg0LfQsNGJ0LjRidCw0Y7RidC40Lkg0YTQvtC9INGBINGP0YDQutC40LzQuCDQsNC60YbQtdC90YLQsNC80Lgg0LHQtdC30L7Qv9Cw0YHQvdC+0YHRgtC4JyxcbiAgfSxcbiAge1xuICAgIHZhbHVlOiAnbWlkbmlnaHQnLFxuICAgIGxhYmVsOiAn0J3QvtGH0L3QvtC5INGA0LXQttC40LwnLFxuICAgIGRlc2NyaXB0aW9uOiAn0JPQu9GD0LHQvtC60LjQuSDRgtC10LzQvdGL0Lkg0YTQvtC9INGBINGC0LXQv9C70YvQvNC4INC90LXQvtC90L7QstGL0LzQuCDQsNC60YbQtdC90YLQsNC80LgnLFxuICB9LFxuXTtcblxuaW50ZXJmYWNlIFRoZW1lQ29udGV4dFZhbHVlIHtcbiAgdGhlbWVNb2RlOiBUaGVtZU1vZGU7XG4gIHRoZW1lOiBUaGVtZVBhbGV0dGU7XG4gIHNldFRoZW1lTW9kZTogKG1vZGU6IFRoZW1lTW9kZSkgPT4gdm9pZDtcbiAgdG9nZ2xlVGhlbWVNb2RlOiAoKSA9PiB2b2lkO1xuICB0aGVtZU9wdGlvbnM6IHR5cGVvZiBUSEVNRV9PUFRJT05TO1xuICBpc1JlYWR5OiBib29sZWFuO1xufVxuXG5leHBvcnQgY29uc3QgW1RoZW1lUHJvdmlkZXIsIHVzZVRoZW1lTW9kZV0gPSBjcmVhdGVDb250ZXh0SG9vazxUaGVtZUNvbnRleHRWYWx1ZT4oKCkgPT4ge1xuICBjb25zdCBbdGhlbWVNb2RlLCBzZXRUaGVtZU1vZGVTdGF0ZV0gPSB1c2VTdGF0ZTxUaGVtZU1vZGU+KCdzdW5yaXNlJyk7XG4gIGNvbnN0IFtpc1JlYWR5LCBzZXRJc1JlYWR5XSA9IHVzZVN0YXRlPGJvb2xlYW4+KGZhbHNlKTtcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGxldCBpc01vdW50ZWQgPSB0cnVlO1xuXG4gICAgY29uc3QgbG9hZFRoZW1lID0gYXN5bmMgKCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3Qgc3RvcmVkTW9kZSA9IGF3YWl0IEFzeW5jU3RvcmFnZS5nZXRJdGVtKFRIRU1FX1NUT1JBR0VfS0VZKTtcbiAgICAgICAgaWYgKHN0b3JlZE1vZGUgJiYgKHN0b3JlZE1vZGUgPT09ICdzdW5yaXNlJyB8fCBzdG9yZWRNb2RlID09PSAnbWlkbmlnaHQnKSAmJiBpc01vdW50ZWQpIHtcbiAgICAgICAgICBzZXRUaGVtZU1vZGVTdGF0ZShzdG9yZWRNb2RlKTtcbiAgICAgICAgICBsb2dnZXIuaW5mbygnTG9hZGVkIG1vZGUgZnJvbSBzdG9yYWdlJywgeyBjb250ZXh0OiAnVGhlbWVDb250ZXh0JywgYWN0aW9uOiAnbG9hZFRoZW1lJywgbW9kZTogc3RvcmVkTW9kZSB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gbG9hZCB0aGVtZSBtb2RlJywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6ICdUaGVtZUNvbnRleHQnLCBhY3Rpb246ICdsb2FkVGhlbWUnIH0pO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaWYgKGlzTW91bnRlZCkge1xuICAgICAgICAgIHNldElzUmVhZHkodHJ1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuXG4gICAgbG9hZFRoZW1lKCk7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaXNNb3VudGVkID0gZmFsc2U7XG4gICAgfTtcbiAgfSwgW10pO1xuXG4gIGNvbnN0IHBlcnNpc3RNb2RlID0gdXNlQ2FsbGJhY2soYXN5bmMgKG1vZGU6IFRoZW1lTW9kZSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBBc3luY1N0b3JhZ2Uuc2V0SXRlbShUSEVNRV9TVE9SQUdFX0tFWSwgbW9kZSk7XG4gICAgICBjb25zb2xlLmxvZygnW1RoZW1lQ29udGV4dF0gUGVyc2lzdGVkIHRoZW1lIG1vZGUnLCBtb2RlKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignW1RoZW1lQ29udGV4dF0gRmFpbGVkIHRvIHBlcnNpc3QgdGhlbWUgbW9kZScsIGVycm9yKTtcbiAgICB9XG4gIH0sIFtdKTtcblxuICBjb25zdCBzZXRUaGVtZU1vZGUgPSB1c2VDYWxsYmFjayhcbiAgICAobW9kZTogVGhlbWVNb2RlKSA9PiB7XG4gICAgICBzZXRUaGVtZU1vZGVTdGF0ZSgoY3VycmVudCkgPT4gKGN1cnJlbnQgPT09IG1vZGUgPyBjdXJyZW50IDogbW9kZSkpO1xuICAgICAgcGVyc2lzdE1vZGUobW9kZSkuY2F0Y2goKGVycm9yKSA9PiBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBwZXJzaXN0IHRoZW1lIG1vZGUgaW4gc2V0VGhlbWVNb2RlJywgZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpLCB7IGNvbnRleHQ6ICdUaGVtZUNvbnRleHQnLCBhY3Rpb246ICdzZXRUaGVtZU1vZGUnLCBtb2RlIH0pKTtcbiAgICB9LFxuICAgIFtwZXJzaXN0TW9kZV0sXG4gICk7XG5cbiAgY29uc3QgdG9nZ2xlVGhlbWVNb2RlID0gdXNlQ2FsbGJhY2soKCkgPT4ge1xuICAgIHNldFRoZW1lTW9kZSh0aGVtZU1vZGUgPT09ICdzdW5yaXNlJyA/ICdtaWRuaWdodCcgOiAnc3VucmlzZScpO1xuICB9LCBbc2V0VGhlbWVNb2RlLCB0aGVtZU1vZGVdKTtcblxuICBjb25zdCB2YWx1ZSA9IHVzZU1lbW88VGhlbWVDb250ZXh0VmFsdWU+KCgpID0+ICh7XG4gICAgdGhlbWVNb2RlLFxuICAgIHRoZW1lOiBUSEVNRVNbdGhlbWVNb2RlXSxcbiAgICBzZXRUaGVtZU1vZGUsXG4gICAgdG9nZ2xlVGhlbWVNb2RlLFxuICAgIHRoZW1lT3B0aW9uczogVEhFTUVfT1BUSU9OUyxcbiAgICBpc1JlYWR5LFxuICB9KSwgW3RoZW1lTW9kZSwgc2V0VGhlbWVNb2RlLCB0b2dnbGVUaGVtZU1vZGUsIGlzUmVhZHldKTtcblxuICByZXR1cm4gdmFsdWU7XG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPQSxpQkFBaUIsTUFBTSwyQkFBMkI7QUFDekQsT0FBT0MsWUFBWSxNQUFNLDJDQUEyQztBQUNwRSxTQUFTQyxXQUFXLEVBQUVDLFNBQVMsRUFBRUMsT0FBTyxFQUFFQyxRQUFRLFFBQVEsT0FBTztBQUNqRSxTQUFTQyxnQkFBZ0IsRUFBRUMsZUFBZSxRQUF3QixlQUFlO0FBQ2pGLFNBQVNDLE1BQU0sUUFBUSxnQkFBZ0I7QUFtQ3ZDLElBQU1DLGlCQUFpQixHQUFHLHdCQUF3QjtBQUtsRCxJQUFNQyxrQkFBa0IsR0FBRyxTQUFyQkEsa0JBQWtCQSxDQUFJQyxjQUE4QixFQUFFQyxNQUFlLEVBQW1CO0VBQzVGLE9BQUFDLE1BQUEsQ0FBQUMsTUFBQSxLQUNLSCxjQUFjO0lBRWpCSSxpQkFBaUIsRUFBRUosY0FBYyxDQUFDSyxVQUFVLENBQUNDLE9BQU87SUFDcERDLG1CQUFtQixFQUFFUCxjQUFjLENBQUNLLFVBQVUsQ0FBQ0csU0FBUztJQUN4REMsSUFBSSxFQUFFVCxjQUFjLENBQUNVLE9BQU8sQ0FBQ0osT0FBTztJQUNwQ0ssU0FBUyxFQUFFWCxjQUFjLENBQUNVLE9BQU8sQ0FBQ0UsS0FBSztJQUN2Q0MsV0FBVyxFQUFFYixjQUFjLENBQUNjLElBQUksQ0FBQ1IsT0FBTztJQUN4Q1MsYUFBYSxFQUFFZixjQUFjLENBQUNjLElBQUksQ0FBQ04sU0FBUztJQUM1Q1EsYUFBYSxFQUFFaEIsY0FBYyxDQUFDaUIsV0FBVyxDQUFDWCxPQUFPO0lBQ2pEWSxXQUFXLEVBQUVsQixjQUFjLENBQUNpQixXQUFXLENBQUNULFNBQVM7SUFDakRXLFVBQVUsRUFBRW5CLGNBQWMsQ0FBQ29CLE1BQU0sQ0FBQ1IsS0FBSztJQUN2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