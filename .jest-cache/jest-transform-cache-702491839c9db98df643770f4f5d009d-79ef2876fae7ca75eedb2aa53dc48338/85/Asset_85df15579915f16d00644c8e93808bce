523b539c605ca9106312576a1ef53c1d
var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard").default;
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Asset = exports.ANDROID_EMBEDDED_URL_BASE_RESOURCE = void 0;
var _asyncToGenerator2 = _interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _registry = require("@react-native/assets-registry/registry");
var _expoModulesCore = require("expo-modules-core");
var _AssetSources = require("./AssetSources");
var AssetUris = _interopRequireWildcard(require("./AssetUris"));
var _ExpoAsset = require("./ExpoAsset");
var ImageAssets = _interopRequireWildcard(require("./ImageAssets"));
var _LocalAssets = require("./LocalAssets");
var _PlatformUtils = require("./PlatformUtils");
var _resolveAssetSource2 = _interopRequireDefault(require("./resolveAssetSource"));
var ANDROID_EMBEDDED_URL_BASE_RESOURCE = exports.ANDROID_EMBEDDED_URL_BASE_RESOURCE = 'file:///android_res/';
var Asset = exports.Asset = function () {
  function Asset(_ref) {
    var name = _ref.name,
      type = _ref.type,
      _ref$hash = _ref.hash,
      hash = _ref$hash === void 0 ? null : _ref$hash,
      uri = _ref.uri,
      width = _ref.width,
      height = _ref.height;
    (0, _classCallCheck2.default)(this, Asset);
    this.hash = null;
    this.localUri = null;
    this.width = null;
    this.height = null;
    this.downloading = false;
    this.downloaded = false;
    this._downloadCallbacks = [];
    this.name = name;
    this.type = type;
    this.hash = hash;
    this.uri = uri;
    if (typeof width === 'number') {
      this.width = width;
    }
    if (typeof height === 'number') {
      this.height = height;
    }
    if (hash) {
      var _this$localUri;
      this.localUri = (0, _LocalAssets.getLocalAssetUri)(hash, type);
      if ((_this$localUri = this.localUri) != null && _this$localUri.startsWith(ANDROID_EMBEDDED_URL_BASE_RESOURCE)) {
        this.uri = this.localUri;
        this.localUri = null;
      } else if (this.localUri) {
        this.downloaded = true;
      }
    }
    if (_expoModulesCore.Platform.OS === 'web') {
      if (!name) {
        this.name = AssetUris.getFilename(uri);
      }
      if (!type) {
        this.type = AssetUris.getFileExtension(uri);
      }
    }
  }
  return (0, _createClass2.default)(Asset, [{
    key: "downloadAsync",
    value: function () {
      var _downloadAsync2 = (0, _asyncToGenerator2.default)(function* () {
        var _this = this;
        if (this.downloaded) {
          return this;
        }
        if (this.downloading) {
          yield new Promise(function (resolve, reject) {
            _this._downloadCallbacks.push({
              resolve: resolve,
              reject: reject
            });
          });
          return this;
        }
        this.downloading = true;
        try {
          if (_expoModulesCore.Platform.OS === 'web') {
            if (ImageAssets.isImageType(this.type)) {
              var _yield$ImageAssets$ge = yield ImageAssets.getImageInfoAsync(this.uri),
                width = _yield$ImageAssets$ge.width,
                height = _yield$ImageAssets$ge.height,
                name = _yield$ImageAssets$ge.name;
              this.width = width;
              this.height = height;
              this.name = name;
            } else {
              this.name = AssetUris.getFilename(this.uri);
            }
          }
          this.localUri = yield (0, _ExpoAsset.downloadAsync)(this.uri, this.hash, this.type);
          this.downloaded = true;
          this._downloadCallbacks.forEach(function (_ref2) {
            var resolve = _ref2.resolve;
            return resolve();
          });
        } catch (e) {
          this._downloadCallbacks.forEach(function (_ref3) {
            var reject = _ref3.reject;
            return reject(e);
          });
          throw e;
        } finally {
          this.downloading = false;
          this._downloadCallbacks = [];
        }
        return this;
      });
      function downloadAsync() {
        return _downloadAsync2.apply(this, arguments);
      }
      return downloadAsync;
    }()
  }], [{
    key: "loadAsync",
    value: function loadAsync(moduleId) {
      var moduleIds = Array.isArray(moduleId) ? moduleId : [moduleId];
      return Promise.all(moduleIds.map(function (moduleId) {
        return Asset.fromModule(moduleId).downloadAsync();
      }));
    }
  }, {
    key: "fromModule",
    value: function fromModule(virtualAssetModule) {
      if (typeof virtualAssetModule === 'string') {
        return Asset.fromURI(virtualAssetModule);
      }
      if (typeof virtualAssetModule === 'object' && 'uri' in virtualAssetModule && typeof virtualAssetModule.uri === 'string') {
        var extension = AssetUris.getFileExtension(virtualAssetModule.uri);
        return new Asset({
          name: '',
          type: extension.startsWith('.') ? extension.substring(1) : extension,
          hash: null,
          uri: virtualAssetModule.uri,
          width: virtualAssetModule.width,
          height: virtualAssetModule.height
        });
      }
      var meta = (0, _registry.getAssetByID)(virtualAssetModule);
      if (!meta) {
        throw new Error(`Module "${virtualAssetModule}" is missing from the asset registry`);
      }
      if (!_PlatformUtils.IS_ENV_WITH_LOCAL_ASSETS) {
        var _resolveAssetSource = (0, _resolveAssetSource2.default)(virtualAssetModule),
          uri = _resolveAssetSource.uri;
        var asset = new Asset({
          name: meta.name,
          type: meta.type,
          hash: meta.hash,
          uri: uri,
          width: meta.width,
          height: meta.height
        });
        if (_expoModulesCore.Platform.OS === 'android' && !uri.includes(':') && (meta.width || meta.height)) {
          asset.localUri = asset.uri;
          asset.downloaded = true;
        }
        Asset.byHash[meta.hash] = asset;
        return asset;
      }
      return Asset.fromMetadata(meta);
    }
  }, {
    key: "fromMetadata",
    value: function fromMetadata(meta) {
      var metaHash = meta.hash;
      var assetByHash = Asset.byHash[metaHash];
      if (assetByHash) {
        return assetByHash;
      }
      var _selectAssetSource = (0, _AssetSources.selectAssetSource)(meta),
        uri = _selectAssetSource.uri,
        hash = _selectAssetSource.hash;
      var asset = new Asset({
        name: meta.name,
        type: meta.type,
        hash: hash,
        uri: uri,
        width: meta.width,
        height: meta.height
      });
      Asset.byHash[metaHash] = asset;
      return asset;
    }
  }, {
    key: "fromURI",
    value: function fromURI(uri) {
      if (Asset.byUri[uri]) {
        return Asset.byUri[uri];
      }
      var type = '';
      if (uri.indexOf(';base64') > -1) {
        type = uri.split(';')[0].split('/')[1];
      } else {
        var extension = AssetUris.getFileExtension(uri);
        type = extension.startsWith('.') ? extension.substring(1) : extension;
      }
      var asset = new Asset({
        name: '',
        type: type,
        hash: null,
        uri: uri
      });
      Asset.byUri[uri] = asset;
      return asset;
    }
  }]);
}();
Asset.byHash = {};
Asset.byUri = {};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVnaXN0cnkiLCJyZXF1aXJlIiwiX2V4cG9Nb2R1bGVzQ29yZSIsIl9Bc3NldFNvdXJjZXMiLCJBc3NldFVyaXMiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIl9FeHBvQXNzZXQiLCJJbWFnZUFzc2V0cyIsIl9Mb2NhbEFzc2V0cyIsIl9QbGF0Zm9ybVV0aWxzIiwiX3Jlc29sdmVBc3NldFNvdXJjZTIiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiQU5EUk9JRF9FTUJFRERFRF9VUkxfQkFTRV9SRVNPVVJDRSIsImV4cG9ydHMiLCJBc3NldCIsIl9yZWYiLCJuYW1lIiwidHlwZSIsIl9yZWYkaGFzaCIsImhhc2giLCJ1cmkiLCJ3aWR0aCIsImhlaWdodCIsIl9jbGFzc0NhbGxDaGVjazIiLCJkZWZhdWx0IiwibG9jYWxVcmkiLCJkb3dubG9hZGluZyIsImRvd25sb2FkZWQiLCJfZG93bmxvYWRDYWxsYmFja3MiLCJfdGhpcyRsb2NhbFVyaSIsImdldExvY2FsQXNzZXRVcmkiLCJzdGFydHNXaXRoIiwiUGxhdGZvcm0iLCJPUyIsImdldEZpbGVuYW1lIiwiZ2V0RmlsZUV4dGVuc2lvbiIsIl9jcmVhdGVDbGFzczIiLCJrZXkiLCJ2YWx1ZSIsIl9kb3dubG9hZEFzeW5jMiIsIl9hc3luY1RvR2VuZXJhdG9yMiIsIl90aGlzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJwdXNoIiwiaXNJbWFnZVR5cGUiLCJfeWllbGQkSW1hZ2VBc3NldHMkZ2UiLCJnZXRJbWFnZUluZm9Bc3luYyIsImRvd25sb2FkQXN5bmMiLCJmb3JFYWNoIiwiX3JlZjIiLCJlIiwiX3JlZjMiLCJhcHBseSIsImFyZ3VtZW50cyIsImxvYWRBc3luYyIsIm1vZHVsZUlkIiwibW9kdWxlSWRzIiwiQXJyYXkiLCJpc0FycmF5IiwiYWxsIiwibWFwIiwiZnJvbU1vZHVsZSIsInZpcnR1YWxBc3NldE1vZHVsZSIsImZyb21VUkkiLCJleHRlbnNpb24iLCJzdWJzdHJpbmciLCJtZXRhIiwiZ2V0QXNzZXRCeUlEIiwiRXJyb3IiLCJJU19FTlZfV0lUSF9MT0NBTF9BU1NFVFMiLCJfcmVzb2x2ZUFzc2V0U291cmNlIiwicmVzb2x2ZUFzc2V0U291cmNlIiwiYXNzZXQiLCJpbmNsdWRlcyIsImJ5SGFzaCIsImZyb21NZXRhZGF0YSIsIm1ldGFIYXNoIiwiYXNzZXRCeUhhc2giLCJfc2VsZWN0QXNzZXRTb3VyY2UiLCJzZWxlY3RBc3NldFNvdXJjZSIsImJ5VXJpIiwiaW5kZXhPZiIsInNwbGl0Il0sInNvdXJjZXMiOlsiLi4vc3JjL0Fzc2V0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldEFzc2V0QnlJRCB9IGZyb20gJ0ByZWFjdC1uYXRpdmUvYXNzZXRzLXJlZ2lzdHJ5L3JlZ2lzdHJ5JztcbmltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAnZXhwby1tb2R1bGVzLWNvcmUnO1xuXG5pbXBvcnQgeyBBc3NldE1ldGFkYXRhLCBzZWxlY3RBc3NldFNvdXJjZSB9IGZyb20gJy4vQXNzZXRTb3VyY2VzJztcbmltcG9ydCAqIGFzIEFzc2V0VXJpcyBmcm9tICcuL0Fzc2V0VXJpcyc7XG5pbXBvcnQgeyBkb3dubG9hZEFzeW5jIH0gZnJvbSAnLi9FeHBvQXNzZXQnO1xuaW1wb3J0ICogYXMgSW1hZ2VBc3NldHMgZnJvbSAnLi9JbWFnZUFzc2V0cyc7XG5pbXBvcnQgeyBnZXRMb2NhbEFzc2V0VXJpIH0gZnJvbSAnLi9Mb2NhbEFzc2V0cyc7XG5pbXBvcnQgeyBJU19FTlZfV0lUSF9MT0NBTF9BU1NFVFMgfSBmcm9tICcuL1BsYXRmb3JtVXRpbHMnO1xuaW1wb3J0IHJlc29sdmVBc3NldFNvdXJjZSBmcm9tICcuL3Jlc29sdmVBc3NldFNvdXJjZSc7XG5cbi8vIEBkb2NzTWlzc2luZ1xuZXhwb3J0IHR5cGUgQXNzZXREZXNjcmlwdG9yID0ge1xuICBuYW1lOiBzdHJpbmc7XG4gIHR5cGU6IHN0cmluZztcbiAgaGFzaD86IHN0cmluZyB8IG51bGw7XG4gIHVyaTogc3RyaW5nO1xuICB3aWR0aD86IG51bWJlciB8IG51bGw7XG4gIGhlaWdodD86IG51bWJlciB8IG51bGw7XG59O1xuXG50eXBlIERvd25sb2FkUHJvbWlzZUNhbGxiYWNrcyA9IHtcbiAgcmVzb2x2ZTogKCkgPT4gdm9pZDtcbiAgcmVqZWN0OiAoZXJyb3I6IEVycm9yKSA9PiB2b2lkO1xufTtcblxuZXhwb3J0IHsgQXNzZXRNZXRhZGF0YSB9O1xuXG4vKipcbiAqIEFuZHJvaWQgcmVzb3VyY2UgVVJMIHByZWZpeC5cbiAqIEBoaWRkZW5cbiAqL1xuZXhwb3J0IGNvbnN0IEFORFJPSURfRU1CRURERURfVVJMX0JBU0VfUkVTT1VSQ0UgPSAnZmlsZTovLy9hbmRyb2lkX3Jlcy8nO1xuXG4vKipcbiAqIFRoZSBgQXNzZXRgIGNsYXNzIHJlcHJlc2VudHMgYW4gYXNzZXQgaW4geW91ciBhcHAuIEl0IGdpdmVzIG1ldGFkYXRhIGFib3V0IHRoZSBhc3NldCAoc3VjaCBhcyBpdHNcbiAqIG5hbWUgYW5kIHR5cGUpIGFuZCBwcm92aWRlcyBmYWNpbGl0aWVzIHRvIGxvYWQgdGhlIGFzc2V0IGRhdGEuXG4gKi9cbmV4cG9ydCBjbGFzcyBBc3NldCB7XG4gIHByaXZhdGUgc3RhdGljIGJ5SGFzaDogUmVjb3JkPHN0cmluZywgQXNzZXQgfCB1bmRlZmluZWQ+ID0ge307XG4gIHByaXZhdGUgc3RhdGljIGJ5VXJpOiBSZWNvcmQ8c3RyaW5nLCBBc3NldCB8IHVuZGVmaW5lZD4gPSB7fTtcblxuICAvKipcbiAgICogVGhlIG5hbWUgb2YgdGhlIGFzc2V0IGZpbGUgd2l0aG91dCB0aGUgZXh0ZW5zaW9uLiBBbHNvIHdpdGhvdXQgdGhlIHBhcnQgZnJvbSBgQGAgb253YXJkIGluIHRoZVxuICAgKiBmaWxlbmFtZSAodXNlZCB0byBzcGVjaWZ5IHNjYWxlIGZhY3RvciBmb3IgaW1hZ2VzKS5cbiAgICovXG4gIHB1YmxpYyBuYW1lOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgZXh0ZW5zaW9uIG9mIHRoZSBhc3NldCBmaWxlbmFtZS5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSB0eXBlOiBzdHJpbmc7XG4gIC8qKlxuICAgKiBUaGUgTUQ1IGhhc2ggb2YgdGhlIGFzc2V0J3MgZGF0YS5cbiAgICovXG4gIHB1YmxpYyByZWFkb25seSBoYXNoOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgLyoqXG4gICAqIEEgVVJJIHRoYXQgcG9pbnRzIHRvIHRoZSBhc3NldCdzIGRhdGEgb24gdGhlIHJlbW90ZSBzZXJ2ZXIuIFdoZW4gcnVubmluZyB0aGUgcHVibGlzaGVkIHZlcnNpb25cbiAgICogb2YgeW91ciBhcHAsIHRoaXMgcmVmZXJzIHRvIHRoZSBsb2NhdGlvbiBvbiBFeHBvJ3MgYXNzZXQgc2VydmVyIHdoZXJlIEV4cG8gaGFzIHN0b3JlZCB5b3VyXG4gICAqIGFzc2V0LiBXaGVuIHJ1bm5pbmcgdGhlIGFwcCBmcm9tIEV4cG8gQ0xJIGR1cmluZyBkZXZlbG9wbWVudCwgdGhpcyBVUkkgcG9pbnRzIHRvIEV4cG8gQ0xJJ3NcbiAgICogc2VydmVyIHJ1bm5pbmcgb24geW91ciBjb21wdXRlciBhbmQgdGhlIGFzc2V0IGlzIHNlcnZlZCBkaXJlY3RseSBmcm9tIHlvdXIgY29tcHV0ZXIuIElmIHlvdVxuICAgKiBhcmUgbm90IHVzaW5nIENsYXNzaWMgVXBkYXRlcyAobGVnYWN5KSwgdGhpcyBmaWVsZCBzaG91bGQgYmUgaWdub3JlZCBhcyB3ZSBlbnN1cmUgeW91ciBhc3NldHNcbiAgICogYXJlIG9uIGRldmljZSBiZWZvcmUgcnVubmluZyB5b3VyIGFwcGxpY2F0aW9uIGxvZ2ljLlxuICAgKi9cbiAgcHVibGljIHJlYWRvbmx5IHVyaTogc3RyaW5nO1xuICAvKipcbiAgICogSWYgdGhlIGFzc2V0IGhhcyBiZWVuIGRvd25sb2FkZWQgKGJ5IGNhbGxpbmcgW2Bkb3dubG9hZEFzeW5jKClgXSgjZG93bmxvYWRhc3luYykpLCB0aGVcbiAgICogYGZpbGU6Ly9gIFVSSSBwb2ludGluZyB0byB0aGUgbG9jYWwgZmlsZSBvbiB0aGUgZGV2aWNlIHRoYXQgY29udGFpbnMgdGhlIGFzc2V0IGRhdGEuXG4gICAqL1xuICBwdWJsaWMgbG9jYWxVcmk6IHN0cmluZyB8IG51bGwgPSBudWxsO1xuICAvKipcbiAgICogSWYgdGhlIGFzc2V0IGlzIGFuIGltYWdlLCB0aGUgd2lkdGggb2YgdGhlIGltYWdlIGRhdGEgZGl2aWRlZCBieSB0aGUgc2NhbGUgZmFjdG9yLiBUaGUgc2NhbGVcbiAgICogZmFjdG9yIGlzIHRoZSBudW1iZXIgYWZ0ZXIgYEBgIGluIHRoZSBmaWxlbmFtZSwgb3IgYDFgIGlmIG5vdCBwcmVzZW50LlxuICAgKi9cbiAgcHVibGljIHdpZHRoOiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgLyoqXG4gICAqIElmIHRoZSBhc3NldCBpcyBhbiBpbWFnZSwgdGhlIGhlaWdodCBvZiB0aGUgaW1hZ2UgZGF0YSBkaXZpZGVkIGJ5IHRoZSBzY2FsZSBmYWN0b3IuIFRoZSBzY2FsZSBmYWN0b3IgaXMgdGhlIG51bWJlciBhZnRlciBgQGAgaW4gdGhlIGZpbGVuYW1lLCBvciBgMWAgaWYgbm90IHByZXNlbnQuXG4gICAqL1xuICBwdWJsaWMgaGVpZ2h0OiBudW1iZXIgfCBudWxsID0gbnVsbDtcblxuICBwcml2YXRlIGRvd25sb2FkaW5nOiBib29sZWFuID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIFdoZXRoZXIgdGhlIGFzc2V0IGhhcyBmaW5pc2hlZCBkb3dubG9hZGluZyBmcm9tIGEgY2FsbCB0byBbYGRvd25sb2FkQXN5bmMoKWBdKCNkb3dubG9hZGFzeW5jKS5cbiAgICovXG4gIHB1YmxpYyBkb3dubG9hZGVkOiBib29sZWFuID0gZmFsc2U7XG5cbiAgcHJpdmF0ZSBfZG93bmxvYWRDYWxsYmFja3M6IERvd25sb2FkUHJvbWlzZUNhbGxiYWNrc1tdID0gW107XG5cbiAgY29uc3RydWN0b3IoeyBuYW1lLCB0eXBlLCBoYXNoID0gbnVsbCwgdXJpLCB3aWR0aCwgaGVpZ2h0IH06IEFzc2V0RGVzY3JpcHRvcikge1xuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgdGhpcy50eXBlID0gdHlwZTtcbiAgICB0aGlzLmhhc2ggPSBoYXNoO1xuICAgIHRoaXMudXJpID0gdXJpO1xuXG4gICAgaWYgKHR5cGVvZiB3aWR0aCA9PT0gJ251bWJlcicpIHtcbiAgICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBoZWlnaHQgPT09ICdudW1iZXInKSB7XG4gICAgICB0aGlzLmhlaWdodCA9IGhlaWdodDtcbiAgICB9XG5cbiAgICBpZiAoaGFzaCkge1xuICAgICAgdGhpcy5sb2NhbFVyaSA9IGdldExvY2FsQXNzZXRVcmkoaGFzaCwgdHlwZSk7XG4gICAgICBpZiAodGhpcy5sb2NhbFVyaT8uc3RhcnRzV2l0aChBTkRST0lEX0VNQkVEREVEX1VSTF9CQVNFX1JFU09VUkNFKSkge1xuICAgICAgICAvLyBUcmVhdCBBbmRyb2lkIGVtYmVkZGVkIHJlc291cmNlcyBhcyBub3QgZG93bmxvYWRlZCBzdGF0ZSwgYmVjYXVzZSB0aGUgdXJpIGlzIG5vdCBkaXJlY3QgYWNjZXNzaWJsZS5cbiAgICAgICAgdGhpcy51cmkgPSB0aGlzLmxvY2FsVXJpO1xuICAgICAgICB0aGlzLmxvY2FsVXJpID0gbnVsbDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5sb2NhbFVyaSkge1xuICAgICAgICB0aGlzLmRvd25sb2FkZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ3dlYicpIHtcbiAgICAgIGlmICghbmFtZSkge1xuICAgICAgICB0aGlzLm5hbWUgPSBBc3NldFVyaXMuZ2V0RmlsZW5hbWUodXJpKTtcbiAgICAgIH1cbiAgICAgIGlmICghdHlwZSkge1xuICAgICAgICB0aGlzLnR5cGUgPSBBc3NldFVyaXMuZ2V0RmlsZUV4dGVuc2lvbih1cmkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8vIEBuZWVkc0F1ZGl0XG4gIC8qKlxuICAgKiBBIGhlbHBlciB0aGF0IHdyYXBzIGBBc3NldC5mcm9tTW9kdWxlKG1vZHVsZSkuZG93bmxvYWRBc3luY2AgZm9yIGNvbnZlbmllbmNlLlxuICAgKiBAcGFyYW0gbW9kdWxlSWQgQW4gYXJyYXkgb2YgYHJlcXVpcmUoJ3BhdGgvdG8vZmlsZScpYCBvciBleHRlcm5hbCBuZXR3b3JrIFVSTHMuIENhbiBhbHNvIGJlXG4gICAqIGp1c3Qgb25lIG1vZHVsZSBvciBVUkwgd2l0aG91dCBhbiBBcnJheS5cbiAgICogQHJldHVybiBSZXR1cm5zIGEgUHJvbWlzZSB0aGF0IGZ1bGZpbGxzIHdpdGggYW4gYXJyYXkgb2YgYEFzc2V0YHMgd2hlbiB0aGUgYXNzZXQocykgaGFzIGJlZW5cbiAgICogc2F2ZWQgdG8gZGlzay5cbiAgICogQGV4YW1wbGVcbiAgICogYGBgdHNcbiAgICogY29uc3QgW3sgbG9jYWxVcmkgfV0gPSBhd2FpdCBBc3NldC5sb2FkQXN5bmMocmVxdWlyZSgnLi9hc3NldHMvc25hY2staWNvbi5wbmcnKSk7XG4gICAqIGBgYFxuICAgKi9cbiAgc3RhdGljIGxvYWRBc3luYyhtb2R1bGVJZDogbnVtYmVyIHwgbnVtYmVyW10gfCBzdHJpbmcgfCBzdHJpbmdbXSk6IFByb21pc2U8QXNzZXRbXT4ge1xuICAgIGNvbnN0IG1vZHVsZUlkcyA9IEFycmF5LmlzQXJyYXkobW9kdWxlSWQpID8gbW9kdWxlSWQgOiBbbW9kdWxlSWRdO1xuICAgIHJldHVybiBQcm9taXNlLmFsbChtb2R1bGVJZHMubWFwKChtb2R1bGVJZCkgPT4gQXNzZXQuZnJvbU1vZHVsZShtb2R1bGVJZCkuZG93bmxvYWRBc3luYygpKSk7XG4gIH1cblxuICAvLyBAbmVlZHNBdWRpdFxuICAvKipcbiAgICogUmV0dXJucyB0aGUgW2BBc3NldGBdKCNhc3NldCkgaW5zdGFuY2UgcmVwcmVzZW50aW5nIGFuIGFzc2V0IGdpdmVuIGl0cyBtb2R1bGUgb3IgVVJMLlxuICAgKiBAcGFyYW0gdmlydHVhbEFzc2V0TW9kdWxlIFRoZSB2YWx1ZSBvZiBgcmVxdWlyZSgncGF0aC90by9maWxlJylgIGZvciB0aGUgYXNzZXQgb3IgZXh0ZXJuYWxcbiAgICogbmV0d29yayBVUkxcbiAgICogQHJldHVybiBUaGUgW2BBc3NldGBdKCNhc3NldCkgaW5zdGFuY2UgZm9yIHRoZSBhc3NldC5cbiAgICovXG4gIHN0YXRpYyBmcm9tTW9kdWxlKFxuICAgIHZpcnR1YWxBc3NldE1vZHVsZTogbnVtYmVyIHwgc3RyaW5nIHwgeyB1cmk6IHN0cmluZzsgd2lkdGg6IG51bWJlcjsgaGVpZ2h0OiBudW1iZXIgfVxuICApOiBBc3NldCB7XG4gICAgaWYgKHR5cGVvZiB2aXJ0dWFsQXNzZXRNb2R1bGUgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gQXNzZXQuZnJvbVVSSSh2aXJ0dWFsQXNzZXRNb2R1bGUpO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICB0eXBlb2YgdmlydHVhbEFzc2V0TW9kdWxlID09PSAnb2JqZWN0JyAmJlxuICAgICAgJ3VyaScgaW4gdmlydHVhbEFzc2V0TW9kdWxlICYmXG4gICAgICB0eXBlb2YgdmlydHVhbEFzc2V0TW9kdWxlLnVyaSA9PT0gJ3N0cmluZydcbiAgICApIHtcbiAgICAgIGNvbnN0IGV4dGVuc2lvbiA9IEFzc2V0VXJpcy5nZXRGaWxlRXh0ZW5zaW9uKHZpcnR1YWxBc3NldE1vZHVsZS51cmkpO1xuICAgICAgcmV0dXJuIG5ldyBBc3NldCh7XG4gICAgICAgIG5hbWU6ICcnLFxuICAgICAgICB0eXBlOiBleHRlbnNpb24uc3RhcnRzV2l0aCgnLicpID8gZXh0ZW5zaW9uLnN1YnN0cmluZygxKSA6IGV4dGVuc2lvbixcbiAgICAgICAgaGFzaDogbnVsbCxcbiAgICAgICAgdXJpOiB2aXJ0dWFsQXNzZXRNb2R1bGUudXJpLFxuICAgICAgICB3aWR0aDogdmlydHVhbEFzc2V0TW9kdWxlLndpZHRoLFxuICAgICAgICBoZWlnaHQ6IHZpcnR1YWxBc3NldE1vZHVsZS5oZWlnaHQsXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBtZXRhID0gZ2V0QXNzZXRCeUlEKHZpcnR1YWxBc3NldE1vZHVsZSk7XG4gICAgaWYgKCFtZXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE1vZHVsZSBcIiR7dmlydHVhbEFzc2V0TW9kdWxlfVwiIGlzIG1pc3NpbmcgZnJvbSB0aGUgYXNzZXQgcmVnaXN0cnlgKTtcbiAgICB9XG5cbiAgICAvLyBPdXRzaWRlIG9mIHRoZSBtYW5hZ2VkIGVudiB3ZSBuZWVkIHRoZSBtb2R1bGVJZCB0byBpbml0aWFsaXplIHRoZSBhc3NldFxuICAgIC8vIGJlY2F1c2UgcmVzb2x2ZUFzc2V0U291cmNlIGRlcGVuZHMgb24gaXRcbiAgICBpZiAoIUlTX0VOVl9XSVRIX0xPQ0FMX0FTU0VUUykge1xuICAgICAgLy8gbnVsbC1jaGVjayBpcyBwZXJmb3JtZWQgYWJvdmUgd2l0aCBgZ2V0QXNzZXRCeUlEYC5cbiAgICAgIGNvbnN0IHsgdXJpIH0gPSByZXNvbHZlQXNzZXRTb3VyY2UodmlydHVhbEFzc2V0TW9kdWxlKSE7XG5cbiAgICAgIGNvbnN0IGFzc2V0ID0gbmV3IEFzc2V0KHtcbiAgICAgICAgbmFtZTogbWV0YS5uYW1lLFxuICAgICAgICB0eXBlOiBtZXRhLnR5cGUsXG4gICAgICAgIGhhc2g6IG1ldGEuaGFzaCxcbiAgICAgICAgdXJpLFxuICAgICAgICB3aWR0aDogbWV0YS53aWR0aCxcbiAgICAgICAgaGVpZ2h0OiBtZXRhLmhlaWdodCxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBGb3IgaW1hZ2VzIGJhY2t3YXJkIGNvbXBhdGliaWxpdHksXG4gICAgICAvLyBrZWVwcyBsb2NhbFVyaSB0aGUgc2FtZSBhcyB1cmkgZm9yIFJlYWN0IE5hdGl2ZSdzIEltYWdlIHRoYXRcbiAgICAgIC8vIHdvcmtzIGZpbmUgd2l0aCBkcmF3YWJsZSByZXNvdXJjZSBuYW1lcy5cbiAgICAgIGlmIChQbGF0Zm9ybS5PUyA9PT0gJ2FuZHJvaWQnICYmICF1cmkuaW5jbHVkZXMoJzonKSAmJiAobWV0YS53aWR0aCB8fCBtZXRhLmhlaWdodCkpIHtcbiAgICAgICAgYXNzZXQubG9jYWxVcmkgPSBhc3NldC51cmk7XG4gICAgICAgIGFzc2V0LmRvd25sb2FkZWQgPSB0cnVlO1xuICAgICAgfVxuXG4gICAgICBBc3NldC5ieUhhc2hbbWV0YS5oYXNoXSA9IGFzc2V0O1xuICAgICAgcmV0dXJuIGFzc2V0O1xuICAgIH1cblxuICAgIHJldHVybiBBc3NldC5mcm9tTWV0YWRhdGEobWV0YSk7XG4gIH1cblxuICAvLyBAZG9jc01pc3NpbmdcbiAgc3RhdGljIGZyb21NZXRhZGF0YShtZXRhOiBBc3NldE1ldGFkYXRhKTogQXNzZXQge1xuICAgIC8vIFRoZSBoYXNoIG9mIHRoZSB3aG9sZSBhc3NldCwgbm90IHRvIGJlIGNvbmZ1c2VkIHdpdGggdGhlIGhhc2ggb2YgYSBzcGVjaWZpYyBmaWxlIHJldHVybmVkXG4gICAgLy8gZnJvbSBgc2VsZWN0QXNzZXRTb3VyY2VgXG4gICAgY29uc3QgbWV0YUhhc2ggPSBtZXRhLmhhc2g7XG4gICAgY29uc3QgYXNzZXRCeUhhc2ggPSBBc3NldC5ieUhhc2hbbWV0YUhhc2hdO1xuICAgIGlmIChhc3NldEJ5SGFzaCkge1xuICAgICAgcmV0dXJuIGFzc2V0QnlIYXNoO1xuICAgIH1cblxuICAgIGNvbnN0IHsgdXJpLCBoYXNoIH0gPSBzZWxlY3RBc3NldFNvdXJjZShtZXRhKTtcbiAgICBjb25zdCBhc3NldCA9IG5ldyBBc3NldCh7XG4gICAgICBuYW1lOiBtZXRhLm5hbWUsXG4gICAgICB0eXBlOiBtZXRhLnR5cGUsXG4gICAgICBoYXNoLFxuICAgICAgdXJpLFxuICAgICAgd2lkdGg6IG1ldGEud2lkdGgsXG4gICAgICBoZWlnaHQ6IG1ldGEuaGVpZ2h0LFxuICAgIH0pO1xuICAgIEFzc2V0LmJ5SGFzaFttZXRhSGFzaF0gPSBhc3NldDtcbiAgICByZXR1cm4gYXNzZXQ7XG4gIH1cblxuICAvLyBAZG9jc01pc3NpbmdcbiAgc3RhdGljIGZyb21VUkkodXJpOiBzdHJpbmcpOiBBc3NldCB7XG4gICAgaWYgKEFzc2V0LmJ5VXJpW3VyaV0pIHtcbiAgICAgIHJldHVybiBBc3NldC5ieVVyaVt1cmldO1xuICAgIH1cblxuICAgIC8vIFBvc3NpYmx5IGEgQmFzZTY0LWVuY29kZWQgVVJJXG4gICAgbGV0IHR5cGUgPSAnJztcbiAgICBpZiAodXJpLmluZGV4T2YoJztiYXNlNjQnKSA+IC0xKSB7XG4gICAgICB0eXBlID0gdXJpLnNwbGl0KCc7JylbMF0uc3BsaXQoJy8nKVsxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZXh0ZW5zaW9uID0gQXNzZXRVcmlzLmdldEZpbGVFeHRlbnNpb24odXJpKTtcbiAgICAgIHR5cGUgPSBleHRlbnNpb24uc3RhcnRzV2l0aCgnLicpID8gZXh0ZW5zaW9uLnN1YnN0cmluZygxKSA6IGV4dGVuc2lvbjtcbiAgICB9XG5cbiAgICBjb25zdCBhc3NldCA9IG5ldyBBc3NldCh7XG4gICAgICBuYW1lOiAnJyxcbiAgICAgIHR5cGUsXG4gICAgICBoYXNoOiBudWxsLFxuICAgICAgdXJpLFxuICAgIH0pO1xuXG4gICAgQXNzZXQuYnlVcmlbdXJpXSA9IGFzc2V0O1xuXG4gICAgcmV0dXJuIGFzc2V0O1xuICB9XG5cbiAgLy8gQG5lZWRzQXVkaXRcbiAgLyoqXG4gICAqIERvd25sb2FkcyB0aGUgYXNzZXQgZGF0YSB0byBhIGxvY2FsIGZpbGUgaW4gdGhlIGRldmljZSdzIGNhY2hlIGRpcmVjdG9yeS4gT25jZSB0aGUgcmV0dXJuZWRcbiAgICogcHJvbWlzZSBpcyBmdWxmaWxsZWQgd2l0aG91dCBlcnJvciwgdGhlIFtgbG9jYWxVcmlgXSgjbG9jYWx1cmkpIGZpZWxkIG9mIHRoaXMgYXNzZXQgcG9pbnRzXG4gICAqIHRvIGEgbG9jYWwgZmlsZSBjb250YWluaW5nIHRoZSBhc3NldCBkYXRhLiBUaGUgYXNzZXQgaXMgb25seSBkb3dubG9hZGVkIGlmIGFuIHVwLXRvLWRhdGUgbG9jYWxcbiAgICogZmlsZSBmb3IgdGhlIGFzc2V0IGlzbid0IGFscmVhZHkgcHJlc2VudCBkdWUgdG8gYW4gZWFybGllciBkb3dubG9hZC4gVGhlIGRvd25sb2FkZWQgYEFzc2V0YFxuICAgKiB3aWxsIGJlIHJldHVybmVkIHdoZW4gdGhlIHByb21pc2UgaXMgcmVzb2x2ZWQuXG4gICAqXG4gICAqID4gKipOb3RlOioqIFRoZXJlIGlzIG5vIGd1YXJhbnRlZSB0aGF0IGZpbGVzIGRvd25sb2FkZWQgdmlhIGBkb3dubG9hZEFzeW5jYCBwZXJzaXN0IGJldHdlZW4gYXBwIHNlc3Npb25zLlxuICAgKiBgZG93bmxvYWRBc3luY2Agc3RvcmVzIGZpbGVzIGluIHRoZSBjYWNoZXMgZGlyZWN0b3J5LCBzbyBpdCdzIHVwIHRvIHRoZSBPUyB0byBjbGVhciB0aGlzIGZvbGRlciBhdCBpdHNcbiAgICogb3duIGRpc2NyZXRpb24gb3Igd2hlbiB0aGUgdXNlciBtYW51YWxseSBwdXJnZXMgdGhlIGNhY2hlcyBkaXJlY3RvcnkuIERvd25sb2FkZWQgYXNzZXRzIGFyZSBzdG9yZWQgYXNcbiAgICogYEV4cG9uZW50QXNzZXQte2NhY2hlRmlsZUlkfS57ZXh0ZW5zaW9ufWAgd2l0aGluIHRoZSBjYWNoZSBkaXJlY3RvcnkuXG4gICAqID4gVG8gbWFudWFsbHkgY2xlYXIgY2FjaGVkIGFzc2V0cywgeW91IGNhbiB1c2UgW2BleHBvLWZpbGUtc3lzdGVtYF0oLi9maWxlc3lzdGVtLykgdG9cbiAgICogZGVsZXRlIHRoZSBjYWNoZSBkaXJlY3Rvcnk6IGBQYXRocy5jYWNoZS5kZWxldGUoKWAgb3IgdXNlIHRoZSBsZWdhY3kgQVBJIGBkZWxldGVBc3luYyhjYWNoZURpcmVjdG9yeSlgLlxuICAgKlxuICAgKiBAcmV0dXJuIFJldHVybnMgYSBQcm9taXNlIHdoaWNoIGZ1bGZpbGxzIHdpdGggYW4gYEFzc2V0YCBpbnN0YW5jZS5cbiAgICovXG4gIGFzeW5jIGRvd25sb2FkQXN5bmMoKTogUHJvbWlzZTx0aGlzPiB7XG4gICAgaWYgKHRoaXMuZG93bmxvYWRlZCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGlmICh0aGlzLmRvd25sb2FkaW5nKSB7XG4gICAgICBhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIHRoaXMuX2Rvd25sb2FkQ2FsbGJhY2tzLnB1c2goeyByZXNvbHZlLCByZWplY3QgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICB0aGlzLmRvd25sb2FkaW5nID0gdHJ1ZTtcblxuICAgIHRyeSB7XG4gICAgICBpZiAoUGxhdGZvcm0uT1MgPT09ICd3ZWInKSB7XG4gICAgICAgIGlmIChJbWFnZUFzc2V0cy5pc0ltYWdlVHlwZSh0aGlzLnR5cGUpKSB7XG4gICAgICAgICAgY29uc3QgeyB3aWR0aCwgaGVpZ2h0LCBuYW1lIH0gPSBhd2FpdCBJbWFnZUFzc2V0cy5nZXRJbWFnZUluZm9Bc3luYyh0aGlzLnVyaSk7XG4gICAgICAgICAgdGhpcy53aWR0aCA9IHdpZHRoO1xuICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gaGVpZ2h0O1xuICAgICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5uYW1lID0gQXNzZXRVcmlzLmdldEZpbGVuYW1lKHRoaXMudXJpKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5sb2NhbFVyaSA9IGF3YWl0IGRvd25sb2FkQXN5bmModGhpcy51cmksIHRoaXMuaGFzaCwgdGhpcy50eXBlKTtcblxuICAgICAgdGhpcy5kb3dubG9hZGVkID0gdHJ1ZTtcbiAgICAgIHRoaXMuX2Rvd25sb2FkQ2FsbGJhY2tzLmZvckVhY2goKHsgcmVzb2x2ZSB9KSA9PiByZXNvbHZlKCkpO1xuICAgIH0gY2F0Y2ggKGU6IGFueSkge1xuICAgICAgdGhpcy5fZG93bmxvYWRDYWxsYmFja3MuZm9yRWFjaCgoeyByZWplY3QgfSkgPT4gcmVqZWN0KGUpKTtcbiAgICAgIHRocm93IGU7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuZG93bmxvYWRpbmcgPSBmYWxzZTtcbiAgICAgIHRoaXMuX2Rvd25sb2FkQ2FsbGJhY2tzID0gW107XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLGdCQUFBLEdBQUFELE9BQUE7QUFFQSxJQUFBRSxhQUFBLEdBQUFGLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFDLHVCQUFBLENBQUFKLE9BQUE7QUFDQSxJQUFBSyxVQUFBLEdBQUFMLE9BQUE7QUFDQSxJQUFBTSxXQUFBLEdBQUFGLHVCQUFBLENBQUFKLE9BQUE7QUFDQSxJQUFBTyxZQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxjQUFBLEdBQUFSLE9BQUE7QUFDQSxJQUFBUyxvQkFBQSxHQUFBQyxzQkFBQSxDQUFBVixPQUFBO0FBdUJPLElBQU1XLGtDQUFrQyxHQUFBQyxPQUFBLENBQUFELGtDQUFBLEdBQUcsc0JBQXNCO0FBQUMsSUFNNURFLEtBQUssR0FBQUQsT0FBQSxDQUFBQyxLQUFBO0VBa0RoQixTQUFBQSxNQUFBQyxJQUFBLEVBQTRFO0lBQUEsSUFBOURDLElBQUksR0FBQUQsSUFBQSxDQUFKQyxJQUFJO01BQUVDLElBQUksR0FBQUYsSUFBQSxDQUFKRSxJQUFJO01BQUFDLFNBQUEsR0FBQUgsSUFBQSxDQUFFSSxJQUFJO01BQUpBLElBQUksR0FBQUQsU0FBQSxjQUFHLElBQUksR0FBQUEsU0FBQTtNQUFFRSxHQUFHLEdBQUFMLElBQUEsQ0FBSEssR0FBRztNQUFFQyxLQUFLLEdBQUFOLElBQUEsQ0FBTE0sS0FBSztNQUFFQyxNQUFNLEdBQUFQLElBQUEsQ0FBTk8sTUFBTTtJQUFBLElBQUFDLGdCQUFBLENBQUFDLE9BQUEsUUFBQVYsS0FBQTtJQUFBLEtBbEN6Q0ssSUFBSSxHQUFrQixJQUFJO0lBQUEsS0FjbkNNLFFBQVEsR0FBa0IsSUFBSTtJQUFBLEtBSzlCSixLQUFLLEdBQWtCLElBQUk7SUFBQSxLQUkzQkMsTUFBTSxHQUFrQixJ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