{"version":3,"names":["createContextHook","useState","useEffect","useCallback","AsyncStorage","Platform","SYNC_SETTINGS_STORAGE_KEY","cov_2hr6wd9dty","s","DEFAULT_SYNC_SETTINGS","autoSyncEnabled","frequency","source","_ref","f","_ref3","_ref4","_slicedToArray","settings","setSettings","_ref5","_ref6","isLoading","setIsLoading","_ref7","_ref8","isSyncing","setIsSyncing","isMounted","timer","loadSettings","_ref9","_asyncToGenerator","stored","getItem","b","parsedSettings","JSON","parse","Object","assign","error","console","apply","arguments","OS","setTimeout","clearTimeout","updateSettings","_ref10","updates","updatedSettings","setItem","stringify","log","_x","triggerSync","prev","lastSyncStatus","Promise","resolve","lastSyncTimestamp","Date","now","_ref2","SyncSettingsProvider","useSyncSettings"],"sources":["SyncSettingsContext.tsx"],"sourcesContent":["import createContextHook from '@nkzw/create-context-hook';\nimport { useState, useEffect, useCallback } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Platform } from 'react-native';\n\nexport type SyncFrequency = 'realtime' | '5min' | '15min' | '1hour';\nexport type SyncSource = 'local' | 'cloud';\n\nexport interface SyncSettings {\n  autoSyncEnabled: boolean;\n  frequency: SyncFrequency;\n  source: SyncSource;\n  lastSyncTimestamp?: number;\n  lastSyncStatus?: 'success' | 'error' | 'pending';\n}\n\nconst SYNC_SETTINGS_STORAGE_KEY = '@sync_settings';\n\nconst DEFAULT_SYNC_SETTINGS: SyncSettings = {\n  autoSyncEnabled: true,\n  frequency: 'realtime',\n  source: 'cloud',\n};\n\nexport const [SyncSettingsProvider, useSyncSettings] = createContextHook(() => {\n  const [settings, setSettings] = useState<SyncSettings>(DEFAULT_SYNC_SETTINGS);\n  const [isLoading, setIsLoading] = useState(true);\n  const [isSyncing, setIsSyncing] = useState(false);\n\n  useEffect(() => {\n    let isMounted = true;\n    let timer: ReturnType<typeof setTimeout> | undefined;\n\n    const loadSettings = async () => {\n      try {\n        const stored = await AsyncStorage.getItem(SYNC_SETTINGS_STORAGE_KEY);\n        if (!isMounted) {\n          return;\n        }\n        if (stored) {\n          const parsedSettings = JSON.parse(stored);\n          setSettings({ ...DEFAULT_SYNC_SETTINGS, ...parsedSettings });\n        }\n      } catch (error) {\n        console.error('[SyncSettingsContext] Error loading settings:', error);\n      } finally {\n        if (isMounted) {\n          setIsLoading(false);\n        }\n      }\n    };\n\n    if (Platform.OS !== 'web') {\n      loadSettings();\n    } else {\n      timer = setTimeout(loadSettings, 0);\n    }\n\n    return () => {\n      isMounted = false;\n      if (timer) {\n        clearTimeout(timer);\n      }\n    };\n  }, []);\n\n  const updateSettings = useCallback(async (updates: Partial<SyncSettings>) => {\n    try {\n      const updatedSettings = { ...settings, ...updates };\n      setSettings(updatedSettings);\n      await AsyncStorage.setItem(SYNC_SETTINGS_STORAGE_KEY, JSON.stringify(updatedSettings));\n      console.log('[SyncSettingsContext] Settings updated:', updates);\n    } catch (error) {\n      console.error('[SyncSettingsContext] Error updating settings:', error);\n    }\n  }, [settings]);\n\n  const triggerSync = useCallback(async () => {\n    if (isSyncing) {\n      return;\n    }\n\n    setIsSyncing(true);\n    setSettings(prev => ({ ...prev, lastSyncStatus: 'pending' }));\n\n    try {\n      // Здесь будет логика синхронизации с backend\n      // Пока что просто имитируем задержку\n      await new Promise(resolve => setTimeout(resolve, 1500));\n\n      const updatedSettings: SyncSettings = {\n        ...settings,\n        lastSyncTimestamp: Date.now(),\n        lastSyncStatus: 'success',\n      };\n      setSettings(updatedSettings);\n      await AsyncStorage.setItem(SYNC_SETTINGS_STORAGE_KEY, JSON.stringify(updatedSettings));\n\n      console.log('[SyncSettingsContext] Sync completed successfully');\n    } catch (error) {\n      console.error('[SyncSettingsContext] Error during sync:', error);\n      setSettings(prev => ({\n        ...prev,\n        lastSyncTimestamp: Date.now(),\n        lastSyncStatus: 'error',\n      }));\n    } finally {\n      setIsSyncing(false);\n    }\n  }, [settings, isSyncing]);\n\n  return {\n    settings,\n    isLoading,\n    isSyncing,\n    updateSettings,\n    triggerSync,\n  };\n});\n"],"mappings":"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","ignoreList":[]}