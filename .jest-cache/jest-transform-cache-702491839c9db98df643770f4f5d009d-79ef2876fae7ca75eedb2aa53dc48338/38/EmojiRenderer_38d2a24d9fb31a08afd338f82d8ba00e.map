{"version":3,"names":["React","useMemo","Text","CustomEmoji","loadCustomEmojis","jsx","_jsx","EmojiRenderer","_ref","text","_ref$emojiSize","emojiSize","cov_160tpj8n6c","b","style","f","_ref2","s","useState","_ref3","_slicedToArray","customEmojis","setCustomEmojis","useEffect","then","parsedContent","parts","customEmojiMap","Map","map","e","id","customEmojiRegex","lastIndex","match","exec","index","push","type","content","substring","emojiId","emoji","get","length","children","part","size"],"sources":["EmojiRenderer.tsx"],"sourcesContent":["/**\n * Компонент для отображения эмодзи в тексте сообщений\n * \n * Поддерживает:\n * - Стандартные Unicode эмодзи\n * - Кастомные эмодзи (изображения, SVG)\n * - Специальный формат [custom:id] для кастомных эмодзи\n */\n\nimport React, { useMemo } from 'react';\nimport { Text } from 'react-native';\nimport { CustomEmoji } from './CustomEmoji';\nimport { loadCustomEmojis, CustomEmojiData } from '@/utils/customEmojis';\n\ninterface EmojiRendererProps {\n  text: string;\n  emojiSize?: number;\n  style?: any;\n}\n\nexport function EmojiRenderer({ text, emojiSize = 20, style }: EmojiRendererProps) {\n  const [customEmojis, setCustomEmojis] = React.useState<CustomEmojiData[]>([]);\n\n  React.useEffect(() => {\n    loadCustomEmojis().then(setCustomEmojis);\n  }, []);\n\n  // Парсинг текста с поддержкой кастомных эмодзи\n  const parsedContent = useMemo(() => {\n    type ParsedPart = \n      | { type: 'text'; content: string }\n      | { type: 'custom'; content: string; emoji: CustomEmojiData };\n    \n    const parts: ParsedPart[] = [];\n    const customEmojiMap = new Map(customEmojis.map(e => [e.id, e]));\n    \n    // Регулярное выражение для поиска кастомных эмодзи [custom:id]\n    const customEmojiRegex = /\\[custom:([^\\]]+)\\]/g;\n    let lastIndex = 0;\n    let match;\n\n    while ((match = customEmojiRegex.exec(text)) !== null) {\n      // Добавляем текст до кастомного эмодзи\n      if (match.index > lastIndex) {\n        parts.push({\n          type: 'text',\n          content: text.substring(lastIndex, match.index),\n        });\n      }\n\n      // Добавляем кастомный эмодзи\n      const emojiId = match[1];\n      const emoji = customEmojiMap.get(emojiId);\n      \n      if (emoji) {\n        parts.push({\n          type: 'custom',\n          content: match[0],\n          emoji,\n        });\n      } else {\n        // Если эмодзи не найден, оставляем как текст\n        parts.push({\n          type: 'text',\n          content: match[0],\n        });\n      }\n\n      lastIndex = match.index + match[0].length;\n    }\n\n    // Добавляем оставшийся текст\n    if (lastIndex < text.length) {\n      parts.push({\n        type: 'text',\n        content: text.substring(lastIndex),\n      });\n    }\n\n    return parts.length > 0 ? parts : [{ type: 'text', content: text }];\n  }, [text, customEmojis]);\n\n  return (\n    <Text style={style}>\n      {parsedContent.map((part, index) => {\n        if (part.type === 'custom' && 'emoji' in part) {\n          return (\n            <CustomEmoji\n              key={index}\n              emoji={part.emoji}\n              size={emojiSize}\n            />\n          );\n        }\n        return <Text key={index}>{part.content}</Text>;\n      })}\n    </Text>\n  );\n}\n"],"mappings":"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","ignoreList":[]}