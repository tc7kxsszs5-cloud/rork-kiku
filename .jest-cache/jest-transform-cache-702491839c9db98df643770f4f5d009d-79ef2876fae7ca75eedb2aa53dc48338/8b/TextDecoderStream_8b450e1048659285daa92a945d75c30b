62c5c3feb088406b6651c6bf2baa022c
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault").default;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.TextEncoderStream = exports.TextDecoderStream = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _callSuper2 = _interopRequireDefault(require("@babel/runtime/helpers/callSuper"));
var _inherits2 = _interopRequireDefault(require("@babel/runtime/helpers/inherits"));
var TextDecoderStream = exports.TextDecoderStream = function (_TransformStream) {
  function TextDecoderStream(label, options) {
    var _this;
    (0, _classCallCheck2.default)(this, TextDecoderStream);
    var decoder = new TextDecoder(label, options);
    _this = (0, _callSuper2.default)(this, TextDecoderStream, [{
      transform: function transform(chunk, controller) {
        try {
          var text = decoder.decode(chunk, {
            stream: true
          });
          if (text) controller.enqueue(text);
        } catch (e) {
          controller.error(e);
        }
      },
      flush: function flush(controller) {
        try {
          var text = decoder.decode();
          if (text) controller.enqueue(text);
        } catch (e) {
          controller.error(e);
        }
      }
    }]);
    _this.decoder = decoder;
    return _this;
  }
  (0, _inherits2.default)(TextDecoderStream, _TransformStream);
  return (0, _createClass2.default)(TextDecoderStream, [{
    key: "encoding",
    get: function get() {
      return this.decoder.encoding;
    }
  }, {
    key: "fatal",
    get: function get() {
      return this.decoder.fatal;
    }
  }, {
    key: "ignoreBOM",
    get: function get() {
      return this.decoder.ignoreBOM;
    }
  }]);
}(TransformStream);
var TextEncoderStream = exports.TextEncoderStream = function (_TransformStream2) {
  function TextEncoderStream() {
    var _this2;
    (0, _classCallCheck2.default)(this, TextEncoderStream);
    var encoder = new TextEncoder();
    var carry;
    _this2 = (0, _callSuper2.default)(this, TextEncoderStream, [{
      transform: function transform(chunk, controller) {
        chunk = String(chunk);
        if (carry !== undefined) {
          chunk = carry + chunk;
          carry = undefined;
        }
        var lastCharIndex = chunk.length - 1;
        var lastCodeUnit = chunk.charCodeAt(lastCharIndex);
        if (lastCodeUnit >= 0xd800 && lastCodeUnit < 0xdc00) {
          carry = String.fromCharCode(lastCodeUnit);
          chunk = chunk.substring(0, lastCharIndex);
        }
        var encoded = encoder.encode(chunk);
        if (encoded.length) {
          try {
            controller.enqueue(encoded);
          } catch (e) {
            controller.error(e);
          }
        }
      },
      flush: function flush(controller) {
        if (carry !== undefined) {
          try {
            controller.enqueue(encoder.encode(carry));
          } catch (e) {
            controller.error(e);
          } finally {
            carry = undefined;
          }
        }
      }
    }]);
    _this2.encoder = encoder;
    return _this2;
  }
  (0, _inherits2.default)(TextEncoderStream, _TransformStream2);
  return (0, _createClass2.default)(TextEncoderStream, [{
    key: "encoding",
    get: function get() {
      return this.encoder.encoding;
    }
  }]);
}(TransformStream);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJUZXh0RGVjb2RlclN0cmVhbSIsImV4cG9ydHMiLCJfVHJhbnNmb3JtU3RyZWFtIiwibGFiZWwiLCJvcHRpb25zIiwiX3RoaXMiLCJfY2xhc3NDYWxsQ2hlY2syIiwiZGVmYXVsdCIsImRlY29kZXIiLCJUZXh0RGVjb2RlciIsIl9jYWxsU3VwZXIyIiwidHJhbnNmb3JtIiwiY2h1bmsiLCJjb250cm9sbGVyIiwidGV4dCIsImRlY29kZSIsInN0cmVhbSIsImVucXVldWUiLCJlIiwiZXJyb3IiLCJmbHVzaCIsIl9pbmhlcml0czIiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwiZ2V0IiwiZW5jb2RpbmciLCJmYXRhbCIsImlnbm9yZUJPTSIsIlRyYW5zZm9ybVN0cmVhbSIsIlRleHRFbmNvZGVyU3RyZWFtIiwiX1RyYW5zZm9ybVN0cmVhbTIiLCJfdGhpczIiLCJlbmNvZGVyIiwiVGV4dEVuY29kZXIiLCJjYXJyeSIsIlN0cmluZyIsInVuZGVmaW5lZCIsImxhc3RDaGFySW5kZXgiLCJsZW5ndGgiLCJsYXN0Q29kZVVuaXQiLCJjaGFyQ29kZUF0IiwiZnJvbUNoYXJDb2RlIiwic3Vic3RyaW5nIiwiZW5jb2RlZCIsImVuY29kZSJdLCJzb3VyY2VzIjpbIlRleHREZWNvZGVyU3RyZWFtLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGh0dHBzOi8vZW5jb2Rpbmcuc3BlYy53aGF0d2cub3JnLyNpbnRlcmZhY2UtdGV4dGRlY29kZXJzdHJlYW1cbmV4cG9ydCBjbGFzcyBUZXh0RGVjb2RlclN0cmVhbSBleHRlbmRzIFRyYW5zZm9ybVN0cmVhbTxVaW50OEFycmF5IHwgQXJyYXlCdWZmZXIsIHN0cmluZz4ge1xuICBwcml2YXRlIGRlY29kZXI6IFRleHREZWNvZGVyO1xuXG4gIGNvbnN0cnVjdG9yKGxhYmVsPzogc3RyaW5nLCBvcHRpb25zPzogVGV4dERlY29kZXJPcHRpb25zKSB7XG4gICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcihsYWJlbCwgb3B0aW9ucyk7XG4gICAgc3VwZXIoe1xuICAgICAgdHJhbnNmb3JtKFxuICAgICAgICBjaHVuazogQXJyYXlCdWZmZXIgfCBVaW50OEFycmF5LFxuICAgICAgICBjb250cm9sbGVyOiBUcmFuc2Zvcm1TdHJlYW1EZWZhdWx0Q29udHJvbGxlcjxzdHJpbmc+XG4gICAgICApIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB0ZXh0ID0gZGVjb2Rlci5kZWNvZGUoY2h1bmssIHsgc3RyZWFtOiB0cnVlIH0pO1xuICAgICAgICAgIGlmICh0ZXh0KSBjb250cm9sbGVyLmVucXVldWUodGV4dCk7XG4gICAgICAgIH0gY2F0Y2ggKGU6IHVua25vd24pIHtcbiAgICAgICAgICBjb250cm9sbGVyLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgZmx1c2goY29udHJvbGxlcjogVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXI8c3RyaW5nPikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IHRleHQgPSBkZWNvZGVyLmRlY29kZSgpO1xuICAgICAgICAgIGlmICh0ZXh0KSBjb250cm9sbGVyLmVucXVldWUodGV4dCk7XG4gICAgICAgIH0gY2F0Y2ggKGU6IHVua25vd24pIHtcbiAgICAgICAgICBjb250cm9sbGVyLmVycm9yKGUpO1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pO1xuICAgIHRoaXMuZGVjb2RlciA9IGRlY29kZXI7XG4gIH1cblxuICBnZXQgZW5jb2RpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGVjb2Rlci5lbmNvZGluZztcbiAgfVxuXG4gIGdldCBmYXRhbCgpIHtcbiAgICByZXR1cm4gdGhpcy5kZWNvZGVyLmZhdGFsO1xuICB9XG5cbiAgZ2V0IGlnbm9yZUJPTSgpIHtcbiAgICByZXR1cm4gdGhpcy5kZWNvZGVyLmlnbm9yZUJPTTtcbiAgfVxufVxuXG4vLyBodHRwczovL2VuY29kaW5nLnNwZWMud2hhdHdnLm9yZy8jaW50ZXJmYWNlLXRleHRlbmNvZGVyc3RyZWFtXG5leHBvcnQgY2xhc3MgVGV4dEVuY29kZXJTdHJlYW0gZXh0ZW5kcyBUcmFuc2Zvcm1TdHJlYW0ge1xuICBwcml2YXRlIGVuY29kZXI6IFRleHRFbmNvZGVyO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgICBsZXQgY2Fycnk6IHN0cmluZyB8IHVuZGVmaW5lZDtcbiAgICBzdXBlcih7XG4gICAgICB0cmFuc2Zvcm0oY2h1bms6IHN0cmluZywgY29udHJvbGxlcjogVHJhbnNmb3JtU3RyZWFtRGVmYXVsdENvbnRyb2xsZXI8VWludDhBcnJheT4pIHtcbiAgICAgICAgY2h1bmsgPSBTdHJpbmcoY2h1bmspO1xuICAgICAgICBpZiAoY2FycnkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIGNodW5rID0gY2FycnkgKyBjaHVuaztcbiAgICAgICAgICBjYXJyeSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGxhc3RDaGFySW5kZXggPSBjaHVuay5sZW5ndGggLSAxO1xuICAgICAgICBjb25zdCBsYXN0Q29kZVVuaXQgPSBjaHVuay5jaGFyQ29kZUF0KGxhc3RDaGFySW5kZXgpO1xuICAgICAgICBpZiAobGFzdENvZGVVbml0ID49IDB4ZDgwMCAmJiBsYXN0Q29kZVVuaXQgPCAweGRjMDApIHtcbiAgICAgICAgICBjYXJyeSA9IFN0cmluZy5mcm9tQ2hhckNvZGUobGFzdENvZGVVbml0KTtcbiAgICAgICAgICBjaHVuayA9IGNodW5rLnN1YnN0cmluZygwLCBsYXN0Q2hhckluZGV4KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGVuY29kZWQgPSBlbmNvZGVyLmVuY29kZShjaHVuayk7XG4gICAgICAgIGlmIChlbmNvZGVkLmxlbmd0aCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZW5jb2RlZCk7XG4gICAgICAgICAgfSBjYXRjaCAoZTogdW5rbm93bikge1xuICAgICAgICAgICAgY29udHJvbGxlci5lcnJvcihlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG5cbiAgICAgIGZsdXNoKGNvbnRyb2xsZXI6IFRyYW5zZm9ybVN0cmVhbURlZmF1bHRDb250cm9sbGVyPFVpbnQ4QXJyYXk+KSB7XG4gICAgICAgIGlmIChjYXJyeSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShjYXJyeSkpO1xuICAgICAgICAgIH0gY2F0Y2ggKGU6IHVua25vd24pIHtcbiAgICAgICAgICAgIGNvbnRyb2xsZXIuZXJyb3IoZSk7XG4gICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgIGNhcnJ5ID0gdW5kZWZpbmVkO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KTtcbiAgICB0aGlzLmVuY29kZXIgPSBlbmNvZGVyO1xuICB9XG5cbiAgZ2V0IGVuY29kaW5nKCkge1xuICAgIHJldHVybiB0aGlzLmVuY29kZXIuZW5jb2Rpbmc7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0lBQ2FBLGlCQUFpQixHQUFBQyxPQUFBLENBQUFELGlCQUFBLGFBQUFFLGdCQUFBO0VBRzVCLFNBQUFGLGtCQUFZRyxLQUFjLEVBQUVDLE9BQTRCLEVBQUU7SUFBQSxJQUFBQyxLQUFBO0lBQUEsSUFBQUMsZ0JBQUEsQ0FBQUMsT0FBQSxRQUFBUCxpQkFBQTtJQUN4RCxJQUFNUSxPQUFPLEdBQUcsSUFBSUMsV0FBVyxDQUFDTixLQUFLLEVBQUVDLE9BQU8sQ0FBQztJQUMvQ0MsS0FBQSxPQUFBSyxXQUFBLENBQUFILE9BQUEsUUFBQVAsaUJBQUEsR0FBTTtNQUNKVyxTQUFTLFdBQVRBLFNBQVNBLENBQ1BDLEtBQStCLEVBQy9CQyxVQUFvRCxFQUNwRDtRQUNBLElBQUk7VUFDRixJQUFNQyxJ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