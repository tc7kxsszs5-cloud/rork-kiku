{"version":3,"names":["_getJestObj","mock","actual","jest","requireActual","Object","assign","useSyncSettings","fn","useThemeMode","theme","backgroundPrimary","textPrimary","textSecondary","accentPrimary","borderSoft","card","isDark","HapticFeedback","selection","medium","_asyncToGenerator","_require","require","React","render","fireEvent","waitFor","SyncSettings","jsx","_jsx","mockUseSyncSettings","describe","defaultSettings","autoSyncEnabled","frequency","source","lastSyncTimestamp","Date","now","defaultMock","settings","isLoading","isSyncing","updateSettings","mockResolvedValue","undefined","triggerSync","beforeEach","clearAllMocks","mockReturnValue","it","_render","getByText","expect","toBeTruthy","_render2","getByTestId","toBeDefined","_render3","_render4","switchComponent","toHaveBeenCalledWith","_render5","queryByText","toBeNull","_render6","option","press","_render7","_render8","_render9","button","toHaveBeenCalled","_render10","_render11","_render12"],"sources":["SyncSettings.test.tsx"],"sourcesContent":["/**\n * Тесты для SyncSettings компонента\n * Проверяет рендеринг, переключение настроек, синхронизацию\n */\n\nimport React from 'react';\nimport { render, fireEvent, waitFor } from '@testing-library/react-native';\nimport { SyncSettings } from '@/components/settings/SyncSettings';\nimport { SyncSettingsProvider, useSyncSettings } from '@/constants/SyncSettingsContext';\n\n// Моки\njest.mock('@/constants/SyncSettingsContext', () => {\n  const actual = jest.requireActual('@/constants/SyncSettingsContext');\n  return {\n    ...actual,\n    useSyncSettings: jest.fn(),\n  };\n});\n\njest.mock('@/constants/ThemeContext', () => ({\n  useThemeMode: jest.fn(() => ({\n    theme: {\n      backgroundPrimary: '#ffffff',\n      textPrimary: '#000000',\n      textSecondary: '#666666',\n      accentPrimary: '#FF6B35',\n      borderSoft: '#e0e0e0',\n      card: '#f5f5f5',\n      isDark: false,\n    },\n  })),\n}));\n\njest.mock('@/constants/haptics', () => ({\n  HapticFeedback: {\n    selection: jest.fn(),\n    medium: jest.fn(),\n  },\n}));\n\nconst mockUseSyncSettings = useSyncSettings as jest.MockedFunction<typeof useSyncSettings>;\n\ndescribe('SyncSettings', () => {\n  const defaultSettings = {\n    autoSyncEnabled: true,\n    frequency: '15min' as const,\n    source: 'cloud' as const,\n    lastSyncTimestamp: Date.now() - 60000, // 1 минута назад\n  };\n\n  const defaultMock = {\n    settings: defaultSettings,\n    isLoading: false,\n    isSyncing: false,\n    updateSettings: jest.fn().mockResolvedValue(undefined),\n    triggerSync: jest.fn().mockResolvedValue(undefined),\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    mockUseSyncSettings.mockReturnValue(defaultMock);\n  });\n\n  describe('Рендеринг', () => {\n    it('должен отображать компонент', () => {\n      const { getByText } = render(<SyncSettings />);\n      \n      expect(getByText('Автосинхронизация')).toBeTruthy();\n    });\n\n    it('должен показывать индикатор загрузки при isLoading=true', () => {\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        isLoading: true,\n      });\n\n      const { getByTestId } = render(<SyncSettings />);\n      \n      // ActivityIndicator должен быть виден\n      expect(getByTestId).toBeDefined();\n    });\n\n    it('должен отображать настройки синхронизации', () => {\n      const { getByText } = render(<SyncSettings />);\n      \n      expect(getByText('Автосинхронизация')).toBeTruthy();\n      expect(getByText('Частота синхронизации')).toBeTruthy();\n      expect(getByText('Источник синхронизации')).toBeTruthy();\n    });\n  });\n\n  describe('Переключение автосинхронизации', () => {\n    it('должен вызывать updateSettings при переключении', async () => {\n      const updateSettings = jest.fn().mockResolvedValue(undefined);\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        updateSettings,\n      });\n\n      const { getByTestId } = render(<SyncSettings />);\n      const switchComponent = getByTestId('auto-sync-switch');\n\n      fireEvent(switchComponent, 'valueChange', false);\n\n      await waitFor(() => {\n        expect(updateSettings).toHaveBeenCalledWith({ autoSyncEnabled: false });\n      });\n    });\n\n    it('должен показывать опции частоты только при включенной автосинхронизации', () => {\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        settings: {\n          ...defaultSettings,\n          autoSyncEnabled: false,\n        },\n      });\n\n      const { queryByText } = render(<SyncSettings />);\n      \n      expect(queryByText('Частота синхронизации')).toBeNull();\n    });\n  });\n\n  describe('Выбор частоты синхронизации', () => {\n    it('должен вызывать updateSettings при выборе частоты', async () => {\n      const updateSettings = jest.fn().mockResolvedValue(undefined);\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        updateSettings,\n      });\n\n      const { getByText } = render(<SyncSettings />);\n      const option = getByText('Каждые 5 минут');\n\n      fireEvent.press(option);\n\n      await waitFor(() => {\n        expect(updateSettings).toHaveBeenCalledWith({ frequency: '5min' });\n      });\n    });\n\n    it('должен показывать все опции частоты', () => {\n      const { getByText } = render(<SyncSettings />);\n      \n      expect(getByText('В реальном времени')).toBeTruthy();\n      expect(getByText('Каждые 5 минут')).toBeTruthy();\n      expect(getByText('Каждые 15 минут')).toBeTruthy();\n      expect(getByText('Каждый час')).toBeTruthy();\n    });\n  });\n\n  describe('Выбор источника синхронизации', () => {\n    it('должен вызывать updateSettings при выборе источника', async () => {\n      const updateSettings = jest.fn().mockResolvedValue(undefined);\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        updateSettings,\n      });\n\n      const { getByText } = render(<SyncSettings />);\n      const option = getByText('Локально');\n\n      fireEvent.press(option);\n\n      await waitFor(() => {\n        expect(updateSettings).toHaveBeenCalledWith({ source: 'local' });\n      });\n    });\n  });\n\n  describe('Ручная синхронизация', () => {\n    it('должен вызывать triggerSync при нажатии на кнопку', async () => {\n      const triggerSync = jest.fn().mockResolvedValue(undefined);\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        triggerSync,\n      });\n\n      const { getByText } = render(<SyncSettings />);\n      const button = getByText('Синхронизировать сейчас');\n\n      fireEvent.press(button);\n\n      await waitFor(() => {\n        expect(triggerSync).toHaveBeenCalled();\n      });\n    });\n\n    it('должен показывать индикатор синхронизации при isSyncing=true', () => {\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        isSyncing: true,\n      });\n\n      const { getByTestId } = render(<SyncSettings />);\n      \n      // Должен быть индикатор синхронизации\n      expect(getByTestId).toBeDefined();\n    });\n  });\n\n  describe('Форматирование времени последней синхронизации', () => {\n    it('должен показывать \"Только что\" для недавней синхронизации', () => {\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        settings: {\n          ...defaultSettings,\n          lastSyncTimestamp: Date.now() - 30000, // 30 секунд назад\n        },\n      });\n\n      const { getByText } = render(<SyncSettings />);\n      \n      expect(getByText(/Только что|мин\\. назад/)).toBeTruthy();\n    });\n\n    it('должен показывать \"Синхронизация не выполнялась\" если нет timestamp', () => {\n      mockUseSyncSettings.mockReturnValue({\n        ...defaultMock,\n        settings: {\n          ...defaultSettings,\n          lastSyncTimestamp: undefined,\n        },\n      });\n\n      const { getByText } = render(<SyncSettings />);\n      \n      expect(getByText('Синхронизация не выполнялась')).toBeTruthy();\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}