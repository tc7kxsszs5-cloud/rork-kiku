#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ—Ä—Ç–æ–º Playwright

echo "üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç–∞ –¥–ª—è Playwright..."

# –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –ø–æ—Ä—Ç 8082
echo "üìå –û—Å–≤–æ–±–æ–∂–¥–∞—é –ø–æ—Ä—Ç 8082..."
lsof -ti:8082 | xargs kill -9 2>/dev/null || echo "–ü–æ—Ä—Ç 8082 —Å–≤–æ–±–æ–¥–µ–Ω"

# –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
sleep 2

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å–≤–æ–±–æ–¥–µ–Ω –ª–∏ –ø–æ—Ä—Ç
if lsof -ti:8082 > /dev/null 2>&1; then
  echo "‚ùå –ü–æ—Ä—Ç 8082 –≤—Å–µ –µ—â–µ –∑–∞–Ω—è—Ç. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é:"
  echo "   lsof -ti:8082 | xargs kill -9"
  exit 1
else
  echo "‚úÖ –ü–æ—Ä—Ç 8082 —Å–≤–æ–±–æ–¥–µ–Ω!"
  echo ""
  echo "–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å:"
  echo "  bun run test:playwright:ui"
  echo ""
  echo "–ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é:"
  echo "  bun run start:web"
fi
