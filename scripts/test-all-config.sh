#!/bin/bash
# –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

echo "üß™ –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏..."
echo ""

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# 1. –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç
echo -e "${YELLOW}1Ô∏è‚É£ –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç —Ñ–∞–π–ª–æ–≤ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π...${NC}"
bun run test:startup
BASIC_RESULT=$?

echo ""
echo -e "${YELLOW}2Ô∏è‚É£ –ì–ª—É–±–æ–∫–∏–π —Ç–µ—Å—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏...${NC}"
bun run test:deep
DEEP_RESULT=$?

echo ""
echo "=" | head -c 60
echo ""
echo "üìä –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:"
echo ""

if [ $BASIC_RESULT -eq 0 ] && [ $DEEP_RESULT -eq 0 ]; then
    echo -e "${GREEN}‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!${NC}"
    echo -e "${GREEN}üöÄ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é${NC}"
    exit 0
else
    echo -e "${RED}‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã${NC}"
    if [ $BASIC_RESULT -ne 0 ]; then
        echo -e "${RED}   - –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω${NC}"
    fi
    if [ $DEEP_RESULT -ne 0 ]; then
        echo -e "${RED}   - –ì–ª—É–±–æ–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–µ–Ω${NC}"
    fi
    echo ""
    echo -e "${YELLOW}üîß –ò—Å–ø—Ä–∞–≤—å—Ç–µ –æ—à–∏–±–∫–∏ –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º${NC}"
    exit 1
fi
